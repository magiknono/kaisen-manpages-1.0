<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.23.0">
    <meta name="project" content="Kaisen-linux v0.0.1">
    <title>openvpn — Kaisen-linux v0.0.1</title>
    <link rel="stylesheet" href="dist/elixir-9f91ebe876dc01d67920.css" />
    <script src="dist/sidebar_items-0baf9f48e2.js"></script>
      <script src="doc-versions.js"></script>
    <script async src="dist/app-60a0c9f10e9e52eae31f.js"></script>
  </head>
  <body data-type="extras">
    <script>try { if(localStorage.getItem('night-mode') === 'true') document.body.className += ' night-mode'; } catch (e) { }</script>
<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <span class="icon-search" aria-hidden="true" title="Submit search"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <span class="icon-cross" aria-hidden="true" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" id="search-list" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="#homepage_url" class="sidebar-projectName">
Kaisen-linux      </a>
      <strong class="sidebar-projectVersion">
        v0.0.1
      </strong>
    </div>
      <a href="#homepage_url">
        <img src="assets/logo.jpg" alt="Kaisen-linux" class="sidebar-projectImage">
      </a>
  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">MANUAL</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

<p>OPENVPN(8)                                                             System Manager's Manual                                                            OPENVPN(8)</p><p>NAME</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="n">openvpn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">Secure</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">daemon</span></code></pre><p>SYNOPSIS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="n">openvpn</span><span class="w"> </span><span class="p" data-group-id="6724436312-1">[</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="p" data-group-id="6724436312-1">]</span><span class="w">
   </span><span class="n">openvpn</span><span class="w">  </span><span class="o">--</span><span class="n">help</span></code></pre><p>INTRODUCTION</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">an</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">daemon</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">James</span><span class="w"> </span><span class="nc">Yonan</span><span class="o">.</span><span class="w"> </span><span class="nc">Because</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">tries</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">universal</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">tool</span><span class="w"> </span><span class="n">offering</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">great</span><span class="w"> </span><span class="n">deal</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">flexibility</span><span class="p">,</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">lot</span><span class="w">
   </span><span class="n">of</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">manual</span><span class="w"> </span><span class="n">page</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="sc">&#39;re new to OpenVPN, you might want to skip ahead to the examples section where you will see  how  to  construct  simple
   VPNs on the command line without even needing a configuration file.

   Also note that there&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">documentation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">examples</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">web</span><span class="w"> </span><span class="ss">site</span><span class="p">:</span><span class="w"> </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">openvpn</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="w">

   </span><span class="nc">And</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">shorter</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">manual</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">openvpn</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">obtained</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">openvpn</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">parameters</span><span class="o">.</span></code></pre><p>DESCRIPTION</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">robust</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">highly</span><span class="w"> </span><span class="n">flexible</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">daemon</span><span class="o">.</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">security</span><span class="p">,</span><span class="w"> </span><span class="n">ethernet</span><span class="w"> </span><span class="n">bridging</span><span class="p">,</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">transport</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">proxies</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">NAT</span><span class="p">,</span><span class="w">
   </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">DHCP</span><span class="p">,</span><span class="w"> </span><span class="n">scalability</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">hundreds</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">thousands</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">users</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">portability</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">major</span><span class="w"> </span><span class="nc">OS</span><span class="w"> </span><span class="n">platforms</span><span class="o">.</span><span class="w">

   </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">tightly</span><span class="w"> </span><span class="n">bound</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">library</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">derives</span><span class="w"> </span><span class="n">much</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">crypto</span><span class="w"> </span><span class="n">capabilities</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="w">

   </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">conventional</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pre</span><span class="o">-</span><span class="n">shared</span><span class="w"> </span><span class="n">secret</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="p" data-group-id="9281022114-1">(</span><span class="nc">Static</span><span class="w"> </span><span class="nc">Key</span><span class="w"> </span><span class="n">mode</span><span class="p" data-group-id="9281022114-1">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="p" data-group-id="9281022114-2">(</span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">mode</span><span class="p" data-group-id="9281022114-2">)</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">certifi</span><span class="err">‐</span><span class="w">
   </span><span class="n">cates</span><span class="o">.</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">encrypted</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">UDP</span><span class="w"> </span><span class="n">tunnels</span><span class="o">.</span><span class="w">

   </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">designed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">networking</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">exists</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">platforms</span><span class="o">.</span><span class="w">

   </span><span class="nc">Overall</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">aims</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">offer</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">IPSec</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">relatively</span><span class="w"> </span><span class="n">lightweight</span><span class="w"> </span><span class="n">footprint</span><span class="o">.</span></code></pre><p>OPTIONS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="n">allows</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">placed</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">Though</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">preceded</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">double</span><span class="o">-</span><span class="n">lead</span><span class="err">‐</span><span class="w">
   </span><span class="n">ing</span><span class="o">-</span><span class="n">dash</span><span class="w"> </span><span class="p" data-group-id="4927292323-1">(</span><span class="s">&quot;--&quot;</span><span class="p" data-group-id="4927292323-1">)</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">placed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="o">.</span></code></pre><p>   Generic Options</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">This</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">covers</span><span class="w"> </span><span class="n">generic</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">accessible</span><span class="w"> </span><span class="n">regardless</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="n">as</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">help</span><span class="w"> </span><span class="nc">Show</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">nocache</span><span class="w">
          </span><span class="nc">Don</span><span class="sc">&#39;t cache --askpass or --auth-user-pass username/passwords in virtual memory.

          If specified, this directive will cause OpenVPN to immediately forget username/password inputs after they are used. As a result, when OpenVPN needs  a
          username/password, it will prompt for input from stdin, which may be multiple times during the duration of an OpenVPN session.

          When using --auth-nocache in combination with a user/password file and --chroot or --daemon, make sure to use an absolute path.

          This directive does not affect the --http-proxy username/password.  It is always cached.

   --cd dir
          Change  directory to dir prior to reading any files such as configuration files, key files, scripts, etc. dir should be an absolute path, with a lead‐
          ing &quot;/&quot;, and without any references to the current directory such as . or ...

          This option is useful when you are running OpenVPN in --daemon mode, and you want to consolidate all of your OpenVPN control files in one location.

   --chroot dir
          Chroot to dir after initialization. --chroot essentially redefines dir as being the top level directory tree (/). OpenVPN will therefore be unable  to
          access any files outside this tree. This can be desirable from a security standpoint.

          Since the chroot operation is delayed until after initialization, most OpenVPN options that reference files will operate in a pre-chroot context.

          In many cases, the dir parameter can point to an empty directory, however complications can result when scripts or restarts are executed after the ch‐
          root operation.

          Note: The SSL library will probably need /dev/urandom to be available inside the chroot directory dir. This is because SSL libraries occasionally need
          to  collect  fresh random. Newer linux kernels and some BSDs implement a getrandom() or getentropy() syscall that removes the need for /dev/urandom to
          be available.

   --config file
          Load additional config options from file where each line corresponds to one command line option, but with the leading &#39;</span><span class="o">--</span><span class="sc">&#39; removed.

          If --config file is the only option to the openvpn command, the --config can be removed, and the command can be given as openvpn file

          Note that configuration files can be nested to a reasonable depth.

          Double quotation or single quotation characters (&quot;&quot;, &#39;</span><span class="sc">&#39;) can be used to enclose single parameters containing whitespace, and &quot;#&quot; or &quot;;&quot; characters  in
          the first column can be used to denote comments.

          Note  that OpenVPN 2.0 and higher performs backslash-based shell escaping for characters not in single quotations, so the following mappings should be
          observed:

             </span><span class="se">\\</span><span class="sc">       Maps to a single backslash character (</span><span class="se">\)</span><span class="sc">.
             </span><span class="se">\&quot;</span><span class="sc">       Pass a literal doublequote character (&quot;), don&#39;</span><span class="n">t</span><span class="w">
                      </span><span class="n">interpret</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">enclosing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">parameter</span><span class="o">.</span><span class="w">
             </span><span class="err">\</span><span class="p" data-group-id="6135076853-1">[</span><span class="nc">SPACE</span><span class="p" data-group-id="6135076853-1">]</span><span class="w"> </span><span class="nc">Pass</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">literal</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">tab</span><span class="w"> </span><span class="n">character</span><span class="p">,</span><span class="w"> </span><span class="n">don</span><span class="sc">&#39;t
                      interpret it as a parameter delimiter.

          For example on Windows, use double backslashes to represent pathnames:

             secret &quot;c:</span><span class="se">\\</span><span class="sc">OpenVPN</span><span class="se">\\</span><span class="sc">secret.key&quot;

          For examples of configuration files, see https://openvpn.net/community-resources/how-to/

          Here is an example configuration file:

             #
             # Sample OpenVPN configuration file for
             # using a pre-shared static key.
             #
             # &#39;</span><span class="c1">#&#39; or &#39;;&#39; may be used to delimit comments.</span><span class="w">

             </span><span class="c1"># Use a dynamic tun device.</span><span class="w">
             </span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w">

             </span><span class="c1"># Our remote peer</span><span class="w">
             </span><span class="n">remote</span><span class="w"> </span><span class="n">mypeer</span><span class="o">.</span><span class="n">mydomain</span><span class="w">

             </span><span class="c1"># 10.1.0.1 is our local VPN endpoint</span><span class="w">
             </span><span class="c1"># 10.1.0.2 is our remote VPN endpoint</span><span class="w">
             </span><span class="n">ifconfig</span><span class="w"> </span><span class="mf">10.1</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mf">10.1</span><span class="o">.</span><span class="mf">0.2</span><span class="w">

             </span><span class="c1"># Our pre-shared static key</span><span class="w">
             </span><span class="n">secret</span><span class="w"> </span><span class="n">static</span><span class="o">.</span><span class="n">key</span><span class="w">

   </span><span class="o">--</span><span class="n">daemon</span><span class="w"> </span><span class="n">progname</span><span class="w">
          </span><span class="nc">Become</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">daemon</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">initialization</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">completed</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">to</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">syslog</span><span class="w">  </span><span class="n">file</span><span class="w">
          </span><span class="p" data-group-id="6135076853-2">(</span><span class="n">such</span><span class="w">  </span><span class="n">as</span><span class="w"> </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">messages</span><span class="p" data-group-id="6135076853-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">except</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ifconfig</span><span class="w"> </span><span class="n">commands</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">go</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">redirected</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">sys</span><span class="err">‐</span><span class="w">
          </span><span class="n">log</span><span class="w"> </span><span class="n">redirection</span><span class="w"> </span><span class="n">occurs</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="o">--</span><span class="n">daemon</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">parsed</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">though</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">daemonization</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="n">occurs</span><span class="w"> </span><span class="n">later</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w">  </span><span class="n">one</span><span class="w">
          </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">log</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">present</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">supersede</span><span class="w"> </span><span class="n">syslog</span><span class="w"> </span><span class="n">redirection</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w">  </span><span class="n">optional</span><span class="w"> </span><span class="n">progname</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">progname</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">linking</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w">
          </span><span class="n">messages</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">syslog</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">tunnels</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">unspecified</span><span class="p">,</span><span class="w"> </span><span class="n">progname</span><span class="w"> </span><span class="n">defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s">&quot;openvpn&quot;</span><span class="o">.</span><span class="w">

          </span><span class="nc">When</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">daemon</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">delay</span><span class="w"> </span><span class="n">daemonization</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">majority</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">initialization</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">are</span><span class="w">  </span><span class="n">capable</span><span class="w">  </span><span class="n">of</span><span class="w">
          </span><span class="n">generating</span><span class="w">  </span><span class="n">fatal</span><span class="w">  </span><span class="n">errors</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">complete</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">initialization</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">openvpn</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fairly</span><span class="w"> </span><span class="n">reliable</span><span class="w">
          </span><span class="n">indication</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">correctly</span><span class="w"> </span><span class="n">initialized</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">entered</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">forwarding</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">loop</span><span class="o">.</span><span class="w">

          </span><span class="nc">In</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">vast</span><span class="w"> </span><span class="n">majority</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">occur</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">initialization</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">fatal</span><span class="o">.</span><span class="w">

          </span><span class="ss">Note</span><span class="p">:</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">soon</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">daemonized</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">ask</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">usernames</span><span class="p">,</span><span class="w"> </span><span class="n">passwords</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">phrases</span><span class="w"> </span><span class="n">anymore</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">certain</span><span class="w">  </span><span class="n">consequences</span><span class="p">,</span><span class="w">  </span><span class="n">namely</span><span class="w">
          </span><span class="n">that</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">password</span><span class="o">-</span><span class="n">protected</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">askpass</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">tell</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ask</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">phrase</span><span class="w"> </span><span class="p" data-group-id="6135076853-3">(</span><span class="n">this</span><span class="w"> </span><span class="n">requirement</span><span class="w">
          </span><span class="n">is</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">v2</span><span class="o">.</span><span class="mf">3.7</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">consequence</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">daemon</span><span class="p" data-group-id="6135076853-4">(</span><span class="p" data-group-id="6135076853-4">)</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">initializing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">crypto</span><span class="w"> </span><span class="n">layer</span><span class="p" data-group-id="6135076853-3">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">Further</span><span class="p">,</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="o">--</span><span class="n">daemon</span><span class="w"> </span><span class="n">together</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="w"> </span><span class="p" data-group-id="6135076853-5">(</span><span class="n">entered</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">console</span><span class="p" data-group-id="6135076853-5">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">nocache</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">soon</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">renegotiation</span><span class="w"> </span><span class="p" data-group-id="6135076853-6">(</span><span class="ow">and</span><span class="w"> </span><span class="n">reauthenti</span><span class="err">‐</span><span class="w">
          </span><span class="n">cation</span><span class="p" data-group-id="6135076853-6">)</span><span class="w"> </span><span class="n">occurs</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">disable</span><span class="o">-</span><span class="n">occ</span><span class="w">
          </span><span class="nc">Don</span><span class="sc">&#39;t  output  a  warning  message if option inconsistencies are detected between peers. An example of an option inconsistency would be where one peer
          uses --dev tun while the other peer uses --dev tap.

          Use of this option is discouraged, but is provided as a temporary fix in situations where a recent version of OpenVPN must connect to an old version.

   --engine engine-name
          Enable OpenSSL hardware-based crypto engine functionality.

          If engine-name is specified, use a specific crypto engine. Use the --show-engines standalone option to list the crypto engines which are supported  by
          OpenSSL.

   --fast-io
          (Experimental)  Optimize TUN/TAP/UDP I/O writes by avoiding a call to poll/epoll/select prior to the write operation. The purpose of such a call would
          normally be to block until the device or socket is ready to accept the write. Such blocking is unnecessary on some platforms which don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">write</span><span class="w">
          </span><span class="n">blocking</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">devices</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">cases</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">optimize</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">avoiding</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">poll</span><span class="o">/</span><span class="n">epoll</span><span class="o">/</span><span class="n">select</span><span class="w"> </span><span class="n">call</span><span class="p">,</span><span class="w"> </span><span class="n">improving</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="n">effi</span><span class="err">‐</span><span class="w">
          </span><span class="n">ciency</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="mi">5</span><span class="p">%</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">10</span><span class="p">%</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">Windows</span><span class="w"> </span><span class="n">systems</span><span class="p">,</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="o">--</span><span class="n">proto</span><span class="w"> </span><span class="n">udp</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="o">--</span><span class="n">shaper</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nc">NOT</span><span class="w"> </span><span class="n">specified</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">group</span><span class="w"> </span><span class="n">group</span><span class="w">
          </span><span class="nc">Similar</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">user</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="nc">ID</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">initialization</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">ignore</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">option</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">ignore</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">options</span><span class="w"> </span><span class="n">opt1</span><span class="w"> </span><span class="n">opt2</span><span class="w"> </span><span class="n">opt3</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="n">optN</span><span class="w">

          </span><span class="nc">When</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">opt1</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="n">optN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">encountered</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="n">version</span><span class="w">  </span><span class="n">does</span><span class="w">
          </span><span class="ow">not</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w"> </span><span class="nc">Multiple</span><span class="w"> </span><span class="o">--</span><span class="n">ignore</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">option</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">larger</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ignore</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w">  </span><span class="n">option</span><span class="w">  </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">caution</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">good</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">reasons</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">having</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">detects</span><span class="w"> </span><span class="n">problems</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">  </span><span class="nc">Having</span><span class="w">
          </span><span class="n">said</span><span class="w"> </span><span class="n">that</span><span class="p">,</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">reasons</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">wanting</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">software</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">gracefully</span><span class="w"> </span><span class="n">degrade</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">encountered</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">software</span><span class="w"> </span><span class="n">versions</span><span class="o">.</span><span class="w">

          </span><span class="o">--</span><span class="n">ignore</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.3</span><span class="o">.</span><span class="mi">3</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">iproute</span><span class="w"> </span><span class="n">cmd</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="n">alternate</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">iproute2</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">  </span><span class="nc">May</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">unprivileged</span><span class="w"> </span><span class="n">environment</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">keying</span><span class="o">-</span><span class="n">material</span><span class="o">-</span><span class="n">exporter</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Save</span><span class="w"> </span><span class="nc">Exported</span><span class="w"> </span><span class="nc">Keying</span><span class="w"> </span><span class="nc">Material</span><span class="w"> </span><span class="p" data-group-id="6135076853-7">[</span><span class="nc">RFC5705</span><span class="p" data-group-id="6135076853-7">]</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="p" data-group-id="6135076853-8">(</span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">4095</span><span class="w"> </span><span class="n">bytes</span><span class="p" data-group-id="6135076853-8">)</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="p" data-group-id="6135076853-9">(</span><span class="n">exported_keying_material</span><span class="p" data-group-id="6135076853-9">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="kn">use</span><span class="w">
          </span><span class="n">by</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OPENVPN_PLUGIN_TLS_FINAL</span><span class="w"> </span><span class="n">callback</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">keying</span><span class="o">-</span><span class="n">material</span><span class="o">-</span><span class="n">exporter</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="n">len</span><span class="w">

          </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">exporter</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">potential</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">collide</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="nc">PRF</span><span class="w"> </span><span class="n">labels</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="nc">MUST</span><span class="w"> </span><span class="n">begin</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">EXPORTER</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">mlock</span><span class="w">
          </span><span class="nc">Disable</span><span class="w">  </span><span class="n">paging</span><span class="w">  </span><span class="n">by</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">POSIX</span><span class="w"> </span><span class="n">mlockall</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="w"> </span><span class="nc">Requires</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">initially</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="p" data-group-id="6135076853-10">(</span><span class="n">though</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">subsequently</span><span class="w"> </span><span class="n">downgrade</span><span class="w"> </span><span class="n">its</span><span class="w">
          </span><span class="nc">UID</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">user</span><span class="w"> </span><span class="n">option</span><span class="p" data-group-id="6135076853-10">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">Using</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">ensures</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">material</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">disk</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">paging</span><span class="w"> </span><span class="n">operations</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">occur</span><span class="w">  </span><span class="n">under</span><span class="w">  </span><span class="n">most</span><span class="w">
          </span><span class="n">modern</span><span class="w">  </span><span class="n">operating</span><span class="w"> </span><span class="n">systems</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">ensures</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">attacker</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">crack</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="p">,</span><span class="w"> </span><span class="n">he</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">swap</span><span class="w">
          </span><span class="n">file</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">recover</span><span class="w"> </span><span class="n">previously</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">ephemeral</span><span class="w"> </span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">period</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">governed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">reneg</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p" data-group-id="6135076853-11">(</span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="p" data-group-id="6135076853-11">)</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">discarded</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">downside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="o">--</span><span class="n">mlock</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">reduce</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">physical</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">applications</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">much</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">locked</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enforced</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="nc">OS</span><span class="o">-</span><span class="n">dependent</span><span class="o">.</span><span class="w"> </span><span class="nc">On</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">that</span><span class="w">  </span><span class="n">an</span><span class="w">  </span><span class="n">unprivileged</span><span class="w">  </span><span class="n">process</span><span class="w">
          </span><span class="n">may</span><span class="w"> </span><span class="n">lock</span><span class="w"> </span><span class="p" data-group-id="6135076853-12">(</span><span class="nc">RLIMIT_MEMLOCK</span><span class="p" data-group-id="6135076853-12">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">low</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">dropped</span><span class="w"> </span><span class="n">later</span><span class="p">,</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">allocations</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">likely</span><span class="w"> </span><span class="n">fail</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">increased</span><span class="w"> </span><span class="n">us</span><span class="err">‐</span><span class="w">
          </span><span class="n">ing</span><span class="w"> </span><span class="n">ulimit</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">systemd</span><span class="w"> </span><span class="n">directives</span><span class="w"> </span><span class="n">depending</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">started</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">nice</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Change</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">priority</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">initialization</span><span class="w"> </span><span class="p" data-group-id="6135076853-13">(</span><span class="n">n</span><span class="w"> </span><span class="n">greater</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="n">priority</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">priority</span><span class="p" data-group-id="6135076853-13">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">persist</span><span class="o">-</span><span class="n">key</span><span class="w">
          </span><span class="nc">Don</span><span class="sc">&#39;t re-read key files across SIGUSR1 or --ping-restart.

          This option can be combined with --user nobody to allow restarts triggered by the SIGUSR1 signal. Normally if you drop root privileges in OpenVPN, the
          daemon cannot be restarted since it will now be unable to re-read protected key files.

          This option solves the problem by persisting keys across SIGUSR1 resets, so they don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">read</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">remap</span><span class="o">-</span><span class="n">usr1</span><span class="w"> </span><span class="n">signal</span><span class="w">
          </span><span class="nc">Control</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">internally</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">externally</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="nc">SIGUSR1</span><span class="w"> </span><span class="n">signals</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">remapped</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">SIGHUP</span><span class="w"> </span><span class="p" data-group-id="6135076853-14">(</span><span class="n">restart</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">persisting</span><span class="w"> </span><span class="n">state</span><span class="p" data-group-id="6135076853-14">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">SIGTERM</span><span class="w"> </span><span class="p" data-group-id="6135076853-15">(</span><span class="n">exit</span><span class="p" data-group-id="6135076853-15">)</span><span class="o">.</span><span class="w">

          </span><span class="n">signal</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">SIGHUP</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">SIGTERM</span><span class="o">.</span><span class="w"> </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">remapping</span><span class="w"> </span><span class="n">occurs</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">security</span><span class="w"> </span><span class="n">level</span><span class="w">
          </span><span class="nc">This</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">offers</span><span class="w"> </span><span class="n">policy</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="sc">&#39;s usage of external programs and scripts. Lower level values are more restrictive, higher val‐
          ues are more permissive. Settings for level:

          0      Strictly no calling of external programs.

          1      (Default) Only call built-in executables such as ifconfig, ip, route, or netsh.

          2      Allow calling of built-in executables and user-defined scripts.

          3      Allow passwords to be passed to scripts via environmental variables (potentially unsafe).

          OpenVPN releases before v2.3 also supported a method flag which indicated how OpenVPN should call external commands and scripts. This could be  either
          execve  or  system.  As of OpenVPN 2.3, this flag is no longer accepted. In most *nix environments the execve() approach has been used without any is‐
          sues.

          Some directives such as --up allow options to be passed to the external script. In these cases make sure the script name does not contain  any  spaces
          or the configuration parser will choke because it can&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">ends</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="w">

          </span><span class="nc">To</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">earlier</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">versions</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">interpreter</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">parse</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="kn">use</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">scripts</span><span class="o">.</span><span class="w"> </span><span class="nc">As</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.3</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">strict</span><span class="w"> </span><span class="n">requirement</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">full</span><span class="w">  </span><span class="n">path</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">script</span><span class="w">  </span><span class="n">interpreter</span><span class="w">  </span><span class="ow">when</span><span class="w">  </span><span class="n">running</span><span class="w">
          </span><span class="n">non</span><span class="o">-</span><span class="n">executables</span><span class="w">  </span><span class="n">files</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="ow">not</span><span class="w">  </span><span class="n">needed</span><span class="w">  </span><span class="k">for</span><span class="w">  </span><span class="n">executable</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">.</span><span class="n">exe</span><span class="p">,</span><span class="w"> </span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="w"> </span><span class="o">.</span><span class="n">bat</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">.</span><span class="n">cmd</span><span class="w"> </span><span class="n">files</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">Visual</span><span class="w"> </span><span class="nc">Basic</span><span class="w">
          </span><span class="n">script</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">syntax</span><span class="w"> </span><span class="ss">now</span><span class="p">:</span><span class="w">

             </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="sc">&#39;C:</span><span class="se">\\</span><span class="sc">Windows</span><span class="se">\\</span><span class="sc">System32</span><span class="se">\\</span><span class="sc">wscript.exe C:</span><span class="se">\\</span><span class="sc">Program</span><span class="se">\ </span><span class="sc">Files</span><span class="se">\\</span><span class="sc">OpenVPN</span><span class="se">\\</span><span class="sc">config</span><span class="se">\\</span><span class="sc">my-up-script.vbs&#39;</span><span class="w">

          </span><span class="nc">Please</span><span class="w"> </span><span class="n">note</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="k">quote</span><span class="w"> </span><span class="n">marks</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">escaping</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">backslashes</span><span class="w"> </span><span class="p" data-group-id="6135076853-16">(</span><span class="err">\</span><span class="p" data-group-id="6135076853-16">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">character</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">reason</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">implications</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">expansions</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="n">via</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">sys</span><span class="err">‐</span><span class="w">
          </span><span class="n">tem</span><span class="p" data-group-id="6135076853-17">(</span><span class="p" data-group-id="6135076853-17">)</span><span class="w"> </span><span class="n">call</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">setcon</span><span class="w"> </span><span class="n">context</span><span class="w">
          </span><span class="nc">Apply</span><span class="w">  </span><span class="nc">SELinux</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">initialization</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">essentially</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ability</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">restrict</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="sc">&#39;s rights to only network I/O operations, thanks
          to SELinux. This goes further than --user and --chroot in that those two, while being great security features, unfortunately do  not  protect  against
          privilege  escalation by exploitation of a vulnerable system call. You can of course combine all three, but please note that since setcon requires ac‐
          cess to /proc you will have to provide it inside the chroot directory (e.g. with mount --bind).

          Since the setcon operation is delayed until after initialization, OpenVPN can be restricted to just network-related system calls, whereas by  applying
          the  context before startup (such as the OpenVPN one provided in the SELinux Reference Policies) you will have to allow many things required only dur‐
          ing initialization.

          Like with chroot, complications can result when scripts or restarts are executed after the setcon operation, which is why you should  really  consider
          using the --persist-key and --persist-tun options.

   --status args
          Write operational status to file every n seconds.

          Valid syntaxes:

             status file
             status file n

          Status can also be written to the syslog by sending a SIGUSR2 signal.

          With  multi-client capability enabled on a server, the status file includes a list of clients and a routing table. The output format can be controlled
          by the --status-version option in that case.

          For clients or instances running in point-to-point mode, it will contain the traffic statistics.

   --status-version n
          Set the status file format version number to n.

          This only affects the status file on servers with multi-client capability enabled.  Valid status version values:

          1      Traditional format (default). The client list contains the following fields comma-separated: Common Name, Real Address, Bytes  Received,  Bytes
                 Sent, Connected Since.

          2      A  more  reliable format for external processing. Compared to version 1, the client list contains some additional fields: Virtual Address, Vir‐
                 tual IPv6 Address, Username, Client ID, Peer ID, Data Channel Cipher. Future versions may extend the number of fields.

          3      Identical to 2, but fields are tab-separated.

   --test-crypto
          Do a self-test of OpenVPN&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">crypto</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">encrypting</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">decrypting</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">above</span><span class="o">.</span><span class="w">   </span><span class="nc">This</span><span class="w">
          </span><span class="n">option</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kn">require</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">function</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">therefore</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">typical</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">--</span><span class="n">test</span><span class="o">-</span><span class="n">crypto</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">something</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="ss">this</span><span class="p">:</span><span class="w">

             </span><span class="n">openvpn</span><span class="w"> </span><span class="o">--</span><span class="n">test</span><span class="o">-</span><span class="n">crypto</span><span class="w"> </span><span class="o">--</span><span class="n">secret</span><span class="w"> </span><span class="n">key</span><span class="w">

          </span><span class="ow">or</span><span class="w">

             </span><span class="n">openvpn</span><span class="w"> </span><span class="o">--</span><span class="n">test</span><span class="o">-</span><span class="n">crypto</span><span class="w"> </span><span class="o">--</span><span class="n">secret</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">--</span><span class="n">verb</span><span class="w"> </span><span class="mi">9</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">ported</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">platform</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">isolate</span><span class="w"> </span><span class="n">problems</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">compiler</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">crypto</span><span class="w"> </span><span class="n">library</span><span class="p">,</span><span class="w">
          </span><span class="ow">or</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="sc">&#39;s crypto code. Since it is a self-test mode, problems with encryption and authentication can be debugged independently of network and  tun‐
          nel issues.

   --tmp-dir dir
          Specify  a  directory  dir for temporary files. This directory will be used by openvpn processes and script to communicate temporary data with openvpn
          main process. Note that the directory must be writable by the OpenVPN process after it has dropped it&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">privileges</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">cases</span><span class="p">:</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">OPENVPN_PLUGIN_CLIENT_CONNECT</span><span class="w"> </span><span class="n">plug</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">dynamically</span><span class="w"> </span><span class="n">generate</span><span class="w">  </span><span class="n">client</span><span class="o">-</span><span class="n">specific</span><span class="w">  </span><span class="n">configuration</span><span class="w">  </span><span class="n">client_connect_con</span><span class="err">‐</span><span class="w">
            </span><span class="n">fig_file</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">success</span><span class="o">/</span><span class="n">failure</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">client_connect_deferred_file</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">deferred</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">method</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="nc">OPENVPN_PLUGIN_AUTH_USER_PASS_VERIFY</span><span class="w"> </span><span class="n">plug</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">success</span><span class="o">/</span><span class="n">failure</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">auth_control_file</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">deferred</span><span class="w"> </span><span class="n">auth</span><span class="w"> </span><span class="n">method</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="nc">OPENVPN_PLUGIN_ENABLE_PF</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">filtering</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">pf_file</span><span class="w">

   </span><span class="o">--</span><span class="kn">use</span><span class="o">-</span><span class="n">prediction</span><span class="o">-</span><span class="n">resistance</span><span class="w">
          </span><span class="nc">Enable</span><span class="w"> </span><span class="n">prediction</span><span class="w"> </span><span class="n">resistance</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">mbed</span><span class="w"> </span><span class="nc">TLS</span><span class="sc">&#39;s RNG.

          Enabling prediction resistance causes the RNG to reseed in each call for random. Reseeding this often can quickly deplete the kernel entropy pool.

          If you need this option, please consider running a daemon that adds entropy to the kernel pool.

   --user user
          Change  the user ID of the OpenVPN process to user after initialization, dropping privileges in the process. This option is useful to protect the sys‐
          tem in the event that some hostile party was able to gain control of an OpenVPN session. Though OpenVPN&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">unlikely</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w">  </span><span class="n">is</span><span class="w">
          </span><span class="n">provided</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">defense</span><span class="o">.</span><span class="w">

          </span><span class="nc">By</span><span class="w">  </span><span class="n">setting</span><span class="w">  </span><span class="n">user</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">nobody</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">somebody</span><span class="w"> </span><span class="n">similarly</span><span class="w"> </span><span class="n">unprivileged</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hostile</span><span class="w"> </span><span class="n">party</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">limited</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">damage</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">cause</span><span class="o">.</span><span class="w"> </span><span class="nc">Of</span><span class="w"> </span><span class="n">course</span><span class="w"> </span><span class="n">once</span><span class="w"> </span><span class="n">you</span><span class="w">
          </span><span class="n">take</span><span class="w"> </span><span class="n">away</span><span class="w"> </span><span class="n">privileges</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">session</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">means</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">daemon</span><span class="w">  </span><span class="k">with</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="nc">SI</span><span class="err">‐</span><span class="w">
          </span><span class="nc">GUSR1</span><span class="w">  </span><span class="n">signal</span><span class="w">  </span><span class="p" data-group-id="6135076853-18">(</span><span class="k">for</span><span class="w">  </span><span class="n">example</span><span class="w">  </span><span class="ow">in</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">reset</span><span class="p" data-group-id="6135076853-18">)</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">persist</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">doesn</span><span class="sc">&#39;t
          need to execute any privileged operations in order to restart (such as re-reading key files or running ifconfig on the TUN device).

   --writepid file
          Write OpenVPN&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="nc">ID</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">file</span><span class="o">.</span></code></pre><p>   Log options</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="o">--</span><span class="n">echo</span><span class="w"> </span><span class="n">parms</span><span class="w">
          </span><span class="nc">Echo</span><span class="w"> </span><span class="n">parms</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">output</span><span class="o">.</span><span class="w">

          </span><span class="nc">Designed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">controlling</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">receiving</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">output</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">errors</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">stderr</span><span class="w">
          </span><span class="nc">Output</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">stderr</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">stdout</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">redirected</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">log</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">log</span><span class="w"> </span><span class="n">file</span><span class="w">
          </span><span class="nc">Output</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">stdout</span><span class="o">/</span><span class="n">stderr</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">scripts</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">exists</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w">  </span><span class="n">truncated</span><span class="o">.</span><span class="w">
          </span><span class="nc">This</span><span class="w">  </span><span class="n">option</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="n">effect</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">parsed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">supersede</span><span class="w"> </span><span class="n">syslog</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">--</span><span class="n">daemon</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">inetd</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">specified</span><span class="o">.</span><span class="w">
          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">entire</span><span class="w"> </span><span class="n">course</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">instantiation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">SIGHUP</span><span class="p">,</span><span class="w"> </span><span class="nc">SIGUSR1</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="o">-</span><span class="n">restart</span><span class="o">.</span><span class="w">

          </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Windows</span><span class="p">,</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">service</span><span class="p">,</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">occurs</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">log</span><span class="o">-</span><span class="n">append</span><span class="w"> </span><span class="n">file</span><span class="w">
          </span><span class="nc">Append</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">exist</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">created</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">behaves</span><span class="w"> </span><span class="n">exactly</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="o">--</span><span class="n">log</span><span class="w"> </span><span class="n">except</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">appends</span><span class="w"> </span><span class="n">to</span><span class="w">  </span><span class="n">rather</span><span class="w">
          </span><span class="n">than</span><span class="w"> </span><span class="n">truncating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">machine</span><span class="o">-</span><span class="n">readable</span><span class="o">-</span><span class="n">output</span><span class="w">
          </span><span class="nc">Always</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">timestamps</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">messages</span><span class="p">,</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">prefixed</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">particular</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">applies</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">messages</span><span class="w">
          </span><span class="n">sent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">stdout</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">mute</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Log</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">consecutive</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">category</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">repetitive</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">types</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">mute</span><span class="o">-</span><span class="n">replay</span><span class="o">-</span><span class="n">warnings</span><span class="w">
          </span><span class="nc">Silence</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">replay</span><span class="w"> </span><span class="n">warnings</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="no">false</span><span class="w"> </span><span class="n">alarm</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">WiFi</span><span class="w"> </span><span class="n">networks</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">preserves</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">of</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">replay</span><span class="w">  </span><span class="n">protection</span><span class="w">
          </span><span class="n">code</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">verbosity</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">warnings</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">duplicate</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">suppress</span><span class="o">-</span><span class="n">timestamps</span><span class="w">
          </span><span class="nc">Avoid</span><span class="w"> </span><span class="n">writing</span><span class="w"> </span><span class="n">timestamps</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">messages</span><span class="p">,</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">prepended</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">particular</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">applies</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">stdout</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">syslog</span><span class="w"> </span><span class="n">progname</span><span class="w">
          </span><span class="nc">Direct</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">logger</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="k" data-group-id="8982409577-1">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">become</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">daemon</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="o">--</span><span class="n">daemon</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">progname</span><span class="w"> </span><span class="n">parameter</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">verb</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">verbosity</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p" data-group-id="8982409577-2">(</span><span class="n">default</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="8982409577-2">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Each</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">shows</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">levels</span><span class="o">.</span><span class="w"> </span><span class="nc">Level</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">recommended</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">good</span><span class="w"> </span><span class="n">summary</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">what</span><span class="err">&#39;</span><span class="n">s</span><span class="w">
          </span><span class="n">happening</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">swamped</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">output</span><span class="o">.</span><span class="w">

          </span><span class="mi">0</span><span class="w">      </span><span class="nc">No</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">except</span><span class="w"> </span><span class="n">fatal</span><span class="w"> </span><span class="n">errors</span><span class="o">.</span><span class="w">

          </span><span class="mi">1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="nc">Normal</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">range</span><span class="o">.</span><span class="w">

          </span><span class="mi">5</span><span class="w">      </span><span class="nc">Outputs</span><span class="w"> </span><span class="nc">R</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">W</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">console</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">write</span><span class="p">,</span><span class="w"> </span><span class="n">uppercase</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">UDP</span><span class="w">  </span><span class="n">packets</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">lowercase</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">used</span><span class="w">  </span><span class="k">for</span><span class="w">
                 </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">

          </span><span class="mi">6</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">11</span><span class="w">
                 </span><span class="nc">Debug</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="p" data-group-id="8982409577-3">(</span><span class="n">see</span><span class="w"> </span><span class="n">errlevel</span><span class="o">.</span><span class="n">h</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">debug</span><span class="w"> </span><span class="n">levels</span><span class="p" data-group-id="8982409577-3">)</span><span class="o">.</span></code></pre><p>   Protocol options</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Options</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">affect</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">wire</span><span class="w"> </span><span class="n">protocol</span><span class="o">.</span><span class="w">  </span><span class="nc">Many</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">define</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channel</span><span class="w">
   </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">wire</span><span class="w"> </span><span class="n">protocol</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">compatible</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">side</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">allow</span><span class="o">-</span><span class="n">compression</span><span class="w"> </span><span class="n">mode</span><span class="w">
          </span><span class="nc">As</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">compress</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">potentially</span><span class="w"> </span><span class="n">dangerous</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">controlling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">behaviour</span><span class="w">  </span><span class="n">of</span><span class="w">  </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="ow">when</span><span class="w">
          </span><span class="n">compression</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">allowed</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">allow</span><span class="o">-</span><span class="n">compression</span><span class="w">
             </span><span class="n">allow</span><span class="o">-</span><span class="n">compression</span><span class="w"> </span><span class="n">mode</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">values</span><span class="p">:</span><span class="w">

          </span><span class="n">asym</span><span class="w"> </span><span class="p" data-group-id="6403686110-1">(</span><span class="n">default</span><span class="p" data-group-id="6403686110-1">)</span><span class="w">
                 </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">decompress</span><span class="w"> </span><span class="n">downlink</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">compress</span><span class="w"> </span><span class="n">uplink</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">migrating</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">changing</span><span class="w">
                 </span><span class="n">both</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">configurations</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">feasible</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

          </span><span class="n">no</span><span class="w">     </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">refuse</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">stub</span><span class="w"> </span><span class="n">compression</span><span class="o">.</span><span class="w">

          </span><span class="n">yes</span><span class="w">    </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">compressed</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">auth</span><span class="w"> </span><span class="n">alg</span><span class="w">
          </span><span class="nc">Authenticate</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p" data-group-id="6403686110-2">(</span><span class="k">if</span><span class="w"> </span><span class="n">enabled</span><span class="p" data-group-id="6403686110-2">)</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">HMAC</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">digest</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="n">alg</span><span class="o">.</span><span class="w"> </span><span class="p" data-group-id="6403686110-3">(</span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nc">SHA1</span><span class="w">
          </span><span class="p" data-group-id="6403686110-3">)</span><span class="o">.</span><span class="w"> </span><span class="nc">HMAC</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">commonly</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="p" data-group-id="6403686110-4">(</span><span class="nc">MAC</span><span class="p" data-group-id="6403686110-4">)</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">secure</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">produce</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">digital</span><span class="w"> </span><span class="n">sig</span><span class="err">‐</span><span class="w">
          </span><span class="n">nature</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">encrypt</span><span class="o">-</span><span class="n">then</span><span class="o">-</span><span class="n">mac</span><span class="w"> </span><span class="p" data-group-id="6403686110-5">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">encrypt</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="nc">HMAC</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">resulting</span><span class="w"> </span><span class="n">ciphertext</span><span class="p" data-group-id="6403686110-5">)</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">prevents</span><span class="w"> </span><span class="n">padding</span><span class="w">  </span><span class="n">ora</span><span class="err">‐</span><span class="w">
          </span><span class="n">cle</span><span class="w"> </span><span class="n">attacks</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w">  </span><span class="n">an</span><span class="w">  </span><span class="nc">AEAD</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="p" data-group-id="6403686110-6">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="nc">GCM</span><span class="p" data-group-id="6403686110-6">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">chosen</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">ignored</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w">
          </span><span class="nc">AEAD</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">instead</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">alg</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">digest</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="o">.</span><span class="w">

          </span><span class="nc">In</span><span class="w"> </span><span class="n">static</span><span class="o">-</span><span class="n">key</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">HMAC</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">--</span><span class="n">genkey</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">HMAC</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">dynamically</span><span class="w"> </span><span class="n">generated</span><span class="w">  </span><span class="ow">and</span><span class="w">
          </span><span class="n">shared</span><span class="w">  </span><span class="n">between</span><span class="w">  </span><span class="n">peers</span><span class="w">  </span><span class="n">via</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">channel</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">receives</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">bad</span><span class="w"> </span><span class="nc">HMAC</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="o">.</span><span class="w"> </span><span class="nc">HMAC</span><span class="w"> </span><span class="n">usually</span><span class="w"> </span><span class="n">adds</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">20</span><span class="w">
          </span><span class="n">bytes</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">packet</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">alg</span><span class="o">=</span><span class="n">none</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="n">authentication</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">HMAC</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">www</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">ucsd</span><span class="o">.</span><span class="n">edu</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">mihir</span><span class="o">/</span><span class="n">papers</span><span class="o">/</span><span class="n">hmac</span><span class="o">.</span><span class="n">html</span><span class="w">

   </span><span class="o">--</span><span class="n">cipher</span><span class="w"> </span><span class="n">alg</span><span class="w">
          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">deprecated</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">server</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">possibly</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="o">-</span><span class="n">fallback</span><span class="err">`</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">instead</span><span class="o">.</span><span class="w">

          </span><span class="nc">Encrypt</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="n">alg</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nc">BF</span><span class="o">-</span><span class="nc">CBC</span><span class="p">,</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">abbreviation</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">Blowfish</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">Cipher</span><span class="w"> </span><span class="nc">Block</span><span class="w"> </span><span class="nc">Chaining</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="p" data-group-id="6403686110-7">(</span><span class="nc">NCP</span><span class="p" data-group-id="6403686110-7">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">allowed</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.4</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">newer</span><span class="w">  </span><span class="n">on</span><span class="w">
          </span><span class="n">both</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">upgrade</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">GCM</span><span class="o">.</span><span class="w">  </span><span class="nc">See</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">ncp</span><span class="o">-</span><span class="n">disable</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">NCP</span><span class="o">.</span><span class="w">

          </span><span class="nc">Using</span><span class="w">  </span><span class="nc">BF</span><span class="o">-</span><span class="nc">CBC</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="n">recommended</span><span class="p">,</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">size</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">small</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">attacks</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">collisions</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">demonstrated</span><span class="w"> </span><span class="n">by</span><span class="w">
          </span><span class="nc">SWEET32</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">community</span><span class="o">.</span><span class="n">openvpn</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">openvpn</span><span class="o">/</span><span class="n">wiki</span><span class="o">/</span><span class="nc">SWEET32</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="o">.</span><span class="w"> </span><span class="nc">Due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">BF</span><span class="o">-</span><span class="nc">CBC</span><span class="p">,</span><span class="w"> </span><span class="nc">DES</span><span class="p">,</span><span class="w"> </span><span class="nc">CAST5</span><span class="p">,</span><span class="w"> </span><span class="nc">IDEA</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">RC2</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w">
          </span><span class="n">removed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.6</span><span class="o">.</span><span class="w">

          </span><span class="nc">To</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="p">,</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

          </span><span class="nc">Set</span><span class="w"> </span><span class="n">alg</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">none</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="n">encryption</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">compress</span><span class="w"> </span><span class="n">algorithm</span><span class="w">
          </span><span class="nc">DEPRECATED</span><span class="w">  </span><span class="nc">Enable</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">compression</span><span class="w"> </span><span class="n">algorithm</span><span class="o">.</span><span class="w">  </span><span class="nc">Compression</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">generally</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">recommended</span><span class="o">.</span><span class="w">  </span><span class="nc">VPN</span><span class="w"> </span><span class="n">tunnels</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">susceptible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VO</span><span class="err">‐</span><span class="w">
          </span><span class="nc">RALCE</span><span class="w"> </span><span class="n">attack</span><span class="w"> </span><span class="n">vector</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">lzo</span><span class="p">,</span><span class="w"> </span><span class="n">lz4</span><span class="p">,</span><span class="w"> </span><span class="n">lz4</span><span class="o">-</span><span class="n">v2</span><span class="p">,</span><span class="w"> </span><span class="n">stub</span><span class="p">,</span><span class="w"> </span><span class="n">stub</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">empty</span><span class="o">.</span><span class="w">  </span><span class="nc">LZO</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">LZ4</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">algorithms</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">LZ4</span><span class="w"> </span><span class="n">generally</span><span class="w">  </span><span class="n">offer</span><span class="err">‐</span><span class="w">
          </span><span class="n">ing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">best</span><span class="w"> </span><span class="n">performance</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="n">usage</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">lz4</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">stub</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="n">variants</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">better</span><span class="w"> </span><span class="n">framing</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">overhead</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">compressed</span><span class="o">.</span><span class="w"> </span><span class="nc">All</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">variants</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">add</span><span class="w">
          </span><span class="n">one</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">framing</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">compared</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">framing</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">stub</span><span class="p">,</span><span class="w"> </span><span class="n">stub</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">empty</span><span class="p">,</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">turned</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">framing</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">will</span><span class="w">  </span><span class="n">still</span><span class="w">  </span><span class="n">be</span><span class="w">  </span><span class="n">enabled</span><span class="p">,</span><span class="w">
          </span><span class="n">allowing</span><span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="n">later</span><span class="o">.</span><span class="w">  </span><span class="nc">Additionally</span><span class="p">,</span><span class="w"> </span><span class="n">stub</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">stub</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="n">wil</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="n">announcing</span><span class="w"> </span><span class="n">lzo</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">lz4</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="nc">IV_</span><span class="w"> </span><span class="n">vari</span><span class="err">‐</span><span class="w">
          </span><span class="n">ables</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="o">.</span><span class="w">

          </span><span class="ss">Note</span><span class="p">:</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">stub</span><span class="w"> </span><span class="p" data-group-id="6403686110-8">(</span><span class="ow">or</span><span class="w"> </span><span class="n">empty</span><span class="p" data-group-id="6403686110-8">)</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nc">NOT</span><span class="w"> </span><span class="n">compatible</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="o">--</span><span class="n">comp</span><span class="o">-</span><span class="n">lzo</span><span class="w"> </span><span class="n">no</span><span class="o">.</span><span class="w">

          </span><span class="o">*</span><span class="nc">Security</span><span class="w"> </span><span class="nc">Considerations</span><span class="o">*</span><span class="w">

          </span><span class="nc">Compression</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">tricky</span><span class="w"> </span><span class="n">combination</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">attacker</span><span class="w"> </span><span class="n">knows</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="p" data-group-id="6403686110-9">(</span><span class="n">parts</span><span class="w"> </span><span class="n">of</span><span class="p" data-group-id="6403686110-9">)</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plain</span><span class="o">-</span><span class="n">text</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">that</span><span class="w">  </span><span class="n">contain</span><span class="w">  </span><span class="n">se</span><span class="err">‐</span><span class="w">
          </span><span class="n">crets</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">attacker</span><span class="w">  </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">extract</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">secret</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">CRIME</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">BREACH</span><span class="w"> </span><span class="n">attacks</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">VORACLE</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">VPNs</span><span class="w">
          </span><span class="n">which</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">leverage</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">break</span><span class="w"> </span><span class="n">encryption</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">entirely</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">traffic</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w">  </span><span class="n">advised</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="ow">not</span><span class="w">  </span><span class="n">enable</span><span class="w">
          </span><span class="n">compression</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">comp</span><span class="o">-</span><span class="n">lzo</span><span class="w"> </span><span class="n">mode</span><span class="w">
          </span><span class="nc">DEPRECATED</span><span class="w"> </span><span class="nc">Enable</span><span class="w"> </span><span class="nc">LZO</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">algorithm</span><span class="o">.</span><span class="w">  </span><span class="nc">Compression</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">generally</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">recommended</span><span class="o">.</span><span class="w">  </span><span class="nc">VPN</span><span class="w"> </span><span class="n">tunnels</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">suspectible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VO</span><span class="err">‐</span><span class="w">
          </span><span class="nc">RALCE</span><span class="w"> </span><span class="n">attack</span><span class="w"> </span><span class="n">vector</span><span class="o">.</span><span class="w">

          </span><span class="nc">Use</span><span class="w"> </span><span class="nc">LZO</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">incompressible</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">yes</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">adaptive</span><span class="w"> </span><span class="p" data-group-id="6403686110-10">(</span><span class="n">default</span><span class="p" data-group-id="6403686110-10">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">In</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">setup</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">selectively</span><span class="w"> </span><span class="n">turn</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">individual</span><span class="w"> </span><span class="n">clients</span><span class="o">.</span><span class="w">

          </span><span class="nc">First</span><span class="p">,</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">side</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">enables</span><span class="w"> </span><span class="n">selective</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">having</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">--</span><span class="n">comp</span><span class="o">-</span><span class="n">lzo</span><span class="w"> </span><span class="n">directive</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w">  </span><span class="o">--</span><span class="n">comp</span><span class="o">-</span><span class="n">lzo</span><span class="w">  </span><span class="n">no</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w">
          </span><span class="n">will</span><span class="w"> </span><span class="n">turn</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">dynamically</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">on</span><span class="o">/</span><span class="n">off</span><span class="o">/</span><span class="n">adaptive</span><span class="w"> </span><span class="n">setting</span><span class="o">.</span><span class="w">

          </span><span class="nc">Next</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">dir</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="ss">example</span><span class="p">:</span><span class="w">

             </span><span class="n">comp</span><span class="o">-</span><span class="n">lzo</span><span class="w"> </span><span class="n">yes</span><span class="w">
             </span><span class="n">push</span><span class="w"> </span><span class="s">&quot;comp-lzo yes&quot;</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">sets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">comp</span><span class="o">-</span><span class="n">lzo</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">link</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">sets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">side</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">comp</span><span class="o">-</span><span class="n">noadapt</span><span class="w">
          </span><span class="nc">DEPRECATED</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">conjunction</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">comp</span><span class="o">-</span><span class="n">lzo</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="sc">&#39;s adaptive compression algorithm. Normally, adaptive compression
          is enabled with --comp-lzo.

          Adaptive compression tries to optimize the case where you have compression enabled, but you are  sending  predominantly  incompressible  (or  pre-com‐
          pressed)  packets  over the tunnel, such as an FTP or rsync transfer of a large, compressed file. With adaptive compression, OpenVPN will periodically
          sample the compression process to measure its efficiency. If the data being sent over the tunnel is already  compressed,  the  compression  efficiency
          will be very low, triggering openvpn to disable compression for a period of time until the next re-sample test.

   --key-direction
          Alternative way of specifying the optional direction parameter for the --tls-auth and --secret options. Useful when using inline files (See section on
          inline files).

   --keysize n
          DEPRECATED This option will be removed in OpenVPN 2.6.

          Size of cipher key in bits (optional). If unspecified, defaults to cipher-specific default. The --show-ciphers option (see below) shows all  available
          OpenSSL ciphers, their default key sizes, and whether the key size can be changed. Use care in changing a cipher&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">size</span><span class="o">.</span><span class="w"> </span><span class="nc">Many</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">have</span><span class="w">
          </span><span class="ow">not</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">extensively</span><span class="w"> </span><span class="n">cryptanalyzed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">standard</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">lengths</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">larger</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">offer</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">real</span><span class="w"> </span><span class="n">guarantee</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">greater</span><span class="w"> </span><span class="n">security</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">reduce</span><span class="w">
          </span><span class="n">security</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="n">cipher</span><span class="o">-</span><span class="n">list</span><span class="w">
          </span><span class="nc">Restrict</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">allowed</span><span class="w">  </span><span class="n">ciphers</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">be</span><span class="w">  </span><span class="n">negotiated</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">cipher</span><span class="o">-</span><span class="n">list</span><span class="o">.</span><span class="w"> </span><span class="n">cipher</span><span class="o">-</span><span class="n">list</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">colon</span><span class="o">-</span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ciphers</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">defaults</span><span class="w"> </span><span class="n">to</span><span class="w">
          </span><span class="nc">AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">GCM</span><span class="ss">:AES</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="nc">GCM</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="n">servers</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">cipher</span><span class="o">-</span><span class="n">list</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">negotiation</span><span class="o">.</span><span class="w">

          </span><span class="nc">Cipher</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">server</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">only</span><span class="o">.</span><span class="w"> </span><span class="nc">I</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">--</span><span class="n">mode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="sc">&#39;server&#39;</span><span class="w"> </span><span class="p" data-group-id="6403686110-11">(</span><span class="n">server</span><span class="o">-</span><span class="n">side</span><span class="p">,</span><span class="w"> </span><span class="n">implied</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="o">--</span><span class="n">server</span><span class="w"> </span><span class="p" data-group-id="6403686110-11">)</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">if</span><span class="w">  </span><span class="o">--</span><span class="n">pull</span><span class="w">
          </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="p" data-group-id="6403686110-12">(</span><span class="n">client</span><span class="o">-</span><span class="n">side</span><span class="p">,</span><span class="w"> </span><span class="n">implied</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="p" data-group-id="6403686110-12">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w">  </span><span class="n">no</span><span class="w">  </span><span class="n">common</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">negotiation</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">terminated</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">clients</span><span class="o">/</span><span class="n">old</span><span class="w"> </span><span class="n">servers</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k" data-group-id="6403686110-13">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">ci</span><span class="err">‐</span><span class="w">
          </span><span class="n">pher</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="o">-</span><span class="n">fallback</span><span class="o">.</span><span class="w">

          </span><span class="nc">Additionally</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">smooth</span><span class="w"> </span><span class="n">transition</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nc">NCP</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">inherit</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w">
          </span><span class="n">local</span><span class="w">  </span><span class="o">--</span><span class="n">cipher</span><span class="w">  </span><span class="n">setting</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="o">.</span><span class="w"> </span><span class="nc">E</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">NCP</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="p" data-group-id="6403686110-14">(</span><span class="o">&lt;=</span><span class="n">v2</span><span class="o">.</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">ncp</span><span class="o">-</span><span class="n">disabled</span><span class="w">
          </span><span class="n">set</span><span class="p" data-group-id="6403686110-14">)</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NCP</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="p" data-group-id="6403686110-15">(</span><span class="n">v2</span><span class="o">.</span><span class="mi">4</span><span class="o">+</span><span class="p" data-group-id="6403686110-15">)</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">cipher</span><span class="w"> </span><span class="nc">BF</span><span class="o">-</span><span class="nc">CBC</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">GCM</span><span class="ss">:AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">CBC</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">can</span><span class="w">  </span><span class="n">either</span><span class="w">  </span><span class="n">specify</span><span class="w">  </span><span class="o">--</span><span class="n">cipher</span><span class="w">  </span><span class="nc">BF</span><span class="o">-</span><span class="nc">CBC</span><span class="w">  </span><span class="ow">or</span><span class="w">
          </span><span class="o">--</span><span class="n">cipher</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">CBC</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">work</span><span class="o">.</span><span class="w">

          </span><span class="nc">Note</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">NCP</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.4</span><span class="w"> </span><span class="ss">peer</span><span class="p">:</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">GCM</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="nc">GCM</span><span class="w"> </span><span class="n">ciphers</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">restricted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="mi">127</span><span class="w"> </span><span class="n">chars</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="k" data-group-id="6403686110-13">after</span><span class="w"> </span><span class="n">conversion</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">ciphers</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="o">--</span><span class="n">ncp</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.4</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">renamed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.5</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">accurately</span><span class="w"> </span><span class="n">reflect</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">meaning</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="o">-</span><span class="n">fallback</span><span class="w"> </span><span class="n">alg</span><span class="w">
          </span><span class="nc">Configure</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">fall</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">willing</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w">  </span><span class="n">option</span><span class="w">  </span><span class="n">should</span><span class="w">  </span><span class="n">only</span><span class="w">  </span><span class="n">be</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">peers</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.3</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">small</span><span class="w">
          </span><span class="p" data-group-id="6403686110-16">(</span><span class="n">typically</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">routers</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">embedded</span><span class="w"> </span><span class="n">devices</span><span class="p" data-group-id="6403686110-16">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">ncp</span><span class="o">-</span><span class="n">disable</span><span class="w">
          </span><span class="nc">DEPRECATED</span><span class="w"> </span><span class="nc">Disable</span><span class="w"> </span><span class="s">&quot;Negotiable Crypto Parameters&quot;</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">completely</span><span class="w"> </span><span class="n">disables</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">negotiation</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">secret</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Enable</span><span class="w"> </span><span class="nc">Static</span><span class="w"> </span><span class="nc">Key</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="p" data-group-id="6403686110-17">(</span><span class="n">non</span><span class="o">-</span><span class="nc">TLS</span><span class="p" data-group-id="6403686110-17">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Use</span><span class="w"> </span><span class="n">pre</span><span class="o">-</span><span class="n">shared</span><span class="w"> </span><span class="n">secret</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">genkey</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">secret</span><span class="w"> </span><span class="n">file</span><span class="w">
             </span><span class="n">secret</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">direction</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">enables</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">distinct</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="p" data-group-id="6403686110-18">(</span><span class="nc">HMAC</span><span class="o">-</span><span class="n">send</span><span class="p">,</span><span class="w"> </span><span class="n">cipher</span><span class="o">-</span><span class="n">encrypt</span><span class="p">,</span><span class="w"> </span><span class="nc">HMAC</span><span class="o">-</span><span class="k">receive</span><span class="p">,</span><span class="w"> </span><span class="n">cipher</span><span class="o">-</span><span class="n">decrypt</span><span class="p" data-group-id="6403686110-18">)</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">data</span><span class="w">  </span><span class="n">flow</span><span class="w">
          </span><span class="n">direction</span><span class="w">  </span><span class="n">has</span><span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">HMAC</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">keys</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">desirable</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">eliminating</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="n">kinds</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">DoS</span><span class="w">
          </span><span class="ow">and</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">replay</span><span class="w"> </span><span class="n">attacks</span><span class="o">.</span><span class="w">

          </span><span class="nc">When</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">bidirectionally</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">HMAC</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">encryption</span><span class="o">/</span><span class="n">decryption</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">complementary</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w">  </span><span class="n">should</span><span class="w">  </span><span class="kn">use</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="ow">or</span><span class="w">
          </span><span class="n">both</span><span class="w"> </span><span class="n">sides</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">omit</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">altogether</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w">  </span><span class="n">direction</span><span class="w">  </span><span class="n">parameter</span><span class="w">  </span><span class="n">requires</span><span class="w">  </span><span class="n">that</span><span class="w">  </span><span class="n">file</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="mi">2048</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="w"> </span><span class="nc">While</span><span class="w"> </span><span class="n">pre</span><span class="o">-</span><span class="mf">1.5</span><span class="w"> </span><span class="n">versions</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w">
          </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="n">parameter</span><span class="p">,</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="mi">2048</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">generation</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

          </span><span class="nc">Static</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="n">advantages</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">primary</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">ease</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">configuration</span><span class="o">.</span><span class="w">

          </span><span class="nc">There</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">authorities</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">complicated</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="n">handshakes</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">protocols</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">requirement</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">that</span><span class="w">  </span><span class="n">you</span><span class="w">  </span><span class="n">have</span><span class="w">  </span><span class="n">a</span><span class="w">
          </span><span class="n">pre</span><span class="o">-</span><span class="n">existing</span><span class="w">  </span><span class="n">secure</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="p" data-group-id="6403686110-19">(</span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">ssh</span><span class="p" data-group-id="6403686110-19">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">initially</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">requirement</span><span class="p">,</span><span class="w"> </span><span class="n">along</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fact</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">changes</span><span class="w">
          </span><span class="k">unless</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">manually</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">somewhat</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">secure</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="p" data-group-id="6403686110-20">(</span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="p" data-group-id="6403686110-20">)</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">attacker</span><span class="w"> </span><span class="n">manages</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">steal</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w">  </span><span class="n">everything</span><span class="w">
          </span><span class="n">that</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">ever</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">compromised</span><span class="o">.</span><span class="w"> </span><span class="nc">Contrast</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">perfect</span><span class="w"> </span><span class="n">forward</span><span class="w"> </span><span class="n">secrecy</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="p" data-group-id="6403686110-21">(</span><span class="n">using</span><span class="w"> </span><span class="nc">Diffie</span><span class="w"> </span><span class="nc">Hellman</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">exchange</span><span class="p" data-group-id="6403686110-21">)</span><span class="p">,</span><span class="w">
          </span><span class="n">where</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">attacker</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">steal</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">he</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">gain</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">help</span><span class="w"> </span><span class="n">him</span><span class="w"> </span><span class="n">decrypt</span><span class="w"> </span><span class="n">past</span><span class="w"> </span><span class="n">sessions</span><span class="o">.</span><span class="w">

          </span><span class="nc">Another</span><span class="w"> </span><span class="n">advantageous</span><span class="w"> </span><span class="n">aspect</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">Static</span><span class="w"> </span><span class="nc">Key</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">handshake</span><span class="o">-</span><span class="n">free</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">without</span><span class="w">  </span><span class="n">any</span><span class="w">  </span><span class="n">distinguishing</span><span class="w">  </span><span class="n">signature</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="n">feature</span><span class="w">
          </span><span class="p" data-group-id="6403686110-22">(</span><span class="n">such</span><span class="w">  </span><span class="n">as</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">header</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">handshake</span><span class="w"> </span><span class="n">sequence</span><span class="p" data-group-id="6403686110-22">)</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">mark</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ciphertext</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="o">.</span><span class="w"> </span><span class="nc">Anyone</span><span class="w"> </span><span class="n">eavesdropping</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w">
          </span><span class="n">wire</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">random</span><span class="o">-</span><span class="n">looking</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tran</span><span class="o">-</span><span class="n">window</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Transition</span><span class="w"> </span><span class="n">window</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">live</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="k" data-group-id="6403686110-13">after</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">renegotiation</span><span class="w"> </span><span class="n">begins</span><span class="w"> </span><span class="p" data-group-id="6403686110-23">(</span><span class="n">default</span><span class="w"> </span><span class="mi">3600</span><span class="w"> </span><span class="n">seconds</span><span class="p" data-group-id="6403686110-23">)</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="n">allows</span><span class="w">  </span><span class="k">for</span><span class="w">  </span><span class="n">a</span><span class="w">
          </span><span class="n">graceful</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">removes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">renegotiation</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">critical</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">forwarding</span><span class="o">.</span></code></pre><p>   Client Options</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="o">--</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">server</span><span class="o">-</span><span class="n">bridge</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">mode</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">configuration</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">allow</span><span class="o">-</span><span class="n">pull</span><span class="o">-</span><span class="n">fqdn</span><span class="w">
          </span><span class="nc">Allow</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">pull</span><span class="w"> </span><span class="nc">DNS</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="p" data-group-id="4673452571-1">(</span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">limited</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="p" data-group-id="4673452571-1">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">gateway</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">allow</span><span class="o">-</span><span class="n">recursive</span><span class="o">-</span><span class="n">routing</span><span class="w">
          </span><span class="nc">When</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="n">incoming</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">host</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">token</span><span class="w"> </span><span class="n">token</span><span class="w">
          </span><span class="nc">This</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="ow">not</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">directly</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">--</span><span class="n">plugin</span><span class="w"> </span><span class="n">which</span><span class="w">
          </span><span class="n">hooks</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OPENVPN_PLUGIN_CLIENT_CONNECT</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">OPENVPN_PLUGIN_CLIENT_CONNECT_V2</span><span class="w"> </span><span class="n">calls</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">a</span><span class="w">  </span><span class="n">possibility</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">replace</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">clients</span><span class="w">
          </span><span class="n">password</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">lifetime</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w">

          </span><span class="nc">Whenever</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">renegotiated</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">plugin</span><span class="w"> </span><span class="n">making</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OPENVPN_PLUGIN_AUTH_USER_PASS_VERIFY</span><span class="w"> </span><span class="n">hook</span><span class="w">
          </span><span class="n">is</span><span class="w"> </span><span class="n">triggered</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">provided</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">by</span><span class="w">  </span><span class="n">a</span><span class="w">
          </span><span class="n">full</span><span class="w">  </span><span class="n">reconnect</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">entered</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">preserved</span><span class="w"> </span><span class="n">once</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">has</span><span class="w">
          </span><span class="n">been</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">rejects</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">AUTH_FAILED</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">disconnect</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">purpose</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">methods</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">HOTP</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">TOTP</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">needing</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">retrieve</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="nc">OTP</span><span class="w">  </span><span class="n">code</span><span class="w">  </span><span class="n">each</span><span class="w">
          </span><span class="n">time</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">renegotiated</span><span class="o">.</span><span class="w"> </span><span class="nc">Another</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">needing</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">cached</span><span class="w">
          </span><span class="ow">in</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">life</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">session</span><span class="o">.</span><span class="w">

          </span><span class="nc">To</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">feature</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">plugin</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">put</span><span class="w">

             </span><span class="n">push</span><span class="w"> </span><span class="s">&quot;auth-token UNIQUE_TOKEN_VALUE&quot;</span><span class="w">

          </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="o">/</span><span class="n">buffer</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">replaces</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w">
          </span><span class="n">password</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">UNIQUE_TOKEN_VALUE</span><span class="o">.</span><span class="w">

          </span><span class="nc">Newer</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="p" data-group-id="4673452571-2">(</span><span class="mf">2.4</span><span class="o">.</span><span class="mi">7</span><span class="o">+</span><span class="p" data-group-id="4673452571-2">)</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">fall</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">failed</span><span class="w"> </span><span class="n">auth</span><span class="o">.</span><span class="w"> </span><span class="nc">Older</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">react</span><span class="w"> </span><span class="n">ac</span><span class="err">‐</span><span class="w">
          </span><span class="n">cording</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">retry</span><span class="w">

   </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="w">
          </span><span class="nc">Authenticate</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="w">
             </span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="w"> </span><span class="n">up</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">present</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">lines</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">missing</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">one</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">prompted</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">console</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">verify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">retry</span><span class="w"> </span><span class="n">type</span><span class="w">
          </span><span class="nc">Controls</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">responds</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="n">verification</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">side</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">AUTH_FAILED</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">server</span><span class="w">  </span><span class="ow">or</span><span class="w">
          </span><span class="n">verification</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">password</span><span class="o">.</span><span class="w">

          </span><span class="nc">Normally</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">auth</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">fatal</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">permit</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="n">requeries</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">

          </span><span class="nc">An</span><span class="w">  </span><span class="nc">AUTH_FAILED</span><span class="w">  </span><span class="n">message</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">fails</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="w"> </span><span class="n">authentication</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="o">-</span><span class="n">side</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">script</span><span class="w">
          </span><span class="n">returns</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">tries</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="o">.</span><span class="w">

          </span><span class="n">type</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ss">of</span><span class="p">:</span><span class="w">

          </span><span class="n">none</span><span class="w">   </span><span class="nc">Client</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fatal</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p" data-group-id="4673452571-3">(</span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="p" data-group-id="4673452571-3">)</span><span class="o">.</span><span class="w">

          </span><span class="n">nointeract</span><span class="w">
                 </span><span class="nc">Client</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">retry</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">requerying</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="o">.</span><span class="w"> </span><span class="nc">Use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">unattended</span><span class="w"> </span><span class="n">clients</span><span class="o">.</span><span class="w">

          </span><span class="n">interact</span><span class="w">
                 </span><span class="nc">Client</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">requery</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">attempting</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">reconnection</span><span class="o">.</span><span class="w">

          </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">pushed</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">controlled</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">client</span><span class="w">
          </span><span class="nc">A</span><span class="w"> </span><span class="n">helper</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">designed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">simplify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="sc">&#39;s client mode. This directive is equivalent to:

             pull
             tls-client

   --client-nat args
          This pushable client option sets up a stateless one-to-one NAT rule on packet addresses (not ports), and is useful in cases where routes  or  ifconfig
          settings pushed to the client would create an IP numbering conflict.

          Examples:

             client-nat snat 192.168.0.0/255.255.0.0
             client-nat dnat 10.64.0.0/255.255.0.0

          network/netmask (for example 192.168.0.0/255.255.0.0) defines the local view of a resource from the client perspective, while alias/netmask (for exam‐
          ple 10.64.0.0/255.255.0.0) defines the remote view from the server perspective.

          Use snat (source NAT) for resources owned by the client and dnat (destination NAT) for remote resources.

          Set --verb 6 for debugging info showing the transformation of src/dest addresses in packets.

   --connect-retry n
          Wait n seconds between connection attempts (default 5).  Repeated reconnection attempts are slowed down after 5 retries per  remote  by  doubling  the
          wait  time  after each unsuccessful attempt. An optional argument max specifies the maximum value of wait time in seconds at which it gets capped (de‐
          fault 300).

   --connect-retry-max n
          n specifies the number of times each --remote or &lt;connection&gt; entry is tried. Specifying n as 1 would try each entry exactly once. A  successful  con‐
          nection resets the counter.  (default unlimited).

   --connect-timeout n
          See --server-poll-timeout.

   --explicit-exit-notify n
          In  UDP client mode or point-to-point mode, send server/peer an exit notification if tunnel is restarted or OpenVPN process is exited. In client mode,
          on exit/restart, this option will tell the server to immediately close its client instance object rather than waiting for a timeout.

          The n parameter (default 1 if not present) controls the maximum number of attempts that the client will try to resend the exit notification message.

          In UDP server mode, send RESTART control channel command to connected clients. The n parameter (default 1 if not present)  controls  client  behavior.
          With n = 1 client will attempt to reconnect to the same server, with n = 2 client will advance to the next server.

          OpenVPN will not send any exit notifications unless this option is enabled.

   --inactive args
          Causes  OpenVPN to exit after n seconds of inactivity on the TUN/TAP device. The time length of inactivity is measured since the last incoming or out‐
          going tunnel packet. The default value is 0 seconds, which disables this feature.

          Valid syntaxes:

             inactive n
             inactive n bytes

          If the optional bytes parameter is included, exit if less than bytes of combined in/out traffic are produced on the tun/tap device in n seconds.

          In any case, OpenVPN&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="p" data-group-id="4673452571-4">(</span><span class="n">which</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">keepalives</span><span class="p" data-group-id="4673452571-4">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">considered</span><span class="w"> </span><span class="s">&quot;activity&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">nor</span><span class="w"> </span><span class="n">are</span><span class="w">  </span><span class="n">they</span><span class="w">  </span><span class="n">counted</span><span class="w">
          </span><span class="n">as</span><span class="w"> </span><span class="n">traffic</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">internally</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">indication</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">activity</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">proto</span><span class="o">-</span><span class="n">force</span><span class="w"> </span><span class="n">p</span><span class="w">
          </span><span class="nc">When</span><span class="w"> </span><span class="n">iterating</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">profiles</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">consider</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p" data-group-id="4673452571-5">(</span><span class="n">tcp</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">udp</span><span class="p" data-group-id="4673452571-5">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">pull</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="n">server</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w">
          </span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">legal</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">pushable</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p" data-group-id="4673452571-6">(</span><span class="n">note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">pull</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">implied</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="w"> </span><span class="p" data-group-id="4673452571-6">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">In</span><span class="w"> </span><span class="n">particular</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">pull</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="o">--</span><span class="n">pull</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">situations</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">don</span><span class="sc">&#39;t trust the
          server to have control over the client&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">pull</span><span class="o">-</span><span class="n">filter</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Filter</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">pull</span><span class="o">-</span><span class="n">filter</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="n">text</span><span class="w">
             </span><span class="n">pull</span><span class="o">-</span><span class="n">filter</span><span class="w"> </span><span class="n">ignore</span><span class="w"> </span><span class="n">text</span><span class="w">
             </span><span class="n">pull</span><span class="o">-</span><span class="n">filter</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="n">text</span><span class="w">

          </span><span class="nc">Filter</span><span class="w">  </span><span class="n">options</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">starts</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">text</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">ignore</span><span class="w"> </span><span class="n">removes</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="n">flags</span><span class="w">
          </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">triggers</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">SIGUSR1</span><span class="w"> </span><span class="n">restart</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">order</span><span class="w">  </span><span class="n">it</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">specified</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w">
          </span><span class="n">filtering</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">stops</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">soon</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">found</span><span class="o">.</span><span class="w"> </span><span class="nc">Unmatched</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">accepted</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="o">.</span><span class="w">

          </span><span class="nc">Prefix</span><span class="w"> </span><span class="n">comparison</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w">

             </span><span class="n">pull</span><span class="o">-</span><span class="n">filter</span><span class="w"> </span><span class="n">ignore</span><span class="w"> </span><span class="s">&quot;route&quot;</span><span class="w">

          </span><span class="n">would</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">include</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">route</span><span class="o">-</span><span class="n">gateway</span><span class="o">.</span><span class="w"> </span><span class="nc">Enclose</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">quotes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">embed</span><span class="w"> </span><span class="n">spaces</span><span class="o">.</span><span class="w">

             </span><span class="n">pull</span><span class="o">-</span><span class="n">filter</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="s">&quot;route 192.168.1.&quot;</span><span class="w">
             </span><span class="n">pull</span><span class="o">-</span><span class="n">filter</span><span class="w"> </span><span class="n">ignore</span><span class="w"> </span><span class="s">&quot;route &quot;</span><span class="w">

          </span><span class="n">would</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k" data-group-id="4673452571-7">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="mf">192.168</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="w">

          </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">repeated</span><span class="w"> </span><span class="n">cycle</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reconnect</span><span class="p">,</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">remotes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">suc</span><span class="err">‐</span><span class="w">
          </span><span class="n">ceeds</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">silently</span><span class="w"> </span><span class="n">ignore</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">ignore</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Remote</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">protocol</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="w">
             </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">port</span><span class="w">
             </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">proto</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">optional</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">host</span><span class="ss">:port</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">protocol</span><span class="w">
          </span><span class="n">to</span><span class="w">  </span><span class="kn">use</span><span class="w">  </span><span class="ow">when</span><span class="w">  </span><span class="n">connecting</span><span class="w">  </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">udp</span><span class="o">.</span><span class="w">  </span><span class="nc">To</span><span class="w"> </span><span class="n">enforce</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">suffix</span><span class="p">;</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">udp4</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">udp6</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">tcp4</span><span class="w"> </span><span class="o">/</span><span class="w">
          </span><span class="n">tcp6</span><span class="o">.</span><span class="w">

          </span><span class="nc">On</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">redundancy</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">referring</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w">  </span><span class="n">the</span><span class="w">
          </span><span class="n">list</span><span class="w">  </span><span class="n">of</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w"> </span><span class="nc">Specifying</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">purpose</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="n">connection</span><span class="o">-</span><span class="n">profile</span><span class="w"> </span><span class="n">feature</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="w"> </span><span class="n">documentation</span><span class="w"> </span><span class="n">below</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">failure</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">most</span><span class="w">
          </span><span class="n">be</span><span class="w"> </span><span class="n">connected</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">server</span><span class="o">.</span><span class="w">

          </span><span class="ss">Examples</span><span class="p">:</span><span class="w">

             </span><span class="n">remote</span><span class="w"> </span><span class="n">server1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">net</span><span class="w">
             </span><span class="n">remote</span><span class="w"> </span><span class="n">server1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">net</span><span class="w"> </span><span class="mi">1194</span><span class="w">
             </span><span class="n">remote</span><span class="w"> </span><span class="n">server2</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">net</span><span class="w"> </span><span class="mi">1194</span><span class="w"> </span><span class="n">tcp</span><span class="w">

          </span><span class="ss">Note</span><span class="p">:</span><span class="w">  </span><span class="nc">Since</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">connectionless</span><span class="p">,</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="o">-</span><span class="n">restart</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w">

                 </span><span class="nc">Also</span><span class="p">,</span><span class="w">  </span><span class="k">if</span><span class="w">  </span><span class="n">you</span><span class="w">  </span><span class="kn">use</span><span class="w">  </span><span class="n">multiple</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">options</span><span class="p">,</span><span class="w"> </span><span class="nc">AND</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">dropping</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">user</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">group</span><span class="w"> </span><span class="nc">AND</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">is</span><span class="w">
                 </span><span class="n">running</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">Windows</span><span class="w"> </span><span class="nc">OS</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">switch</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">pushes</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">settings</span><span class="p">,</span><span class="w">
                 </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">lack</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">necessary</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reopen</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fatal</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">unspecified</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">listen</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">act</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">authentication</span><span class="w">
          </span><span class="n">tests</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">requirement</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">binding</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">potential</span><span class="w"> </span><span class="n">peers</span><span class="p">,</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">supposedly</span><span class="w"> </span><span class="n">trusted</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">addresses</span><span class="w">  </span><span class="p" data-group-id="4673452571-8">(</span><span class="n">it</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">very</span><span class="w">
          </span><span class="n">easy</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">forge</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">packet</span><span class="p" data-group-id="4673452571-8">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">When</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">act</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">filter</span><span class="p">,</span><span class="w"> </span><span class="n">rejecting</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">host</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">DNS</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">resolves</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">addresses</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">getaddrinfo</span><span class="p" data-group-id="4673452571-9">(</span><span class="p" data-group-id="4673452571-9">)</span><span class="w"> </span><span class="n">presents</span><span class="w"> </span><span class="n">them</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">pri</span><span class="err">‐</span><span class="w">
          </span><span class="n">orization</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">DNS</span><span class="w"> </span><span class="n">randomization</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">library</span><span class="o">.</span><span class="w"> </span><span class="nc">Unless</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">forced</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">specification</span><span class="w"> </span><span class="p" data-group-id="4673452571-10">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">6</span><span class="w"> </span><span class="n">suffix</span><span class="p" data-group-id="4673452571-10">)</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w">
          </span><span class="k">try</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">addresses</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">getaddrinfo</span><span class="p" data-group-id="4673452571-11">(</span><span class="p" data-group-id="4673452571-11">)</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">them</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">remote</span><span class="o">-</span><span class="n">random</span><span class="w">
          </span><span class="nc">When</span><span class="w">  </span><span class="n">multiple</span><span class="w">  </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">address</span><span class="o">/</span><span class="n">ports</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w"> </span><span class="n">initially</span><span class="w"> </span><span class="n">randomize</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">kind</span><span class="w"> </span><span class="n">of</span><span class="w">
          </span><span class="n">basic</span><span class="w"> </span><span class="n">load</span><span class="o">-</span><span class="n">balancing</span><span class="w"> </span><span class="n">measure</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">remote</span><span class="o">-</span><span class="n">random</span><span class="o">-</span><span class="n">hostname</span><span class="w">
          </span><span class="nc">Prepend</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="p" data-group-id="4673452571-12">(</span><span class="mi">6</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="n">hex</span><span class="w"> </span><span class="n">characters</span><span class="p" data-group-id="4673452571-12">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">hostname</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="nc">DNS</span><span class="w"> </span><span class="n">caching</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w">  </span><span class="n">example</span><span class="p">,</span><span class="w">  </span><span class="s">&quot;foo.bar.gov&quot;</span><span class="w">  </span><span class="n">would</span><span class="w">  </span><span class="n">be</span><span class="w">  </span><span class="n">modified</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="s">&quot;&lt;ran‐
          dom-chars&gt;.foo.bar.gov&quot;</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">resolv</span><span class="o">-</span><span class="n">retry</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">If</span><span class="w"> </span><span class="n">hostname</span><span class="w"> </span><span class="n">resolve</span><span class="w"> </span><span class="n">fails</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="p">,</span><span class="w"> </span><span class="n">retry</span><span class="w"> </span><span class="n">resolve</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">failing</span><span class="o">.</span><span class="w">

          </span><span class="nc">Set</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s">&quot;infinite&quot;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">retry</span><span class="w"> </span><span class="n">indefinitely</span><span class="o">.</span><span class="w">

          </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">resolv</span><span class="o">-</span><span class="n">retry</span><span class="w"> </span><span class="n">infinite</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="o">.</span><span class="w"> </span><span class="nc">You</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">single</span><span class="o">-</span><span class="n">session</span><span class="w">
          </span><span class="nc">After</span><span class="w">  </span><span class="n">initially</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">peer</span><span class="p">,</span><span class="w"> </span><span class="n">disallow</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">connections</span><span class="o">.</span><span class="w"> </span><span class="nc">Using</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">connect</span><span class="p">,</span><span class="w"> </span><span class="n">disconnect</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w">
          </span><span class="n">then</span><span class="w"> </span><span class="n">reconnect</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">daemon</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="o">-</span><span class="n">restart</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w">

          </span><span class="o">--</span><span class="n">single</span><span class="o">-</span><span class="n">session</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="o">-</span><span class="n">exit</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">inactive</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">finished</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">server</span><span class="o">-</span><span class="n">poll</span><span class="o">-</span><span class="n">timeout</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">When</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="k" data-group-id="4673452571-13">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">trying</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">server</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w">  </span><span class="mi">120</span><span class="n">s</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w">
          </span><span class="n">timeout</span><span class="w"> </span><span class="n">includes</span><span class="w"> </span><span class="n">proxy</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">timeouts</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">static</span><span class="o">-</span><span class="n">challenge</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Enable</span><span class="w"> </span><span class="n">static</span><span class="w"> </span><span class="n">challenge</span><span class="o">/</span><span class="n">response</span><span class="w"> </span><span class="n">protocol</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">static</span><span class="o">-</span><span class="n">challenge</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="n">echo</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="n">challenge</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">presented</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">describes</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">requested</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w">
          </span><span class="n">echoed</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">screen</span><span class="o">.</span><span class="w">  </span><span class="nc">Valid</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="w">

          </span><span class="nc">See</span><span class="w"> </span><span class="n">management</span><span class="o">-</span><span class="n">notes</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">challenge</span><span class="o">/</span><span class="n">response</span><span class="w"> </span><span class="n">protocol</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">proxy</span><span class="o">-</span><span class="n">settings</span><span class="w">
          </span><span class="nc">Show</span><span class="w"> </span><span class="n">sensed</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">SOCKS</span><span class="w"> </span><span class="n">proxy</span><span class="w"> </span><span class="n">settings</span><span class="o">.</span><span class="w"> </span><span class="nc">Currently</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="n">proxy</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">argument</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="nc">Proxy</span><span class="o">-</span><span class="nc">Authenticate</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">required</span><span class="p">,</span><span class="w">  </span><span class="n">a</span><span class="w">
          </span><span class="n">file</span><span class="w">  </span><span class="n">name</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">an</span><span class="w">  </span><span class="n">authfile</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">stdin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">console</span><span class="o">.</span><span class="w"> </span><span class="nc">Its</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w">
          </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w"> </span><span class="p" data-group-id="4673452571-14">(</span><span class="nc">See</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">inline</span><span class="w"> </span><span class="n">files</span><span class="p" data-group-id="4673452571-14">)</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">auth</span><span class="o">-</span><span class="n">method</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">none</span><span class="p">,</span><span class="w"> </span><span class="n">basic</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">ntlm</span><span class="o">.</span><span class="w">

          </span><span class="nc">HTTP</span><span class="w"> </span><span class="nc">Digest</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">auto</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">auto</span><span class="o">-</span><span class="n">nct</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="p" data-group-id="4673452571-15">(</span><span class="n">below</span><span class="p" data-group-id="4673452571-15">)</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">authfile</span><span class="w"> </span><span class="n">argument</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">auto</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">causes</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">auth</span><span class="o">-</span><span class="n">method</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">stdin</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="n">credentials</span><span class="p">,</span><span class="w">
          </span><span class="k">if</span><span class="w"> </span><span class="n">required</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">exists</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.1</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">higher</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w">  </span><span class="n">auto</span><span class="o">-</span><span class="n">nct</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="p" data-group-id="4673452571-16">(</span><span class="n">no</span><span class="w"> </span><span class="n">clear</span><span class="o">-</span><span class="n">text</span><span class="w"> </span><span class="n">auth</span><span class="p" data-group-id="4673452571-16">)</span><span class="w"> </span><span class="n">instructs</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="n">weak</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">pro</span><span class="err">‐</span><span class="w">
          </span><span class="n">tocols</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="nc">Basic</span><span class="w"> </span><span class="nc">Authentication</span><span class="o">.</span><span class="w">

          </span><span class="ss">Examples</span><span class="p">:</span><span class="w">

             </span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="w"> </span><span class="n">proxy</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">net</span><span class="w"> </span><span class="mi">3128</span><span class="w">
             </span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="w"> </span><span class="n">proxy</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">net</span><span class="w"> </span><span class="mi">3128</span><span class="w"> </span><span class="n">authfile</span><span class="o">.</span><span class="n">txt</span><span class="w">
             </span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="w"> </span><span class="n">proxy</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">net</span><span class="w"> </span><span class="mi">3128</span><span class="w"> </span><span class="n">stdin</span><span class="w">
             </span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="w"> </span><span class="n">proxy</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">net</span><span class="w"> </span><span class="mi">3128</span><span class="w"> </span><span class="n">auto</span><span class="w"> </span><span class="n">basic</span><span class="w">
             </span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="w"> </span><span class="n">proxy</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">net</span><span class="w"> </span><span class="mi">3128</span><span class="w"> </span><span class="n">auto</span><span class="o">-</span><span class="n">nct</span><span class="w"> </span><span class="n">ntlm</span><span class="w">

   </span><span class="o">--</span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="o">-</span><span class="n">option</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="n">extended</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="n">proxy</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w"> </span><span class="nc">Requires</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="o">.</span><span class="w">  </span><span class="nc">Repeat</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w">

          </span><span class="nc">VERSION</span><span class="w"> </span><span class="n">version</span><span class="w">
                 </span><span class="nc">Set</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="p" data-group-id="4673452571-17">(</span><span class="n">default</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="4673452571-17">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">AGENT</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="n">agent</span><span class="w">
                 </span><span class="nc">Set</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="s">&quot;User-Agent&quot;</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="n">agent</span><span class="o">.</span><span class="w">

          </span><span class="nc">CUSTOM</span><span class="o">-</span><span class="nc">HEADER</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">content</span><span class="w">
                 </span><span class="nc">Adds</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="nc">Header</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="n">header</span><span class="o">.</span><span class="w">

          </span><span class="ss">Examples</span><span class="p">:</span><span class="w">

             </span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="o">-</span><span class="n">option</span><span class="w"> </span><span class="nc">VERSION</span><span class="w"> </span><span class="mf">1.1</span><span class="w">
             </span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="o">-</span><span class="n">option</span><span class="w"> </span><span class="nc">AGENT</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="o">/</span><span class="mf">2.4</span><span class="w">
             </span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="o">-</span><span class="n">option</span><span class="w"> </span><span class="nc">X</span><span class="o">-</span><span class="nc">Proxy</span><span class="o">-</span><span class="nc">Flag</span><span class="w"> </span><span class="n">some</span><span class="o">-</span><span class="n">flags</span><span class="w">

   </span><span class="o">--</span><span class="n">socks</span><span class="o">-</span><span class="n">proxy</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">Socks5</span><span class="w"> </span><span class="n">proxy</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">required</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">needed</span><span class="o">.</span><span class="w">  </span><span class="nc">Optionally</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="p" data-group-id="4673452571-18">(</span><span class="n">default</span><span class="w"> </span><span class="mi">1080</span><span class="p" data-group-id="4673452571-18">)</span><span class="w"> </span><span class="ow">and</span><span class="w">  </span><span class="n">authfile</span><span class="w">  </span><span class="n">can</span><span class="w">  </span><span class="n">be</span><span class="w">  </span><span class="n">given</span><span class="o">.</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">authfile</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">lines</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">stdin</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">console</span><span class="o">.</span></code></pre><p>   Server Options</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Starting</span><span class="w">  </span><span class="k">with</span><span class="w">  </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">UDP</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">supported</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">mode</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w">
   </span><span class="n">listen</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">incoming</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">connections</span><span class="o">.</span><span class="w"> </span><span class="nc">All</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">routed</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">tap</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">mode</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">designed</span><span class="w">
   </span><span class="k">for</span><span class="w">  </span><span class="n">scalability</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">should</span><span class="w">  </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">hundreds</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">thousands</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">sufficiently</span><span class="w"> </span><span class="n">fast</span><span class="w"> </span><span class="n">hardware</span><span class="o">.</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w">
   </span><span class="n">this</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">gen</span><span class="o">-</span><span class="n">token</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Returns</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">authenticated</span><span class="w"> </span><span class="n">clients</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">auth</span><span class="o">-</span><span class="n">gen</span><span class="o">-</span><span class="n">token</span><span class="w"> </span><span class="p" data-group-id="1626791394-1">[</span><span class="n">lifetime</span><span class="p" data-group-id="1626791394-1">]</span><span class="w"> </span><span class="p" data-group-id="1626791394-2">[</span><span class="n">external</span><span class="o">-</span><span class="n">auth</span><span class="p" data-group-id="1626791394-2">]</span><span class="w">

          </span><span class="nc">After</span><span class="w"> </span><span class="n">successful</span><span class="w"> </span><span class="n">user</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="n">authentication</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">temporary</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w">
          </span><span class="n">client</span><span class="o">.</span><span class="w">  </span><span class="nc">On</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">renegotiations</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">password</span><span class="o">.</span><span class="w"> </span><span class="nc">On</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k" data-group-id="1626791394-3">do</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">internally</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="nc">NOT</span><span class="w"> </span><span class="k" data-group-id="1626791394-4">do</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">authentications</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="n">external</span><span class="w"> </span><span class="n">user</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="n">authentication</span><span class="w">  </span><span class="n">mecha</span><span class="err">‐</span><span class="w">
          </span><span class="n">nisms</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">tokens</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">mechanism</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">timestamp</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">renew</span><span class="w"> </span><span class="n">timestamp</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">secured</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">HMAC</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w">  </span><span class="n">lifetime</span><span class="w">  </span><span class="n">argument</span><span class="w">  </span><span class="n">defines</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">valid</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">lifetime</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">seconds</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">lifetime</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">expire</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">expire</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="k" data-group-id="1626791394-4">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="n">lifetime</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reached</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k" data-group-id="1626791394-4">after</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">renewed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">than</span><span class="w">  </span><span class="mi">2</span><span class="w">  </span><span class="o">*</span><span class="w">  </span><span class="n">reneg</span><span class="o">-</span><span class="n">sec</span><span class="w">  </span><span class="n">seconds</span><span class="o">.</span><span class="w">
          </span><span class="nc">Clients</span><span class="w">  </span><span class="n">will</span><span class="w">  </span><span class="n">be</span><span class="w">  </span><span class="n">sent</span><span class="w">  </span><span class="n">renewed</span><span class="w"> </span><span class="n">tokens</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">renogiation</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="sc">&#39;s token updated. This is done to invalidate a token if a client is
          disconnected for a sufficently long time, while at the same time permitting much longer token lifetimes for active clients.

          This feature is useful for environments which are configured to use One Time Passwords (OTP) as part of the user/password authentications and that au‐
          thentication mechanism does not implement any auth-token support.

          When  the external-auth keyword is present the normal authentication method will always be called even if auth-token succeeds.  Normally other authen‐
          tications method are skipped if auth-token verification suceeds or fails.

          This option postpones this decision to the external authentication methods and checks the validity of the account and do other checks.

          In this mode the environment will have a session_id variable that holds the session id from auth-gen-token. Also an environment variable session_state
          is present. This variable indicates whether the auth-token has succeeded or not. It can have the following values:

          Initial
                 No token from client.

          Authenticated
                 Token is valid and not expired.

          Expired
                 Token is valid but has expired.

          Invalid
                 Token is invalid (failed HMAC or wrong length)

          AuthenticatedEmptyUser / ExpiredEmptyUser
                 The  token is not valid with the username sent from the client but would be valid (or expired) if we assume an empty username was used instead.
                 These two cases are a workaround for behaviour in OpenVPN 3.  If this workaround is not needed these two cases should be handled  in  the  same
                 way as Invalid.

          Warning:  Use  this  feature  only if you want your authentication method called on every verification. Since the external authentication is called it
          needs to also indicate a success or failure of the authentication. It is strongly recommended to return an authentication failure in the case  of  the
          Invalid/Expired  auth-token  with  the  external-auth option unless the client could authenticate in another acceptable way (e.g. client certificate),
          otherwise returning success will lead to authentication bypass (as does returning success on a wrong password from a script).

   --auth-gen-token-secret file
          Specifies a file that holds a secret for the HMAC used in --auth-gen-token If file is not present OpenVPN will generate a random  secret  on  startup.
          This  file should be used if auth-token should validate after restarting a server or if client should be able to roam between multiple OpenVPN servers
          with their auth-token.

   --auth-user-pass-optional
          Allow connections by clients that do not specify a username/password.  Normally, when --auth-user-pass-verify or --management-client-auth  are  speci‐
          fied  (or  an authentication plugin module), the OpenVPN server daemon will require connecting clients to specify a username and password. This option
          makes the submission of a username/password by clients optional, passing the responsibility to the user-defined authentication module/script to accept
          or  deny  the  client based on other factors (such as the setting of X509 certificate fields).  When this option is used, and a connecting client does
          not submit a username/password, the user-defined authentication module/script will see the username and password as being set to empty  strings  (&quot;&quot;).
          The authentication module/script MUST have logic to detect this condition and respond accordingly.

   --ccd-exclusive
          Require, as a condition of authentication, that a connecting client has a --client-config-dir file.

   --client-config-dir dir
          Specify  a  directory  dir for custom client config files. After a connecting client has been authenticated, OpenVPN will look in this directory for a
          file having the same name as the client&#39;</span><span class="n">s</span><span class="w"> </span><span class="nc">X509</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">exists</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">opened</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">parsed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">specific</span><span class="w">  </span><span class="n">configuration</span><span class="w">
          </span><span class="n">options</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w">  </span><span class="n">no</span><span class="w">  </span><span class="n">matching</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">found</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">parse</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="s">&quot;DEFAULT&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w">
          </span><span class="n">required</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">readable</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="k" data-group-id="1626791394-4">after</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">dropped</span><span class="w"> </span><span class="n">it</span><span class="sc">&#39;s root privileges.

          This file can specify a fixed IP address for a given client using --ifconfig-push, as well as fixed subnets owned by the client using --iroute.

          One of the useful properties of this option is that it allows client configuration files to be conveniently created,  edited,  or  removed  while  the
          server is live, without needing to restart the server.

          The  following  options are legal in a client-specific context: --push, --push-reset, --push-remove, --iroute, --ifconfig-push, --vlan-pvid and --con‐
          fig.

   --client-to-client
          Because the OpenVPN server mode handles multiple clients through a single tun or tap interface, it is effectively  a  router.  The  --client-to-client
          flag tells OpenVPN to internally route client-to-client traffic rather than pushing all client-originating traffic to the TUN/TAP interface.

          When  this  option  is  used, each client will &quot;see&quot; the other clients which are currently connected. Otherwise, each client will only see the server.
          Don&#39;</span><span class="n">t</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">firewall</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">custom</span><span class="p">,</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="n">rules</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">disable</span><span class="w">
          </span><span class="nc">Disable</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="p" data-group-id="1626791394-5">(</span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">name</span><span class="p" data-group-id="1626791394-5">)</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">connecting</span><span class="o">.</span><span class="w">  </span><span class="nc">Don</span><span class="sc">&#39;t use this option to disable a client due to key or password  compromise.
          Use a CRL (certificate revocation list) instead (see the --crl-verify option).

          This  option  must  be associated with a specific client instance, which means that it must be specified either in a client instance config file using
          --client-config-dir or dynamically generated using a --client-connect script.

   --connect-freq args
          Allow a maximum of n new connections per sec seconds from clients.

          Valid syntax:

             connect-freq n sec

          This is designed to contain DoS attacks which flood the server with connection requests using certificates which will ultimately fail to authenticate.

          This is an imperfect solution however, because in a real DoS scenario, legitimate connections might also be refused.

          For the best protection against DoS attacks in server mode, use --proto udp and either --tls-auth or --tls-crypt.

   --duplicate-cn
          Allow multiple clients with the same common name to concurrently connect. In the absence of this option, OpenVPN will  disconnect  a  client  instance
          upon connection of a new client having the same common name.

   --ifconfig-pool args
          Set aside a pool of subnets to be dynamically allocated to connecting clients, similar to a DHCP server.

          Valid syntax:

             ifconfig-pool start-IP end-IP [netmask]

          For  tun-style  tunnels,  each  client  will be given a /30 subnet (for interoperability with Windows clients).  For tap-style tunnels, individual ad‐
          dresses will be allocated, and the optional netmask parameter will also be pushed to clients.

   --ifconfig-ipv6-pool args
          Specify an IPv6 address pool for dynamic assignment to clients.

          Valid args:

             ifconfig-ipv6-pool ipv6addr/bits

          The pool starts at ipv6addr and matches the offset determined from the start of the IPv4 pool.  If the host part of the given IPv6 address is  0,  the
          pool starts at ipv6addr +1.

   --ifconfig-pool-persist args
          Persist/unpersist ifconfig-pool data to file, at seconds intervals (default 600), as well as on program startup and shutdown.

          Valid syntax:

             ifconfig-pool-persist file [seconds]

          The  goal  of  this option is to provide a long-term association between clients (denoted by their common name) and the virtual IP address assigned to
          them from the ifconfig-pool. Maintaining a long-term association is good for clients because it allows them to effectively use the  --persist-tun  op‐
          tion.

          file is a comma-delimited ASCII file, formatted as &lt;Common-Name&gt;,&lt;IP-address&gt;.

          If seconds = 0, file will be treated as read-only. This is useful if you would like to treat file as a configuration file.

          Note  that the entries in this file are treated by OpenVPN as suggestions only, based on past associations between a common name and IP address.  They
          do not guarantee that the given common name will always receive the given IP address. If you want guaranteed assignment, use --ifconfig-push

   --ifconfig-push args
          Push virtual IP endpoints for client tunnel, overriding the --ifconfig-pool dynamic allocation.

          Valid syntax:

             ifconfig-push local remote-netmask [alias]

          The parameters local and remote-netmask are set according to the --ifconfig directive which you want to execute on the client machine to configure the
          remote  end  of  the tunnel. Note that the parameters local and remote-netmask are from the perspective of the client, not the server. They may be DNS
          names rather than IP addresses, in which case they will be resolved on the server at the time of client connection.

          The optional alias parameter may be used in cases where NAT causes the client view of its local endpoint to differ from the server view. In this  case
          local/remote-netmask will refer to the server view while alias/remote-netmask will refer to the client view.

          This  option  must  be associated with a specific client instance, which means that it must be specified either in a client instance config file using
          --client-config-dir or dynamically generated using a --client-connect script.

          Remember also to include a --route directive in the main OpenVPN config file which encloses local, so that the kernel will know to  route  it  to  the
          server&#39;</span><span class="n">s</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w">

          </span><span class="nc">OpenVPN</span><span class="sc">&#39;s internal client IP address selection algorithm works as follows:

          1. Use --client-connect script generated file for static IP (first choice).

          2. Use --client-config-dir file for static IP (next choice).

          3. Use --ifconfig-pool allocation for dynamic IP (last choice).

   --ifconfig-ipv6-push args
          for --client-config-dir per-client static IPv6 interface configuration, see --client-config-dir and --ifconfig-push for more details.

          Valid syntax:

             ifconfig-ipv6-push ipv6addr/bits ipv6remote

   --inetd args
          Valid syntaxes:

             inetd
             inetd wait
             inetd nowait
             inetd wait progname

          Use this option when OpenVPN is being run from the inetd or xinetd(8) server.

          The  wait and nowait option must match what is specified in the inetd/xinetd config file. The nowait mode can only be used with --proto tcp-server The
          default is wait.  The nowait mode can be used to instantiate the OpenVPN daemon as a classic TCP server, where client connection requests are serviced
          on    a    single    port    number.    For    additional    information    on    this    kind    of    configuration,    see    the    OpenVPN   FAQ:
          https://community.openvpn.net/openvpn/wiki/325-openvpn-as-a--forking-tcp-server-which-can-service-multiple-clients-over-a-single-tcp-port

          This option precludes the use of --daemon, --local or --remote.  Note that this option causes message and error output to be handled in the  same  way
          as the --daemon option. The optional progname parameter is also handled exactly as in --daemon.

          Also  note that in wait mode, each OpenVPN tunnel requires a separate TCP/UDP port and a separate inetd or xinetd entry. See the OpenVPN 1.x HOWTO for
          an example on using OpenVPN with xinetd: https://openvpn.net/community-resources/1xhowto/

   --multihome
          Configure a multi-homed UDP server. This option needs to be used when a server has more than one IP address (e.g. multiple interfaces, or secondary IP
          addresses),  and is not using --local to force binding to one specific address only. This option will add some extra lookups to the packet path to en‐
          sure that the UDP reply packets are always sent from the address that the client is talking to. This is not supported on all platforms,  and  it  adds
          more processing, so it&#39;</span><span class="n">s</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="o">.</span><span class="w">

          </span><span class="ss">Notes</span><span class="p">:</span><span class="w">

                 </span><span class="err">•</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">relevant</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">servers</span><span class="o">.</span><span class="w">

                 </span><span class="err">•</span><span class="w"> </span><span class="nc">If</span><span class="w">  </span><span class="n">you</span><span class="w">  </span><span class="k" data-group-id="1626791394-6">do</span><span class="w">  </span><span class="n">an</span><span class="w"> </span><span class="nc">IPv6</span><span class="o">+</span><span class="nc">IPv4</span><span class="w"> </span><span class="n">dual</span><span class="o">-</span><span class="n">stack</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">machine</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="n">on</span><span class="w">
                   </span><span class="n">kernels</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="mf">3.15</span><span class="p">,</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IPv4</span><span class="o">-</span><span class="n">mapped</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="p" data-group-id="1626791394-7">(</span><span class="n">some</span><span class="w"> </span><span class="n">distributions</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">ported</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">earlier</span><span class="w"> </span><span class="n">kernel</span><span class="w">  </span><span class="n">versions</span><span class="p">,</span><span class="w">
                   </span><span class="n">though</span><span class="p" data-group-id="1626791394-7">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">iroute</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Generate</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">netmask</span><span class="w"> </span><span class="n">parameter</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.255</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">iroute</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="p" data-group-id="1626791394-8">[</span><span class="n">netmask</span><span class="p" data-group-id="1626791394-8">]</span><span class="w">

          </span><span class="nc">This</span><span class="w">  </span><span class="n">directive</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fixed</span><span class="w"> </span><span class="n">subnet</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">regardless</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">from</span><span class="o">.</span><span class="w">  </span><span class="nc">Remem</span><span class="err">‐</span><span class="w">
          </span><span class="n">ber</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="p" data-group-id="1626791394-9">(</span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="w"> </span><span class="n">directive</span><span class="p" data-group-id="1626791394-9">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w">  </span><span class="n">reason</span><span class="w">  </span><span class="n">why</span><span class="w">  </span><span class="n">two</span><span class="w">  </span><span class="n">routes</span><span class="w">  </span><span class="n">are</span><span class="w">
          </span><span class="n">needed</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">that</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="o">--</span><span class="n">route</span><span class="w">  </span><span class="n">directive</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="o">.</span><span class="w"> </span><span class="nc">Once</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">iroute</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specific</span><span class="w">
          </span><span class="n">client</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">dir</span><span class="w"> </span><span class="ow">or</span><span class="w">  </span><span class="n">dynamically</span><span class="w">  </span><span class="n">generated</span><span class="w">  </span><span class="n">using</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w">
          </span><span class="n">script</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">iroute</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">important</span><span class="w"> </span><span class="n">interaction</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">push</span><span class="w"> </span><span class="s">&quot;route ...&quot;</span><span class="o">.</span><span class="w"> </span><span class="o">--</span><span class="n">iroute</span><span class="w"> </span><span class="n">essentially</span><span class="w"> </span><span class="n">defines</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subnet</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">owned</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w">
          </span><span class="n">client</span><span class="w"> </span><span class="p" data-group-id="1626791394-10">(</span><span class="n">we</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="nc">A</span><span class="p" data-group-id="1626791394-10">)</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reach</span><span class="w"> </span><span class="nc">A</span><span class="sc">&#39;s subnet, you can use  --push  &quot;route  ...&quot;  together  with
          --client-to-client  to  effect  this.  In order for all clients to see A&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">subnet</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="nc">EXCEPT</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">A</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w">
          </span><span class="n">subnet</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">owned</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">A</span><span class="o">.</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">accomplishes</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">pushing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="sc">&#39;s iroutes.

   --iroute-ipv6 args
          for --client-config-dir per-client static IPv6 route configuration, see --iroute for more details how to setup and use  this,  and  how  --iroute  and
          --route interact.

          Valid syntax:

             iroute-ipv6 ipv6addr/bits

   --max-clients n
          Limit server to a maximum of n concurrent clients.

   --max-routes-per-client n
          Allow  a  maximum of n internal routes per client (default 256). This is designed to help contain DoS attacks where an authenticated client floods the
          server with packets appearing to come from many unique MAC addresses, forcing the server to deplete virtual memory as its internal routing  table  ex‐
          pands. This directive can be used in a --client-config-dir file or auto-generated by a --client-connect script to override the global value for a par‐
          ticular client.

          Note that this directive affects OpenVPN&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">opt</span><span class="o">-</span><span class="n">verify</span><span class="w">
          </span><span class="nc">Clients</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">incompatible</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">disconnected</span><span class="o">.</span><span class="w">

          </span><span class="nc">Options</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">compared</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">compatibility</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">dev</span><span class="o">-</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">link</span><span class="o">-</span><span class="n">mtu</span><span class="p">,</span><span class="w"> </span><span class="n">tun</span><span class="o">-</span><span class="n">mtu</span><span class="p">,</span><span class="w"> </span><span class="n">proto</span><span class="p">,</span><span class="w"> </span><span class="n">ifconfig</span><span class="p">,</span><span class="w"> </span><span class="n">comp</span><span class="o">-</span><span class="n">lzo</span><span class="p">,</span><span class="w"> </span><span class="n">fragment</span><span class="p">,</span><span class="w"> </span><span class="n">keydir</span><span class="p">,</span><span class="w"> </span><span class="n">cipher</span><span class="p">,</span><span class="w">  </span><span class="n">auth</span><span class="p">,</span><span class="w">  </span><span class="n">key</span><span class="err">‐</span><span class="w">
          </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">secret</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="o">-</span><span class="n">replay</span><span class="p">,</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="o">-</span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">server</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">client</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="o">--</span><span class="n">disable</span><span class="o">-</span><span class="n">occ</span><span class="w"> </span><span class="nc">NOT</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">port</span><span class="o">-</span><span class="n">share</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Share</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">service</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">port</span><span class="o">-</span><span class="n">share</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="p" data-group-id="1626791394-11">[</span><span class="n">dir</span><span class="p" data-group-id="1626791394-11">]</span><span class="w">

          </span><span class="nc">When</span><span class="w">  </span><span class="n">run</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="nc">TCP</span><span class="w">  </span><span class="n">server</span><span class="w">  </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">share</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">application</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">HTTPS</span><span class="w"> </span><span class="n">server</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">senses</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">port</span><span class="w">
          </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">protocol</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">proxy</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">host</span><span class="ss">:port</span><span class="o">.</span><span class="w"> </span><span class="nc">Currently</span><span class="w">  </span><span class="n">only</span><span class="w">  </span><span class="n">designed</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">work</span><span class="w">  </span><span class="k">with</span><span class="w">  </span><span class="nc">HTTP</span><span class="o">/</span><span class="nc">HTTPS</span><span class="p">,</span><span class="w">
          </span><span class="n">though</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">theoretically</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">extend</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">protocols</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">ssh</span><span class="o">.</span><span class="w">

          </span><span class="n">dir</span><span class="w">  </span><span class="n">specifies</span><span class="w">  </span><span class="n">an</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">temporary</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="nc">N</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">dynamically</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">proxy</span><span class="w"> </span><span class="n">connection</span><span class="p">,</span><span class="w">
          </span><span class="n">where</span><span class="w"> </span><span class="nc">N</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="nc">IP</span><span class="ss">:port</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="nc">IP</span><span class="ss">:port</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">proxy</span><span class="w"> </span><span class="n">receiver</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w">
          </span><span class="n">as</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">dictionary</span><span class="w">  </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">proxy</span><span class="w"> </span><span class="n">receiver</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">origin</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w"> </span><span class="nc">Each</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">deleted</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">proxied</span><span class="w">
          </span><span class="n">connection</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">torn</span><span class="w"> </span><span class="n">down</span><span class="o">.</span><span class="w">

          </span><span class="nc">Not</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Windows</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">push</span><span class="w"> </span><span class="n">option</span><span class="w">
          </span><span class="nc">Push</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">enclosed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">double</span><span class="w"> </span><span class="n">quotes</span><span class="w"> </span><span class="p" data-group-id="1626791394-12">(</span><span class="s">&quot;&quot;</span><span class="p" data-group-id="1626791394-12">)</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w">  </span><span class="n">client</span><span class="w">  </span><span class="n">must</span><span class="w">  </span><span class="n">specify</span><span class="w">
          </span><span class="o">--</span><span class="n">pull</span><span class="w">  </span><span class="ow">in</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">limited</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">feasibility</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">security</span><span class="o">.</span><span class="w"> </span><span class="nc">Some</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">would</span><span class="w">
          </span><span class="n">execute</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">banned</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">effectively</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">compromised</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">arbitrary</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w"> </span><span class="nc">Other</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">TLS</span><span class="w">
          </span><span class="ow">or</span><span class="w"> </span><span class="nc">MTU</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">initiated</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="n">partial</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="ss">pushed</span><span class="p">:</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">gateway</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">delay</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">redirect</span><span class="o">-</span><span class="n">gateway</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">ip</span><span class="o">-</span><span class="n">win32</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">dhcp</span><span class="o">-</span><span class="n">op</span><span class="err">‐</span><span class="w">
          </span><span class="n">tion</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">inactive</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="o">-</span><span class="n">exit</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="o">-</span><span class="n">restart</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">setenv</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">token</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="n">persist</span><span class="o">-</span><span class="n">key</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="n">persist</span><span class="o">-</span><span class="n">tun</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="n">echo</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="n">comp</span><span class="o">-</span><span class="n">lzo</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="n">socket</span><span class="o">-</span><span class="n">flags</span><span class="p">,</span><span class="w">
          </span><span class="o">--</span><span class="n">sndbuf</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">rcvbuf</span><span class="w">

   </span><span class="o">--</span><span class="n">push</span><span class="o">-</span><span class="n">peer</span><span class="o">-</span><span class="n">info</span><span class="w">
          </span><span class="nc">Push</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">server</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">server</span><span class="p">:</span><span class="w">

          </span><span class="nc">IV_VER</span><span class="o">=</span><span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="w">
                 </span><span class="nc">The</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">version</span><span class="w">

          </span><span class="nc">IV_PLAT</span><span class="o">=</span><span class="p" data-group-id="1626791394-13">[</span><span class="n">linux</span><span class="o">|</span><span class="n">solaris</span><span class="o">|</span><span class="n">openbsd</span><span class="o">|</span><span class="n">mac</span><span class="o">|</span><span class="n">netbsd</span><span class="o">|</span><span class="n">freebsd</span><span class="o">|</span><span class="n">win</span><span class="p" data-group-id="1626791394-13">]</span><span class="w">
                 </span><span class="nc">The</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="nc">OS</span><span class="w"> </span><span class="n">platform</span><span class="w">

          </span><span class="nc">IV_LZO_STUB</span><span class="o">=</span><span class="mi">1</span><span class="w">
                 </span><span class="nc">If</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">LZO</span><span class="w"> </span><span class="n">stub</span><span class="w"> </span><span class="n">capability</span><span class="w">

          </span><span class="nc">IV_LZ4</span><span class="o">=</span><span class="mi">1</span><span class="w">
                 </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="nc">LZ4</span><span class="w"> </span><span class="n">compressions</span><span class="o">.</span><span class="w">

          </span><span class="nc">IV_PROTO</span><span class="w">
                 </span><span class="nc">Details</span><span class="w">  </span><span class="n">about</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">extensions</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">supports</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">bitfield</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">follows</span><span class="w"> </span><span class="p" data-group-id="1626791394-14">(</span><span class="n">starting</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">for</span><span class="w">
                 </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="p" data-group-id="1626791394-15">(</span><span class="n">unused</span><span class="p" data-group-id="1626791394-15">)</span><span class="w"> </span><span class="ss">bit</span><span class="p">:</span><span class="w">

                 </span><span class="err">•</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">peer</span><span class="o">-</span><span class="n">id</span><span class="w"> </span><span class="n">floating</span><span class="w"> </span><span class="n">mechanism</span><span class="w">

                 </span><span class="err">•</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">expects</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">push</span><span class="o">-</span><span class="n">reply</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">waiting</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">push</span><span class="o">-</span><span class="n">request</span><span class="w"> </span><span class="n">first</span><span class="o">.</span><span class="w">

          </span><span class="nc">IV_NCP</span><span class="o">=</span><span class="mi">2</span><span class="w">
                 </span><span class="nc">Negotiable</span><span class="w"> </span><span class="n">ciphers</span><span class="p">,</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="o">--</span><span class="n">cipher</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="p">,</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">value</span><span class="w">  </span><span class="n">of</span><span class="w">  </span><span class="mi">2</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="n">greater</span><span class="w">  </span><span class="n">indicates</span><span class="w">  </span><span class="n">client</span><span class="w">  </span><span class="n">supports</span><span class="w">  </span><span class="nc">AES</span><span class="o">-</span><span class="nc">GCM</span><span class="o">-</span><span class="mi">128</span><span class="w">  </span><span class="ow">and</span><span class="w">
                 </span><span class="nc">AES</span><span class="o">-</span><span class="nc">GCM</span><span class="o">-</span><span class="mi">256</span><span class="o">.</span><span class="w">

          </span><span class="nc">IV_CIPHERS</span><span class="o">=</span><span class="o">&lt;</span><span class="n">ncp</span><span class="o">-</span><span class="n">ciphers</span><span class="o">&gt;</span><span class="w">
                 </span><span class="nc">The</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">announces</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="o">.</span><span class="w">

          </span><span class="nc">IV_GUI_VER</span><span class="o">=</span><span class="o">&lt;</span><span class="n">gui_id</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="w">
                 </span><span class="nc">The</span><span class="w"> </span><span class="nc">UI</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">UI</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">running</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">de</span><span class="o">.</span><span class="n">blinkt</span><span class="o">.</span><span class="n">openvpn</span><span class="w"> </span><span class="mf">0.5</span><span class="o">.</span><span class="mi">47</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Android</span><span class="w"> </span><span class="n">app</span><span class="o">.</span><span class="w">

          </span><span class="nc">When</span><span class="w"> </span><span class="o">--</span><span class="n">push</span><span class="o">-</span><span class="n">peer</span><span class="o">-</span><span class="n">info</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">data</span><span class="p">:</span><span class="w">

          </span><span class="nc">IV_HWADDR</span><span class="o">=</span><span class="o">&lt;</span><span class="n">mac</span><span class="w"> </span><span class="n">address</span><span class="o">&gt;</span><span class="w">
                 </span><span class="nc">The</span><span class="w"> </span><span class="nc">MAC</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">gateway</span><span class="w">

          </span><span class="nc">IV_SSL</span><span class="o">=</span><span class="o">&lt;</span><span class="n">version</span><span class="w"> </span><span class="n">string</span><span class="o">&gt;</span><span class="w">
                 </span><span class="nc">The</span><span class="w"> </span><span class="n">ssl</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w">  </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="mf">1.0</span><span class="o">.</span><span class="mi">2</span><span class="n">f</span><span class="w"> </span><span class="mi">28</span><span class="w"> </span><span class="nc">Jan</span><span class="w"> </span><span class="mi">2016</span><span class="o">.</span><span class="w">

          </span><span class="nc">IV_PLAT_VER</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">y</span><span class="w">
                 </span><span class="nc">The</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">system</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="mf">6.1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="mi">7</span><span class="o">.</span><span class="w">

          </span><span class="nc">UV_</span><span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;=</span><span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="w">
                 </span><span class="nc">Client</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">whose</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">UV_</span><span class="w">

   </span><span class="o">--</span><span class="n">push</span><span class="o">-</span><span class="n">remove</span><span class="w"> </span><span class="n">opt</span><span class="w">
          </span><span class="nc">Selectively</span><span class="w">  </span><span class="n">remove</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="o">--</span><span class="n">push</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="s">&quot;opt&quot;</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w"> </span><span class="n">opt</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">matched</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">substring</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">whole</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">string</span><span class="w">
          </span><span class="n">to</span><span class="o">-</span><span class="n">be</span><span class="o">-</span><span class="n">pushed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="o">--</span><span class="n">push</span><span class="o">-</span><span class="n">remove</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="o">--</span><span class="n">push</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">...</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="o">--</span><span class="n">push</span><span class="w">  </span><span class="n">route</span><span class="o">-</span><span class="n">ipv6</span><span class="w">  </span><span class="n">...</span><span class="w">   </span><span class="n">statements</span><span class="p">,</span><span class="w">  </span><span class="n">while</span><span class="w">  </span><span class="o">--</span><span class="n">push</span><span class="o">-</span><span class="n">remove</span><span class="w">
          </span><span class="s">&quot;route-ipv6 2001:&quot;</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">2001</span><span class="ss">:...</span><span class="w"> </span><span class="n">networks</span><span class="o">.</span><span class="w">

          </span><span class="o">--</span><span class="n">push</span><span class="o">-</span><span class="n">remove</span><span class="w">  </span><span class="n">can</span><span class="w">  </span><span class="n">only</span><span class="w">  </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">dir</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">to</span><span class="w">
          </span><span class="o">--</span><span class="n">push</span><span class="o">-</span><span class="n">reset</span><span class="p">,</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">selective</span><span class="o">.</span><span class="w">

          </span><span class="ss">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">push</span><span class="o">-</span><span class="n">remove</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="o">--</span><span class="n">push</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">value</span><span class="o">.</span><span class="w">

          </span><span class="nc">NOTE</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="n">details</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;ifconfig&#39;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="sc">&#39;ifconfig-ipv6&#39;</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="p" data-group-id="1626791394-16">(</span><span class="w">  </span><span class="n">push</span><span class="o">-</span><span class="n">remove</span><span class="w">  </span><span class="n">ifconfig</span><span class="p" data-group-id="1626791394-16">)</span><span class="p">,</span><span class="w">
          </span><span class="n">no</span><span class="w"> </span><span class="n">substring</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IPv4</span><span class="o">/</span><span class="nc">IPv6</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">possible</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">push</span><span class="o">-</span><span class="n">reset</span><span class="w">
          </span><span class="nc">Don</span><span class="sc">&#39;t  inherit  the  global  push  list for a specific client instance.  Specify this option in a client-specific context such as with a --client-con‐
          fig-dir configuration file. This option will ignore --push options at the global config file level.

          NOTE: --push-reset is very thorough: it will remove almost all options from the list of to-be-pushed options.  In many cases, some  of  these  options
          will  need  to  be  re-configured afterwards - specifically, --topology subnet and --route-gateway will get lost and this will break client configs in
          many cases.  Thus, for most purposes, --push-remove is better suited to selectively remove push options for individual clients.

   --server args
          A helper directive designed to simplify the configuration of OpenVPN&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">which</span><span class="w">  </span><span class="n">will</span><span class="w">  </span><span class="n">allocate</span><span class="w">
          </span><span class="n">addresses</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">network</span><span class="o">/</span><span class="n">netmask</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">.</span><span class="mi">1</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="o">-</span><span class="n">side</span><span class="w"> </span><span class="k">end</span><span class="err">‐</span><span class="w">
          </span><span class="n">point</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">nopool</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">pool</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">prepared</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">clients</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">server</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">netmask</span><span class="w"> </span><span class="p" data-group-id="1626791394-17">[</span><span class="n">nopool</span><span class="p" data-group-id="1626791394-17">]</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">server</span><span class="w"> </span><span class="mf">10.8</span><span class="o">.</span><span class="mf">0.0</span><span class="w"> </span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span><span class="w"> </span><span class="n">expands</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

             </span><span class="n">mode</span><span class="w"> </span><span class="n">server</span><span class="w">
             </span><span class="n">tls</span><span class="o">-</span><span class="n">server</span><span class="w">
             </span><span class="n">push</span><span class="w"> </span><span class="s">&quot;topology [topology]&quot;</span><span class="w">

             </span><span class="k">if</span><span class="w"> </span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="nc">AND</span><span class="w"> </span><span class="p" data-group-id="1626791394-18">(</span><span class="n">topology</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">net30</span><span class="w"> </span><span class="nc">OR</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p2p</span><span class="p" data-group-id="1626791394-18">)</span><span class="p">:</span><span class="w">
               </span><span class="n">ifconfig</span><span class="w"> </span><span class="mf">10.8</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mf">10.8</span><span class="o">.</span><span class="mf">0.2</span><span class="w">
               </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="ss">nopool</span><span class="p">:</span><span class="w">
                 </span><span class="n">ifconfig</span><span class="o">-</span><span class="n">pool</span><span class="w"> </span><span class="mf">10.8</span><span class="o">.</span><span class="mf">0.4</span><span class="w"> </span><span class="mf">10.8</span><span class="o">.</span><span class="mf">0.251</span><span class="w">
               </span><span class="n">route</span><span class="w"> </span><span class="mf">10.8</span><span class="o">.</span><span class="mf">0.0</span><span class="w"> </span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span><span class="w">
               </span><span class="k">if</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="ss">client</span><span class="p">:</span><span class="w">
                 </span><span class="n">push</span><span class="w"> </span><span class="s">&quot;route 10.8.0.0 255.255.255.0&quot;</span><span class="w">
               </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">net30</span><span class="p">:</span><span class="w">
                 </span><span class="n">push</span><span class="w"> </span><span class="s">&quot;route 10.8.0.1&quot;</span><span class="w">

             </span><span class="k">if</span><span class="w"> </span><span class="n">dev</span><span class="w"> </span><span class="n">tap</span><span class="w"> </span><span class="nc">OR</span><span class="w"> </span><span class="p" data-group-id="1626791394-19">(</span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="nc">AND</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">subnet</span><span class="p" data-group-id="1626791394-19">)</span><span class="p">:</span><span class="w">
               </span><span class="n">ifconfig</span><span class="w"> </span><span class="mf">10.8</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span><span class="w">
               </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="ss">nopool</span><span class="p">:</span><span class="w">
                 </span><span class="n">ifconfig</span><span class="o">-</span><span class="n">pool</span><span class="w"> </span><span class="mf">10.8</span><span class="o">.</span><span class="mf">0.2</span><span class="w"> </span><span class="mf">10.8</span><span class="o">.</span><span class="mf">0.253</span><span class="w"> </span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span><span class="w">
               </span><span class="n">push</span><span class="w"> </span><span class="s">&quot;route-gateway 10.8.0.1&quot;</span><span class="w">
               </span><span class="k">if</span><span class="w"> </span><span class="n">route</span><span class="o">-</span><span class="n">gateway</span><span class="w"> </span><span class="ss">unset</span><span class="p">:</span><span class="w">
                 </span><span class="n">route</span><span class="o">-</span><span class="n">gateway</span><span class="w"> </span><span class="mf">10.8</span><span class="o">.</span><span class="mf">0.2</span><span class="w">

          </span><span class="nc">Don</span><span class="sc">&#39;t use --server if you are ethernet bridging. Use --server-bridge instead.

   --server-bridge args
          A helper directive similar to --server which is designed to simplify the configuration of OpenVPN&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">ethernet</span><span class="w"> </span><span class="n">bridging</span><span class="w"> </span><span class="n">configurations</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">server</span><span class="o">-</span><span class="n">bridge</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="n">netmask</span><span class="w"> </span><span class="n">pool</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="nc">IP</span><span class="w"> </span><span class="n">pool</span><span class="o">-</span><span class="k">end</span><span class="o">-</span><span class="nc">IP</span><span class="w">
             </span><span class="n">server</span><span class="o">-</span><span class="n">bridge</span><span class="w"> </span><span class="p" data-group-id="1626791394-20">[</span><span class="n">nogw</span><span class="p" data-group-id="1626791394-20">]</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="o">--</span><span class="n">server</span><span class="o">-</span><span class="n">bridge</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">parameters</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">DHCP</span><span class="o">-</span><span class="n">proxy</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">IP</span><span class="w">  </span><span class="n">address</span><span class="w">  </span><span class="k">for</span><span class="w">
          </span><span class="n">their</span><span class="w">  </span><span class="nc">TAP</span><span class="w">  </span><span class="n">adapter</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">server</span><span class="o">-</span><span class="n">side</span><span class="w"> </span><span class="nc">LAN</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">binding</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="k">with</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="p" data-group-id="1626791394-21">(</span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">Windows</span><span class="p" data-group-id="1626791394-21">)</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">nogw</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="p" data-group-id="1626791394-22">(</span><span class="n">advanced</span><span class="p" data-group-id="1626791394-22">)</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">pushed</span><span class="w">  </span><span class="n">to</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w">

          </span><span class="nc">To</span><span class="w"> </span><span class="n">configure</span><span class="w"> </span><span class="n">ethernet</span><span class="w"> </span><span class="n">bridging</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="nc">OS</span><span class="sc">&#39;s bridging capability to bridge the TAP interface with the ethernet NIC interface.  For ex‐
          ample, on Linux this is done with the brctl tool, and with Windows XP it is done in the Network Connections Panel by selecting the  ethernet  and  TAP
          adapters and right-clicking on &quot;Bridge Connections&quot;.

          Next you you must manually set the IP/netmask on the bridge interface.  The gateway and netmask parameters to --server-bridge can be set to either the
          IP/netmask of the bridge interface, or the IP/netmask of the default gateway/router on the bridged subnet.

          Finally, set aside a IP range in the bridged subnet, denoted by pool-start-IP and pool-end-IP, for OpenVPN to allocate to connecting clients.

          For example, server-bridge 10.8.0.4 255.255.255.0 10.8.0.128 10.8.0.254 expands as follows:

             mode server
             tls-server

             ifconfig-pool 10.8.0.128 10.8.0.254 255.255.255.0
             push &quot;route-gateway 10.8.0.4&quot;

          In another example, --server-bridge (without parameters) expands as follows:

             mode server
             tls-server

             push &quot;route-gateway dhcp&quot;

          Or --server-bridge nogw expands as follows:

             mode server
             tls-server

   --server-ipv6 args
          Convenience-function to enable a number of IPv6 related options at once, namely --ifconfig-ipv6, --ifconfig-ipv6-pool and --push tun-ipv6.

          Valid syntax:

             server-ipv6 ipv6addr/bits

          Pushing of the --tun-ipv6 directive is done for older clients which require an explicit --tun-ipv6 in their configuration.

   --stale-routes-check args
          Remove routes which haven&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">activity</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="p" data-group-id="1626791394-23">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ageing</span><span class="w"> </span><span class="n">time</span><span class="p" data-group-id="1626791394-23">)</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="p" data-group-id="1626791394-24">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">interval</span><span class="p" data-group-id="1626791394-24">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">stale</span><span class="o">-</span><span class="n">routes</span><span class="o">-</span><span class="n">check</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p" data-group-id="1626791394-25">[</span><span class="n">t</span><span class="p" data-group-id="1626791394-25">]</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">n</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">helps</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">small</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="o">--</span><span class="n">max</span><span class="o">-</span><span class="n">routes</span><span class="o">-</span><span class="n">per</span><span class="o">-</span><span class="n">client</span><span class="w">

   </span><span class="o">--</span><span class="n">username</span><span class="o">-</span><span class="n">as</span><span class="o">-</span><span class="n">common</span><span class="o">-</span><span class="n">name</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">authenticated</span><span class="w"> </span><span class="n">username</span><span class="w">  </span><span class="n">as</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">common</span><span class="o">-</span><span class="n">name</span><span class="p">,</span><span class="w">  </span><span class="n">rather</span><span class="w">  </span><span class="n">than</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">common</span><span class="o">-</span><span class="n">name</span><span class="w">  </span><span class="n">from</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">client</span><span class="w">  </span><span class="n">certificate</span><span class="o">.</span><span class="w">  </span><span class="nc">Requires</span><span class="w">  </span><span class="n">that</span><span class="w">  </span><span class="n">some</span><span class="w">  </span><span class="n">form</span><span class="w">  </span><span class="n">of</span><span class="w">
          </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="w">  </span><span class="n">verification</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="n">effect</span><span class="o">.</span><span class="w"> </span><span class="nc">As</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">replacement</span><span class="w"> </span><span class="n">happens</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="w"> </span><span class="n">verification</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">verification</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">will</span><span class="w">
          </span><span class="n">still</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">common</span><span class="o">-</span><span class="n">name</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">common_name</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">invoked</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="p" data-group-id="1626791394-26">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">script</span><span class="p" data-group-id="1626791394-26">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="n">parsed</span><span class="w">  </span><span class="ow">in</span><span class="w">
          </span><span class="n">client</span><span class="o">-</span><span class="n">config</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">username</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">verify</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">cert</span><span class="w"> </span><span class="n">mode</span><span class="w">
          </span><span class="nc">Specify</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">required</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">supply</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">certificate</span><span class="o">.</span><span class="w">

          </span><span class="nc">Possible</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="ss">are</span><span class="p">:</span><span class="w">

          </span><span class="n">none</span><span class="w">   </span><span class="nc">A</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">required</span><span class="o">.</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">authenticate</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="n">only</span><span class="o">.</span><span class="w"> </span><span class="nc">Be</span><span class="w"> </span><span class="n">aware</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">less</span><span class="w">
                 </span><span class="n">secure</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">requiring</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">clients</span><span class="o">.</span><span class="w">

                 </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">directive</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">entire</span><span class="w"> </span><span class="n">responsibility</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">rest</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">script</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="ow">in</span><span class="w">  </span><span class="n">mind</span><span class="w">  </span><span class="n">that</span><span class="w">
                 </span><span class="n">bugs</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">potentially</span><span class="w"> </span><span class="n">compromise</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="nc">VPN</span><span class="o">.</span><span class="w">

                 </span><span class="o">--</span><span class="n">verify</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">cert</span><span class="w"> </span><span class="n">none</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">functionally</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="ow">not</span><span class="o">-</span><span class="n">required</span><span class="o">.</span><span class="w">

          </span><span class="n">optional</span><span class="w">
                 </span><span class="nc">A</span><span class="w">  </span><span class="n">client</span><span class="w">  </span><span class="n">may</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">required</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k" data-group-id="1626791394-27">do</span><span class="w"> </span><span class="n">so</span><span class="o">.</span><span class="w">  </span><span class="nc">When</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">directive</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="o">-</span><span class="n">verify</span><span class="w">
                 </span><span class="n">script</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">authenticated</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">certificate</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">possibly</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">both</span><span class="o">.</span><span class="w">

                 </span><span class="nc">Again</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">entire</span><span class="w"> </span><span class="n">responsibility</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">rest</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">script</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">mind</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">bugs</span><span class="w"> </span><span class="ow">in</span><span class="w">  </span><span class="n">your</span><span class="w">  </span><span class="n">script</span><span class="w">
                 </span><span class="n">could</span><span class="w"> </span><span class="n">potentially</span><span class="w"> </span><span class="n">compromise</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="nc">VPN</span><span class="o">.</span><span class="w">

          </span><span class="kn">require</span><span class="w">
                 </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">required</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">certificate</span><span class="p">,</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">refused</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w">  </span><span class="n">you</span><span class="w">  </span><span class="n">don</span><span class="sc">&#39;t use this directive (or use --verify-client-cert require) but you also specify an --auth-user-pass-verify script, then OpenVPN will per‐
          form double authentication. The client certificate verification AND the --auth-user-pass-verify script will need to succeed in order for a  client  to
          be authenticated and accepted onto the VPN.

   --vlan-tagging
          Server-only option. Turns the OpenVPN server instance into a switch that understands VLAN-tagging, based on IEEE 802.1Q.

          The server TAP device and each of the connecting clients is seen as a port of the switch. All client ports are in untagged mode and the server TAP de‐
          vice is VLAN-tagged, untagged or accepts both, depending on the --vlan-accept setting.

          Ethernet frames with a prepended 802.1Q tag are called &quot;tagged&quot;. If the VLAN Identifier (VID) field in such a tag is non-zero,  the  frame  is  called
          &quot;VLAN-tagged&quot;.  If  the  VID is zero, but the Priority Control Point (PCP) field is non-zero, the frame is called &quot;prio-tagged&quot;. If there is no 802.1Q
          tag, the frame is &quot;untagged&quot;.

          Using the --vlan-pvid v option once per client (see --client-config-dir), each port can be associated with a certain VID.  Packets can  only  be  for‐
          warded  between  ports  having  the  same  VID.   Therefore,  clients  with  differing  VIDs  are  completely  separated  from  one-another,  even  if
          --client-to-client is activated.

          The packet filtering takes place in the OpenVPN server. Clients should not have any VLAN tagging configuration applied.

          The --vlan-tagging option is off by default. While turned off, OpenVPN accepts any Ethernet frame and does not  perform  any  special  processing  for
          VLAN-tagged packets.

          This option can only be activated in --dev tap mode.

   --vlan-accept args
          Configure the VLAN tagging policy for the server TAP device.

          Valid syntax:

             vlan-accept  all|tagged|untagged

          The following modes are available:

          tagged Admit  only  VLAN-tagged frames. Only VLAN-tagged packets are accepted, while untagged or priority-tagged packets are dropped when entering the
                 server TAP device.

          untagged
                 Admit only untagged and prio-tagged frames.  VLAN-tagged packets are not accepted, while  untagged  or  priority-tagged  packets  entering  the
                 server TAP device are tagged with the value configured for the global --vlan-pvid setting.

          all (default)
                 Admit all frames.  All packets are admitted and then treated like untagged or tagged mode respectively.

          Note:  Some vendors refer to switch ports running in tagged mode as &quot;trunk ports&quot; and switch ports running in untagged mode as &quot;access ports&quot;.

          Packets  forwarded  from  clients  to the server are VLAN-tagged with the originating client&#39;</span><span class="n">s</span><span class="w"> </span><span class="nc">PVID</span><span class="p">,</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VID</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="o">--</span><span class="n">vlan</span><span class="o">-</span><span class="n">pvid</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w">
          </span><span class="n">which</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">removed</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="nc">PVID</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="p" data-group-id="1626791394-28">(</span><span class="n">see</span><span class="w"> </span><span class="o">--</span><span class="n">vlan</span><span class="o">-</span><span class="n">pvid</span><span class="p" data-group-id="1626791394-28">)</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">tagged</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">vlan</span><span class="o">-</span><span class="n">pvid</span><span class="w"> </span><span class="n">v</span><span class="w">
          </span><span class="nc">Specifies</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="nc">VLAN</span><span class="w"> </span><span class="n">identifier</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="s">&quot;port&quot;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="o">.</span><span class="w"> </span><span class="nc">Only</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="o">--</span><span class="n">vlan</span><span class="o">-</span><span class="n">tagging</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">speficied</span><span class="o">.</span><span class="w">

          </span><span class="nc">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="nc">VLAN</span><span class="w"> </span><span class="nc">ID</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VLAN</span><span class="w"> </span><span class="nc">ID</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="nc">TAP</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">is</span><span class="w">
          </span><span class="n">set</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">latter</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">sense</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">--</span><span class="n">vlan</span><span class="o">-</span><span class="n">accept</span><span class="w"> </span><span class="n">untagged</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">vlan</span><span class="o">-</span><span class="n">accept</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">modes</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w">  </span><span class="n">values</span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="n">go</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">4094</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="o">--</span><span class="n">vlan</span><span class="o">-</span><span class="n">pvid</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="n">value</span><span class="w">
          </span><span class="n">is</span><span class="w"> </span><span class="n">inherited</span><span class="o">.</span><span class="w">

          </span><span class="nc">In</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">switch</span><span class="w"> </span><span class="n">implementations</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PVID</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">referred</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="s">&quot;Native VLAN&quot;</span><span class="o">.</span></code></pre><p>ENCRYPTION OPTIONS
   SSL Library information</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">ciphers</span><span class="w">
          </span><span class="p" data-group-id="6118298143-1">(</span><span class="nc">Standalone</span><span class="p" data-group-id="6118298143-1">)</span><span class="w"> </span><span class="nc">Show</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">algorithms</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">cipher</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">digests</span><span class="w">
          </span><span class="p" data-group-id="6118298143-2">(</span><span class="nc">Standalone</span><span class="p" data-group-id="6118298143-2">)</span><span class="w"> </span><span class="nc">Show</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">digest</span><span class="w"> </span><span class="n">algorithms</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">tls</span><span class="w">
          </span><span class="p" data-group-id="6118298143-3">(</span><span class="nc">Standalone</span><span class="p" data-group-id="6118298143-3">)</span><span class="w"> </span><span class="nc">Show</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">crypto</span><span class="w"> </span><span class="n">library</span><span class="o">.</span><span class="w">  </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">secure</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">channel</span><span class="p">,</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w">  </span><span class="n">used</span><span class="w">
          </span><span class="n">to</span><span class="w"> </span><span class="n">protect</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">exchanged</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">sorted</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">highest</span><span class="w"> </span><span class="n">preference</span><span class="w"> </span><span class="p" data-group-id="6118298143-4">(</span><span class="n">most</span><span class="w"> </span><span class="n">secure</span><span class="p" data-group-id="6118298143-4">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">lowest</span><span class="o">.</span><span class="w">

          </span><span class="nc">Be</span><span class="w">  </span><span class="n">aware</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">suite</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">actually</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">depends</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">peers</span><span class="w"> </span><span class="p" data-group-id="6118298143-5">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">peers</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ci</span><span class="err">‐</span><span class="w">
          </span><span class="n">pher</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">ECDSA</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">suite</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">RSA</span><span class="w"> </span><span class="n">certificate</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="o">.</span><span class="p" data-group-id="6118298143-5">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">engines</span><span class="w">
          </span><span class="p" data-group-id="6118298143-6">(</span><span class="nc">Standalone</span><span class="p" data-group-id="6118298143-6">)</span><span class="w"> </span><span class="nc">Show</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">hardware</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">crypto</span><span class="w"> </span><span class="n">acceleration</span><span class="w"> </span><span class="n">engines</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">library</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">groups</span><span class="w">
          </span><span class="p" data-group-id="6118298143-7">(</span><span class="nc">Standalone</span><span class="p" data-group-id="6118298143-7">)</span><span class="w"> </span><span class="nc">Show</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">elliptic</span><span class="w"> </span><span class="n">curves</span><span class="o">/</span><span class="n">groups</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ecdh</span><span class="o">-</span><span class="n">curve</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">groups</span><span class="w"> </span><span class="n">options</span><span class="o">.</span></code></pre><p>   Generating key material</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="p" data-group-id="9467758455-1">(</span><span class="nc">Standalone</span><span class="p" data-group-id="9467758455-1">)</span><span class="w"> </span><span class="nc">Generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">keytype</span><span class="o">.</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">keyfile</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">stdout</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">following</span><span class="w">  </span><span class="n">sec</span><span class="err">‐</span><span class="w">
          </span><span class="n">tions</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">keytypes</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">keytype</span><span class="w"> </span><span class="n">keyfile</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="n">keytype</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="ss">are</span><span class="p">:</span><span class="w">

          </span><span class="n">secret</span><span class="w">                </span><span class="nc">Standard</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="n">secret</span><span class="w"> </span><span class="n">keys</span><span class="w">

          </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w">             </span><span class="nc">Alias</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">secret</span><span class="w">

          </span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="w">              </span><span class="nc">Alias</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">secret</span><span class="w">

          </span><span class="n">auth</span><span class="o">-</span><span class="n">token</span><span class="w">            </span><span class="nc">Key</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">gen</span><span class="o">-</span><span class="n">token</span><span class="o">-</span><span class="n">key</span><span class="w">

          </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="o">-</span><span class="n">server</span><span class="w">   </span><span class="nc">TLS</span><span class="w"> </span><span class="nc">Crypt</span><span class="w"> </span><span class="n">v2</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">key</span><span class="w">

          </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="o">-</span><span class="n">client</span><span class="w">   </span><span class="nc">TLS</span><span class="w"> </span><span class="nc">Crypt</span><span class="w"> </span><span class="n">v2</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">key</span><span class="w">

          </span><span class="ss">Examples</span><span class="p">:</span><span class="w">

             </span><span class="err">$</span><span class="w"> </span><span class="n">openvpn</span><span class="w"> </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">secret</span><span class="w"> </span><span class="n">shared</span><span class="o">.</span><span class="n">key</span><span class="w">
             </span><span class="err">$</span><span class="w"> </span><span class="n">openvpn</span><span class="w"> </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w"> </span><span class="n">shared</span><span class="o">.</span><span class="n">key</span><span class="w">
             </span><span class="err">$</span><span class="w"> </span><span class="n">openvpn</span><span class="w"> </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="n">shared</span><span class="o">.</span><span class="n">key</span><span class="w">
             </span><span class="err">$</span><span class="w"> </span><span class="n">openvpn</span><span class="w"> </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="o">-</span><span class="n">server</span><span class="w"> </span><span class="n">v2crypt</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">key</span><span class="w">
             </span><span class="err">$</span><span class="w"> </span><span class="n">openvpn</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="n">v2crypt</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">key</span><span class="w"> </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="n">v2crypt</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="n">key</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="nc">Generating</span><span class="w"> </span><span class="nc">Shared</span><span class="w"> </span><span class="nc">Secret</span><span class="w"> </span><span class="nc">Keys</span><span class="w"> </span><span class="nc">Generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="n">secret</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">secret</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w">

            </span><span class="ss">Syntax</span><span class="p">:</span><span class="w">

               </span><span class="err">$</span><span class="w"> </span><span class="n">openvpn</span><span class="w"> </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">secret</span><span class="o">|</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">|</span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="n">keyfile</span><span class="w">

            </span><span class="nc">The</span><span class="w">  </span><span class="n">key</span><span class="w">  </span><span class="n">is</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">keyfile</span><span class="o">.</span><span class="w"> </span><span class="nc">All</span><span class="w"> </span><span class="n">three</span><span class="w"> </span><span class="n">variants</span><span class="w"> </span><span class="p" data-group-id="9467758455-2">(</span><span class="o">--</span><span class="n">secret</span><span class="p">,</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="p" data-group-id="9467758455-2">)</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">aliases</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">conve</span><span class="err">‐</span><span class="w">
            </span><span class="n">nience</span><span class="o">.</span><span class="w">

            </span><span class="nc">If</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">--</span><span class="n">secret</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pre</span><span class="o">-</span><span class="n">existing</span><span class="w"> </span><span class="n">secure</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">scp</span><span class="p" data-group-id="9467758455-3">(</span><span class="mi">1</span><span class="p" data-group-id="9467758455-3">)</span><span class="o">.</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="nc">Generating</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="nc">Crypt</span><span class="w"> </span><span class="n">v2</span><span class="w"> </span><span class="nc">Server</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="nc">Generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">server</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">keyfile</span><span class="o">.</span><span class="w">

            </span><span class="ss">Syntax</span><span class="p">:</span><span class="w">

               </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="o">-</span><span class="n">server</span><span class="w"> </span><span class="n">keyfile</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="nc">Generating</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="nc">Crypt</span><span class="w"> </span><span class="n">v2</span><span class="w"> </span><span class="nc">Client</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="nc">Generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">clients</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">keyfile</span><span class="o">.</span><span class="w">

            </span><span class="nc">Syntax</span><span class="w">

               </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="n">keyfile</span><span class="w"> </span><span class="p" data-group-id="9467758455-4">[</span><span class="n">metadata</span><span class="p" data-group-id="9467758455-4">]</span><span class="w">

            </span><span class="nc">If</span><span class="w"> </span><span class="n">supplied</span><span class="p">,</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">wrapped</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">base64</span><span class="o">-</span><span class="n">encoded</span><span class="w"> </span><span class="n">form</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">at</span><span class="w">
            </span><span class="n">most</span><span class="w"> </span><span class="mi">735</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="p" data-group-id="9467758455-5">(</span><span class="mi">980</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">base64</span><span class="p" data-group-id="9467758455-5">)</span><span class="o">.</span><span class="w">

            </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">supplied</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">timestamp</span><span class="w"> </span><span class="n">representing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">UTC</span><span class="p">,</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="k">for</span><span class="w">
            </span><span class="n">the</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="w">

            </span><span class="nc">A</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">wrapped</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">user</span><span class="w">  </span><span class="n">must</span><span class="w">  </span><span class="n">therefore</span><span class="w">  </span><span class="n">supply</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">server</span><span class="w">  </span><span class="n">key</span><span class="w">  </span><span class="n">using</span><span class="w">  </span><span class="n">the</span><span class="w">
            </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

            </span><span class="nc">Servers</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">verification</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="nc">Generate</span><span class="w"> </span><span class="nc">Authentication</span><span class="w"> </span><span class="nc">Token</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="nc">Generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">secret</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">gen</span><span class="o">-</span><span class="n">token</span><span class="o">-</span><span class="n">secret</span><span class="w">

            </span><span class="ss">Syntax</span><span class="p">:</span><span class="w">

               </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">auth</span><span class="o">-</span><span class="n">token</span><span class="w"> </span><span class="p" data-group-id="9467758455-6">[</span><span class="n">keyfile</span><span class="p" data-group-id="9467758455-6">]</span><span class="w">

            </span><span class="ss">Note</span><span class="p">:</span><span class="w">  </span><span class="nc">This</span><span class="w">  </span><span class="n">file</span><span class="w">  </span><span class="n">should</span><span class="w">  </span><span class="n">be</span><span class="w"> </span><span class="n">kept</span><span class="w"> </span><span class="n">secret</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">anyone</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">auth</span><span class="w"> </span><span class="n">tokens</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w">
                   </span><span class="n">server</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">valid</span><span class="o">.</span></code></pre><p>   Data Channel Renegotiation</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">When</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">client</span><span class="o">/</span><span class="n">server</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">ephemeral</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">rotated</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">regular</span><span class="w"> </span><span class="n">intervals</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">reneg</span><span class="o">-</span><span class="n">bytes</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Renegotiate</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="p" data-group-id="9982580081-1">(</span><span class="n">disabled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">exception</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="p" data-group-id="9982580081-1">)</span><span class="o">.</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">lifetime</span><span class="w"> </span><span class="n">of</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">key</span><span class="w">
          </span><span class="n">to</span><span class="w">  </span><span class="n">be</span><span class="w">  </span><span class="n">expressed</span><span class="w">  </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">encrypted</span><span class="o">/</span><span class="n">decrypted</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">packets</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">seconds</span><span class="o">.</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">renegotiation</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">forced</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">of</span><span class="w">
          </span><span class="n">these</span><span class="w"> </span><span class="n">three</span><span class="w"> </span><span class="n">criteria</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">met</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">peer</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">sizes</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">128</span><span class="o">-</span><span class="n">bits</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">reneg</span><span class="o">-</span><span class="n">bytes</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">64</span><span class="nc">MB</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">disabled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">setting</span><span class="w">  </span><span class="n">the</span><span class="w">
          </span><span class="n">value</span><span class="w">  </span><span class="n">to</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nc">HIGHLY</span><span class="w"> </span><span class="nc">DISCOURAGED</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">designed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">protection</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SWEET32</span><span class="w"> </span><span class="n">attack</span><span class="w"> </span><span class="n">vector</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w">
          </span><span class="o">--</span><span class="n">cipher</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">reneg</span><span class="o">-</span><span class="n">pkts</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Renegotiate</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="p" data-group-id="9982580081-2">(</span><span class="n">disabled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="p" data-group-id="9982580081-2">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">reneg</span><span class="o">-</span><span class="n">sec</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Renegotiate</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="p" data-group-id="9982580081-3">(</span><span class="n">default</span><span class="w"> </span><span class="mi">3600</span><span class="p" data-group-id="9982580081-3">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="p" data-group-id="9982580081-4">(</span><span class="n">default</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">90</span><span class="p">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">servers</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w">  </span><span class="n">equal</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">max</span><span class="w">
          </span><span class="k">for</span><span class="w"> </span><span class="n">clients</span><span class="p" data-group-id="9982580081-4">)</span><span class="o">.</span><span class="w">

             </span><span class="n">reneg</span><span class="o">-</span><span class="n">sec</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="p" data-group-id="9982580081-5">[</span><span class="n">min</span><span class="p" data-group-id="9982580081-5">]</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">effective</span><span class="w"> </span><span class="o">--</span><span class="n">reneg</span><span class="o">-</span><span class="n">sec</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">uniform</span><span class="o">-</span><span class="n">randomized</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">max</span><span class="o">.</span><span class="w">

          </span><span class="nc">With</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">default</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">3600</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">effective</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">3240</span><span class="o">.</span><span class="o">.</span><span class="ss">:code</span><span class="p">:</span><span class="mi">3600</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">servers</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="mi">3600</span><span class="w"> </span><span class="k">for</span><span class="w">
          </span><span class="n">clients</span><span class="o">.</span><span class="w">

          </span><span class="nc">When</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">dual</span><span class="o">-</span><span class="n">factor</span><span class="w"> </span><span class="n">authentication</span><span class="p">,</span><span class="w"> </span><span class="n">note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">challenged</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reauthorize</span><span class="w"> </span><span class="n">once</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">hour</span><span class="o">.</span><span class="w">

          </span><span class="nc">Also</span><span class="p">,</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">mind</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">whichever</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">trigger</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rene</span><span class="err">‐</span><span class="w">
          </span><span class="n">gotiation</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w">  </span><span class="n">common</span><span class="w">  </span><span class="n">mistake</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="o">--</span><span class="n">reneg</span><span class="o">-</span><span class="n">sec</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">still</span><span class="w">
          </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">3600</span><span class="w"> </span><span class="n">seconds</span><span class="p">,</span><span class="w"> </span><span class="n">meaning</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">renegotiation</span><span class="w"> </span><span class="n">will</span><span class="w">  </span><span class="n">still</span><span class="w">  </span><span class="n">occur</span><span class="w">  </span><span class="n">once</span><span class="w">  </span><span class="n">per</span><span class="w">  </span><span class="mi">3600</span><span class="w">  </span><span class="n">seconds</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w">  </span><span class="n">solution</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">increase</span><span class="w">
          </span><span class="o">--</span><span class="n">reneg</span><span class="o">-</span><span class="n">sec</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="p" data-group-id="9982580081-6">(</span><span class="n">to</span><span class="w"> </span><span class="n">disable</span><span class="p" data-group-id="9982580081-6">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">chosen</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">side</span><span class="o">.</span></code></pre><p>   TLS Mode Options</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">TLS</span><span class="w">  </span><span class="n">mode</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">most</span><span class="w"> </span><span class="n">powerful</span><span class="w"> </span><span class="n">crypto</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">flexibility</span><span class="o">.</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">establishing</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channels</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">are</span><span class="w">
   </span><span class="n">multiplexed</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">UDP</span><span class="w"> </span><span class="n">port</span><span class="o">.</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">initiates</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">exchange</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">HMAC</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">protect</span><span class="w">  </span><span class="n">the</span><span class="w">
   </span><span class="n">data</span><span class="w">  </span><span class="n">channel</span><span class="o">.</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">robust</span><span class="w"> </span><span class="n">reliability</span><span class="w"> </span><span class="n">layer</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">communication</span><span class="p">,</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channel</span><span class="p">,</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">en</span><span class="err">‐</span><span class="w">
   </span><span class="n">crypted</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">passes</span><span class="p">,</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">forwarded</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">mediation</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">best</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="ss">worlds</span><span class="p">:</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fast</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">forwards</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="nc">UDP</span><span class="w">  </span><span class="k">with</span><span class="w">  </span><span class="n">only</span><span class="w">
   </span><span class="n">the</span><span class="w">  </span><span class="n">overhead</span><span class="w">  </span><span class="n">of</span><span class="w">  </span><span class="n">encrypt</span><span class="p">,</span><span class="w"> </span><span class="n">decrypt</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">HMAC</span><span class="w"> </span><span class="n">functions</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">TLS</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">certificate</span><span class="o">-</span><span class="n">based</span><span class="w">
   </span><span class="n">authentication</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Diffie</span><span class="w"> </span><span class="nc">Hellman</span><span class="w"> </span><span class="n">forward</span><span class="w"> </span><span class="n">secrecy</span><span class="o">.</span><span class="w">

   </span><span class="nc">To</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">runs</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">certificate</span><span class="o">/</span><span class="n">key</span><span class="w"> </span><span class="n">pair</span><span class="w"> </span><span class="p" data-group-id="4008597425-1">(</span><span class="o">--</span><span class="n">cert</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">key</span><span class="p" data-group-id="4008597425-1">)</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">spec</span><span class="err">‐</span><span class="w">
   </span><span class="n">ified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">--</span><span class="n">ca</span><span class="o">.</span><span class="w">

   </span><span class="nc">When</span><span class="w">  </span><span class="n">two</span><span class="w">  </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="n">peers</span><span class="w">  </span><span class="n">connect</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">presents</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="o">.</span><span class="w"> </span><span class="nc">Each</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">partner</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">presented</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">certificate</span><span class="w">
   </span><span class="n">which</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">signed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">master</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">--</span><span class="n">ca</span><span class="o">.</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">peers</span><span class="w"> </span><span class="n">succeeds</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">succeed</span><span class="p">,</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">peers</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">exchange</span><span class="w"> </span><span class="n">temporary</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="err">‐</span><span class="w">
   </span><span class="n">gin</span><span class="w"> </span><span class="n">passing</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">project</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">managing</span><span class="w"> </span><span class="nc">RSA</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">keys</span><span class="p">:</span><span class="w"> </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="nc">OpenVPN</span><span class="o">/</span><span class="n">easy</span><span class="o">-</span><span class="n">rsa</span><span class="w">

   </span><span class="o">--</span><span class="n">askpass</span><span class="w"> </span><span class="n">file</span><span class="w">
          </span><span class="nc">Get</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">console</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">daemonize</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">askpass</span><span class="w">
             </span><span class="n">askpass</span><span class="w"> </span><span class="n">file</span><span class="w">

          </span><span class="nc">For</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">extremely</span><span class="w">  </span><span class="n">security</span><span class="w">  </span><span class="n">conscious</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">protect</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">password</span><span class="o">.</span><span class="w"> </span><span class="nc">Of</span><span class="w"> </span><span class="n">course</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w">
          </span><span class="n">daemon</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">password</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">askpass</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">will</span><span class="w">  </span><span class="n">query</span><span class="w">  </span><span class="n">you</span><span class="w">
          </span><span class="k">for</span><span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">daemonizes</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">protect</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">omit</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">nodes</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">openssl</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w">
          </span><span class="n">tool</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">manage</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">keys</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">Keep</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">mind</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">storing</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="n">extent</span><span class="w"> </span><span class="n">invalidates</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">ca</span><span class="w"> </span><span class="n">file</span><span class="w">
          </span><span class="nc">Certificate</span><span class="w">  </span><span class="n">authority</span><span class="w">  </span><span class="p" data-group-id="4008597425-2">(</span><span class="nc">CA</span><span class="p" data-group-id="4008597425-2">)</span><span class="w">  </span><span class="n">file</span><span class="w">  </span><span class="ow">in</span><span class="w"> </span><span class="o">.</span><span class="n">pem</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">referred</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">certificate</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">.</span><span class="n">pem</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w">
          </span><span class="n">concatenated</span><span class="w"> </span><span class="n">together</span><span class="o">.</span><span class="w"> </span><span class="nc">You</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">construct</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">authority</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="ss">as</span><span class="p">:</span><span class="w">

             </span><span class="n">openssl</span><span class="w"> </span><span class="n">req</span><span class="w"> </span><span class="o">-</span><span class="n">nodes</span><span class="w"> </span><span class="o">-</span><span class="n">new</span><span class="w"> </span><span class="o">-</span><span class="n">x509</span><span class="w"> </span><span class="o">-</span><span class="n">keyout</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">key</span><span class="w"> </span><span class="o">-</span><span class="n">out</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">crt</span><span class="w">

          </span><span class="nc">Then</span><span class="w"> </span><span class="n">edit</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">openssl</span><span class="o">.</span><span class="n">cnf</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">edit</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">ca</span><span class="o">.</span><span class="n">crt</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="n">testing</span><span class="w"> </span><span class="n">purposes</span><span class="w"> </span><span class="n">only</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="n">includes</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">sample</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="p" data-group-id="4008597425-3">(</span><span class="n">ca</span><span class="o">.</span><span class="n">crt</span><span class="p" data-group-id="4008597425-3">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Of</span><span class="w"> </span><span class="n">course</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="kn">use</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">test</span><span class="w">  </span><span class="n">certificates</span><span class="w">
          </span><span class="ow">and</span><span class="w">  </span><span class="n">test</span><span class="w">  </span><span class="n">keys</span><span class="w"> </span><span class="n">distributed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">production</span><span class="w"> </span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">virtue</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fact</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">distributed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="p">,</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">to</span><span class="err">‐</span><span class="w">
          </span><span class="n">tally</span><span class="w"> </span><span class="n">insecure</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">capath</span><span class="w"> </span><span class="n">dir</span><span class="w">
          </span><span class="nc">Directory</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">trusted</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="p" data-group-id="4008597425-4">(</span><span class="nc">CAs</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">CRLs</span><span class="p" data-group-id="4008597425-4">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Not</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">mbed</span><span class="w"> </span><span class="nc">TLS</span><span class="o">.</span><span class="w">

          </span><span class="nc">CAs</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">capath</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="o">&lt;</span><span class="n">hash</span><span class="o">&gt;</span><span class="o">.</span><span class="o">&lt;</span><span class="n">n</span><span class="o">&gt;</span><span class="o">.</span><span class="w"> </span><span class="nc">CRLs</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="o">&lt;</span><span class="n">hash</span><span class="o">&gt;</span><span class="o">.</span><span class="n">r</span><span class="o">&lt;</span><span class="n">n</span><span class="o">&gt;</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="nc">CApath</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">openssl</span><span class="w">  </span><span class="n">verify</span><span class="p">,</span><span class="w">
          </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">hash</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">openssl</span><span class="w"> </span><span class="n">x509</span><span class="p">,</span><span class="w"> </span><span class="n">openssl</span><span class="w"> </span><span class="n">crl</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">X509_LOOKUP_hash_dir</span><span class="p" data-group-id="4008597425-5">(</span><span class="p" data-group-id="4008597425-5">)</span><span class="p" data-group-id="4008597425-6">(</span><span class="mi">3</span><span class="p" data-group-id="4008597425-6">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="o">.</span><span class="w">

          </span><span class="nc">Similar</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="o">--</span><span class="n">crl</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="nc">CRLs</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">mandatory</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">usual</span><span class="w"> </span><span class="n">warning</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">logs</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">relevant</span><span class="w"> </span><span class="nc">CRL</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">missing</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w">
          </span><span class="n">connection</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">allowed</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">cert</span><span class="w"> </span><span class="n">file</span><span class="w">
          </span><span class="nc">Local</span><span class="w"> </span><span class="n">peer</span><span class="sc">&#39;s signed certificate in .pem format -- must be signed by a certificate authority whose certificate is in --ca file. Each peer in an OpenVPN
          link  running  in TLS mode should have its own certificate and private key file. In addition, each certificate should have been signed by the key of a
          certificate authority whose public key resides in the --ca certificate authority file. You can easily make your own certificate authority (see  above)
          or pay money to use a commercial service such as thawte.com (in which case you will be helping to finance the world&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">tourist</span><span class="w"> </span><span class="p">:</span><span class="p">)</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">gen</span><span class="err">‐</span><span class="w">
          </span><span class="n">erate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">certificate</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="ss">as</span><span class="p">:</span><span class="w">

             </span><span class="n">openssl</span><span class="w"> </span><span class="n">req</span><span class="w"> </span><span class="o">-</span><span class="n">nodes</span><span class="w"> </span><span class="o">-</span><span class="n">new</span><span class="w"> </span><span class="o">-</span><span class="n">keyout</span><span class="w"> </span><span class="n">mycert</span><span class="o">.</span><span class="n">key</span><span class="w"> </span><span class="o">-</span><span class="n">out</span><span class="w"> </span><span class="n">mycert</span><span class="o">.</span><span class="n">csr</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">authority</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">lives</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">machine</span><span class="p">,</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">signing</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="p" data-group-id="4008597425-7">(</span><span class="n">mycert</span><span class="o">.</span><span class="n">csr</span><span class="p" data-group-id="4008597425-7">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">machine</span><span class="w"> </span><span class="p" data-group-id="4008597425-8">(</span><span class="n">this</span><span class="w">  </span><span class="n">can</span><span class="w">
          </span><span class="n">be</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">insecure</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">email</span><span class="p" data-group-id="4008597425-8">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Now</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="ss">as</span><span class="p">:</span><span class="w">

             </span><span class="n">openssl</span><span class="w"> </span><span class="n">ca</span><span class="w"> </span><span class="o">-</span><span class="n">out</span><span class="w"> </span><span class="n">mycert</span><span class="o">.</span><span class="n">crt</span><span class="w"> </span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">mycert</span><span class="o">.</span><span class="n">csr</span><span class="w">

          </span><span class="nc">Now</span><span class="w">  </span><span class="n">copy</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">certificate</span><span class="w">  </span><span class="p" data-group-id="4008597425-9">(</span><span class="n">mycert</span><span class="o">.</span><span class="n">crt</span><span class="p" data-group-id="4008597425-9">)</span><span class="w">  </span><span class="n">back</span><span class="w">  </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">initially</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">.</span><span class="n">csr</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="p" data-group-id="4008597425-10">(</span><span class="n">this</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="n">medium</span><span class="p" data-group-id="4008597425-10">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w">
          </span><span class="n">openssl</span><span class="w"> </span><span class="n">ca</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">reads</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">authority</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w">  </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">openssl</span><span class="o">.</span><span class="n">cnf</span><span class="w">  </span><span class="o">--</span><span class="w">  </span><span class="n">note</span><span class="w">  </span><span class="n">also</span><span class="w">
          </span><span class="n">that</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">authority</span><span class="w"> </span><span class="n">functions</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">index</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="p" data-group-id="4008597425-11">(</span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">empty</span><span class="p" data-group-id="4008597425-11">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">serial</span><span class="w"> </span><span class="p" data-group-id="4008597425-12">(</span><span class="n">initialize</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">01</span><span class="p" data-group-id="4008597425-12">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">crl</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Check</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">Certificate</span><span class="w"> </span><span class="nc">Revocation</span><span class="w"> </span><span class="nc">List</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">crl</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">file</span><span class="o">/</span><span class="n">directory</span><span class="w"> </span><span class="n">flag</span><span class="w">

          </span><span class="ss">Examples</span><span class="p">:</span><span class="w">

             </span><span class="n">crl</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">crl</span><span class="o">-</span><span class="n">file</span><span class="o">.</span><span class="n">pem</span><span class="w">
             </span><span class="n">crl</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">openvpn</span><span class="o">/</span><span class="n">crls</span><span class="w"> </span><span class="n">dir</span><span class="w">

          </span><span class="nc">A</span><span class="w"> </span><span class="nc">CRL</span><span class="w"> </span><span class="p" data-group-id="4008597425-13">(</span><span class="n">certificate</span><span class="w"> </span><span class="n">revocation</span><span class="w"> </span><span class="n">list</span><span class="p" data-group-id="4008597425-13">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">compromised</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">overall</span><span class="w"> </span><span class="nc">PKI</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">intact</span><span class="o">.</span><span class="w">

          </span><span class="nc">Suppose</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">PKI</span><span class="w"> </span><span class="n">consisting</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">CA</span><span class="p">,</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">certificate</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">certificates</span><span class="o">.</span><span class="w"> </span><span class="nc">Suppose</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">laptop</span><span class="w"> </span><span class="n">computer</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="ow">and</span><span class="w">
          </span><span class="n">certificate</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">stolen</span><span class="o">.</span><span class="w"> </span><span class="nc">By</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">stolen</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">CRL</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">attempts</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">it</span><span class="p">,</span><span class="w">  </span><span class="n">while</span><span class="w">  </span><span class="n">preserving</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="n">overall</span><span class="w"> </span><span class="n">integrity</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PKI</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">necessary</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">rebuild</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">entire</span><span class="w"> </span><span class="nc">PKI</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">scratch</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">compromised</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">mandatory</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">relevant</span><span class="w"> </span><span class="nc">CRL</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">missing</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">warning</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">logs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w">

             </span><span class="nc">VERIFY</span><span class="w"> </span><span class="ss">WARNING</span><span class="p">:</span><span class="w"> </span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">unable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="nc">CRL</span><span class="w">

          </span><span class="n">but</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">connection</span><span class="w">  </span><span class="n">will</span><span class="w">  </span><span class="n">be</span><span class="w"> </span><span class="n">allowed</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">crl</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">pointed</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">directory</span><span class="w">
          </span><span class="n">containing</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">revoked</span><span class="w"> </span><span class="n">serial</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="p" data-group-id="4008597425-14">(</span><span class="n">the</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">empty</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">contents</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">read</span><span class="p" data-group-id="4008597425-14">)</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">connection</span><span class="p">,</span><span class="w">  </span><span class="n">where</span><span class="w">  </span><span class="n">the</span><span class="w">
          </span><span class="n">client</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">serial</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="p" data-group-id="4008597425-15">(</span><span class="n">decimal</span><span class="w"> </span><span class="n">string</span><span class="p" data-group-id="4008597425-15">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">directory</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">rejected</span><span class="o">.</span><span class="w">

          </span><span class="ss">Note</span><span class="p">:</span><span class="w">  </span><span class="nc">As</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">crl</span><span class="w">  </span><span class="n">file</span><span class="w"> </span><span class="p" data-group-id="4008597425-16">(</span><span class="ow">or</span><span class="w"> </span><span class="n">directory</span><span class="p" data-group-id="4008597425-16">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">connects</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">dropping</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">user</span><span class="w">
                 </span><span class="n">has</span><span class="w"> </span><span class="n">sufficient</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">dh</span><span class="w"> </span><span class="n">file</span><span class="w">
          </span><span class="nc">File</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="nc">Diffie</span><span class="w"> </span><span class="nc">Hellman</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">.</span><span class="n">pem</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="p" data-group-id="4008597425-17">(</span><span class="n">required</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">server</span><span class="w"> </span><span class="n">only</span><span class="p" data-group-id="4008597425-17">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">Set</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">none</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="nc">Diffie</span><span class="w"> </span><span class="nc">Hellman</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">exchange</span><span class="w"> </span><span class="p" data-group-id="4008597425-18">(</span><span class="ow">and</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="nc">ECDH</span><span class="w"> </span><span class="n">only</span><span class="p" data-group-id="4008597425-18">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">peers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">SSL</span><span class="w">  </span><span class="n">library</span><span class="w">  </span><span class="n">that</span><span class="w">  </span><span class="n">supports</span><span class="w">
          </span><span class="nc">ECDH</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">suites</span><span class="w"> </span><span class="p" data-group-id="4008597425-19">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="mf">1.0</span><span class="o">.</span><span class="mi">1</span><span class="o">+</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">mbed</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="mf">2.0</span><span class="o">+</span><span class="p" data-group-id="4008597425-19">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">Use</span><span class="w"> </span><span class="n">openssl</span><span class="w"> </span><span class="n">dhparam</span><span class="w"> </span><span class="o">-</span><span class="n">out</span><span class="w"> </span><span class="n">dh2048</span><span class="o">.</span><span class="n">pem</span><span class="w"> </span><span class="mi">2048</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="mi">2048</span><span class="o">-</span><span class="n">bit</span><span class="w"> </span><span class="nc">DH</span><span class="w"> </span><span class="n">parameters</span><span class="o">.</span><span class="w"> </span><span class="nc">Diffie</span><span class="w"> </span><span class="nc">Hellman</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">considered</span><span class="w"> </span><span class="n">public</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">ecdh</span><span class="o">-</span><span class="n">curve</span><span class="w"> </span><span class="n">name</span><span class="w">
          </span><span class="nc">Specify</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">curve</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">elliptic</span><span class="w"> </span><span class="n">curve</span><span class="w"> </span><span class="nc">Diffie</span><span class="w"> </span><span class="nc">Hellman</span><span class="o">.</span><span class="w"> </span><span class="nc">Available</span><span class="w"> </span><span class="n">curves</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">listed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">curves</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">curve</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w">
          </span><span class="k">for</span><span class="w"> </span><span class="nc">ECDH</span><span class="w"> </span><span class="nc">TLS</span><span class="o">-</span><span class="n">ciphers</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">mbed</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">builds</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">extra</span><span class="o">-</span><span class="n">certs</span><span class="w"> </span><span class="n">file</span><span class="w">
          </span><span class="nc">Specify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="nc">PEM</span><span class="w"> </span><span class="n">certs</span><span class="w"> </span><span class="p" data-group-id="4008597425-20">(</span><span class="n">concatenated</span><span class="w"> </span><span class="n">together</span><span class="p" data-group-id="4008597425-20">)</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">complete</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">chain</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s">&quot;split&quot;</span><span class="w"> </span><span class="nc">CAs</span><span class="p">,</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">certs</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">certs</span><span class="o">.</span><span class="w"> </span><span class="nc">Putting</span><span class="w"> </span><span class="n">certs</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">them</span><span class="w">
          </span><span class="n">to</span><span class="w">  </span><span class="n">be</span><span class="w">  </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">complete</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">chain</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">trusting</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">verify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">peer</span><span class="o">-</span><span class="n">submitted</span><span class="w"> </span><span class="n">certificate</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certs</span><span class="w">
          </span><span class="n">were</span><span class="w"> </span><span class="n">placed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ca</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">hand</span><span class="o">-</span><span class="n">window</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Handshake</span><span class="w"> </span><span class="nc">Window</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">exchange</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">finalize</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">handshake</span><span class="w"> </span><span class="n">initiation</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="p" data-group-id="4008597425-21">(</span><span class="n">default</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="n">seconds</span><span class="p" data-group-id="4008597425-21">)</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">hand</span><span class="err">‐</span><span class="w">
          </span><span class="n">shake</span><span class="w"> </span><span class="n">fails</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">attempt</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">again</span><span class="o">.</span><span class="w"> </span><span class="nc">Even</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">handshake</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">expiring</span><span class="w">
          </span><span class="n">key</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">tran</span><span class="o">-</span><span class="n">window</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">maintain</span><span class="w"> </span><span class="n">continuity</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">transmission</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">key</span><span class="w"> </span><span class="n">file</span><span class="w">
          </span><span class="nc">Local</span><span class="w"> </span><span class="n">peer</span><span class="sc">&#39;s private key in .pem format. Use the private key which was generated when you built your peer&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="p" data-group-id="4008597425-22">(</span><span class="n">see</span><span class="w"> </span><span class="o">--</span><span class="n">cert</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">above</span><span class="p" data-group-id="4008597425-22">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">pkcs12</span><span class="w"> </span><span class="n">file</span><span class="w">
          </span><span class="nc">Specify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">PKCS</span><span class="w"> </span><span class="c1">#12 file containing local private key, local certificate, and root CA certificate. This option can be used instead of --ca, --cert, and</span><span class="w">
          </span><span class="o">--</span><span class="n">key</span><span class="o">.</span><span class="w">  </span><span class="nc">Not</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">mbed</span><span class="w"> </span><span class="nc">TLS</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">eku</span><span class="w"> </span><span class="n">oid</span><span class="w">
          </span><span class="nc">Require</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">signed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">explicit</span><span class="w"> </span><span class="n">extended</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">usage</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">clients</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">designated</span><span class="w"> </span><span class="n">server</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">extended</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">oid</span><span class="w"> </span><span class="n">notation</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">symbolic</span><span class="w"> </span><span class="n">representation</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">ku</span><span class="w"> </span><span class="n">key</span><span class="o">-</span><span class="n">usage</span><span class="w">
          </span><span class="nc">Require</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">signed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">explicit</span><span class="w"> </span><span class="n">key</span><span class="o">-</span><span class="n">usage</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w">  </span><span class="n">present</span><span class="w">  </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">keyUsage</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">validated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="o">.</span><span class="w"> </span><span class="nc">Specifying</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">arguments</span><span class="w">
          </span><span class="n">requires</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">extension</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="p" data-group-id="4008597425-23">(</span><span class="n">so</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">verify</span><span class="w"> </span><span class="n">it</span><span class="p" data-group-id="4008597425-23">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">key</span><span class="o">-</span><span class="n">usage</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">bits</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">keyUsage</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="o">-</span><span class="n">us</span><span class="err">‐</span><span class="w">
          </span><span class="n">age</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">key</span><span class="o">-</span><span class="n">usage</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">hex</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w">

             </span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">ku</span><span class="w"> </span><span class="n">a0</span><span class="w">

   </span><span class="o">--</span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">tls</span><span class="w"> </span><span class="n">type</span><span class="w">
          </span><span class="nc">Require</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">signed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">explicit</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">extended</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">RFC3280</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">rules</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">tls</span><span class="w"> </span><span class="n">server</span><span class="w">
             </span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">tls</span><span class="w"> </span><span class="n">client</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">clients</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">designated</span><span class="w"> </span><span class="n">server</span><span class="o">.</span><span class="w"> </span><span class="nc">Or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">around</span><span class="p">;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">to</span><span class="w">
          </span><span class="n">verify</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">hosts</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">connect</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">tls</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w">

             </span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">ku</span><span class="w">
             </span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">eku</span><span class="w"> </span><span class="s">&quot;TLS Web Client Authentication&quot;</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">tls</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">to</span><span class="w">

             </span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">ku</span><span class="w">
             </span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">eku</span><span class="w"> </span><span class="s">&quot;TLS Web Server Authentication&quot;</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">important</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">precaution</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">protect</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">man</span><span class="o">-</span><span class="ow">in</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">middle</span><span class="w"> </span><span class="n">attack</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">authorized</span><span class="w">  </span><span class="n">client</span><span class="w">  </span><span class="n">attempts</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">connect</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">another</span><span class="w">
          </span><span class="n">client</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">impersonating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">attack</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">easily</span><span class="w"> </span><span class="n">prevented</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">having</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">verify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">tls</span><span class="p">,</span><span class="w">
          </span><span class="o">--</span><span class="n">verify</span><span class="o">-</span><span class="n">x509</span><span class="o">-</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">verify</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Add</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">layer</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">HMAC</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">mitigate</span><span class="w"> </span><span class="nc">DoS</span><span class="w"> </span><span class="n">attacks</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">attacks</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">stack</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="n">file</span><span class="w">
             </span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="mi">0</span><span class="w">
             </span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="mi">1</span><span class="w">

          </span><span class="nc">In</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">nutshell</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="n">enables</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">kind</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="s">&quot;HMAC firewall&quot;</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="sc">&#39;s TCP/UDP port, where TLS control channel packets  bearing  an  incorrect  HMAC
          signature can be dropped immediately without response.

          file (required) is a file in OpenVPN static key format which can be generated by --genkey.

          Older versions (up to OpenVPN 2.3) supported a freeform passphrase file.  This is no longer supported in newer versions (v2.4+).

          See the --secret option for more information on the optional direction parameter.

          --tls-auth  is  recommended when you are running OpenVPN in a mode where it is listening for packets from any IP address, such as when --remote is not
          specified, or --remote is specified with --float.

          The rationale for this feature is as follows. TLS requires a multi-packet exchange before it is able to authenticate a peer. During this  time  before
          authentication, OpenVPN is allocating resources (memory and CPU) to this potential peer. The potential peer is also exposing many parts of OpenVPN and
          the OpenSSL library to the packets it is sending. Most successful network attacks today seek to either exploit bugs in programs (such as buffer  over‐
          flow  attacks)  or  force  a  program  to consume so many resources that it becomes unusable. Of course the first line of defense is always to produce
          clean, well-audited code. OpenVPN has been written with buffer overflow attack prevention as a top priority. But as history has  shown,  many  of  the
          most widely used network applications have, from time to time, fallen to buffer overflow attacks.

          So as a second line of defense, OpenVPN offers this special layer of authentication on top of the TLS control channel so that every packet on the con‐
          trol channel is authenticated by an HMAC signature and a unique ID for replay protection. This signature will also help protect against DoS (Denial of
          Service)  attacks.  An important rule of thumb in reducing vulnerability to DoS attacks is to minimize the amount of resources a potential, but as yet
          unauthenticated, client is able to consume.

          --tls-auth does this by signing every TLS control channel packet with an HMAC signature, including packets which are sent before the TLS level has had
          a  chance  to  authenticate  the peer. The result is that packets without the correct signature can be dropped immediately upon reception, before they
          have a chance to consume additional system resources such as by initiating a TLS handshake. --tls-auth can be strengthened by adding the --replay-per‐
          sist option which will keep OpenVPN&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">replay</span><span class="w"> </span><span class="n">protection</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">lost</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="n">restarts</span><span class="o">.</span><span class="w">

          </span><span class="nc">It</span><span class="w">  </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">emphasized</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="n">gives</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">power</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">initiate</span><span class="w">
          </span><span class="n">a</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">encrypt</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">authenticate</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="w">

          </span><span class="nc">Use</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">authenticate</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">encrypt</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">channel</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">groups</span><span class="w"> </span><span class="n">list</span><span class="w">
          </span><span class="nc">A</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">allowable</span><span class="w"> </span><span class="n">groups</span><span class="o">/</span><span class="n">curves</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">preference</span><span class="o">.</span><span class="w">

          </span><span class="nc">Set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">elliptic</span><span class="w"> </span><span class="n">curves</span><span class="o">/</span><span class="n">groups</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">session</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">signatures</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">exchange</span><span class="o">.</span><span class="w">

          </span><span class="n">mbedTLS</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">curves</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">default</span><span class="o">.</span><span class="w">

          </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="mf">1.1</span><span class="o">+</span><span class="w"> </span><span class="n">restricts</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">to</span><span class="w">

             </span><span class="s">&quot;X25519:secp256r1:X448:secp521r1:secp384r1&quot;</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">standard</span><span class="w"> </span><span class="n">curves</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">here</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="k" data-group-id="4008597425-24">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ecdh</span><span class="w"> </span><span class="n">curve</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">using</span><span class="w">  </span><span class="o">--</span><span class="n">ecdh</span><span class="o">-</span><span class="n">curve</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w">
          </span><span class="n">groups</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">ecdh</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">picked</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

          </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">maps</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">curve</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">secp256r1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">prime256v1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">groups</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">mbedTLS</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="o">.</span><span class="w">

          </span><span class="ss">Warning</span><span class="p">:</span><span class="w">  </span><span class="n">this</span><span class="w">  </span><span class="n">option</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">affects</span><span class="w"> </span><span class="n">elliptic</span><span class="w"> </span><span class="n">curve</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">exchange</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="mf">1.3</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">improperly</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">disable</span><span class="w">
          </span><span class="nc">TLS</span><span class="w"> </span><span class="mf">1.3</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">profile</span><span class="w"> </span><span class="n">profile</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">cryptographic</span><span class="w"> </span><span class="n">algorithms</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">according</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ss">supported</span><span class="p">:</span><span class="w">

          </span><span class="n">legacy</span><span class="w"> </span><span class="p" data-group-id="4008597425-25">(</span><span class="n">default</span><span class="p" data-group-id="4008597425-25">)</span><span class="w">
                 </span><span class="nc">SHA1</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">newer</span><span class="p">,</span><span class="w"> </span><span class="nc">RSA</span><span class="w"> </span><span class="mi">2048</span><span class="o">-</span><span class="n">bit</span><span class="o">+</span><span class="p">,</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">elliptic</span><span class="w"> </span><span class="n">curve</span><span class="o">.</span><span class="w">

          </span><span class="n">preferred</span><span class="w">
                 </span><span class="nc">SHA2</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">newer</span><span class="p">,</span><span class="w"> </span><span class="nc">RSA</span><span class="w"> </span><span class="mi">2048</span><span class="o">-</span><span class="n">bit</span><span class="o">+</span><span class="p">,</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">elliptic</span><span class="w"> </span><span class="n">curve</span><span class="o">.</span><span class="w">

          </span><span class="n">suiteb</span><span class="w"> </span><span class="nc">SHA256</span><span class="o">/</span><span class="nc">SHA384</span><span class="p">,</span><span class="w"> </span><span class="nc">ECDSA</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">P</span><span class="o">-</span><span class="mi">256</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">P</span><span class="o">-</span><span class="mi">384</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">fully</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">mbed</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">builds</span><span class="o">.</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">builds</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">approximation</span><span class="p">:</span><span class="w">

          </span><span class="n">legacy</span><span class="w"> </span><span class="p" data-group-id="4008597425-26">(</span><span class="n">default</span><span class="p" data-group-id="4008597425-26">)</span><span class="w">
                 </span><span class="n">sets</span><span class="w"> </span><span class="s">&quot;security level 1&quot;</span><span class="w">

          </span><span class="n">preferred</span><span class="w">
                 </span><span class="n">sets</span><span class="w"> </span><span class="s">&quot;security level 2&quot;</span><span class="w">

          </span><span class="n">suiteb</span><span class="w"> </span><span class="n">sets</span><span class="w"> </span><span class="s">&quot;security level 3&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">cipher</span><span class="w"> </span><span class="s">&quot;SUITEB128&quot;</span><span class="o">.</span><span class="w">

          </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">migrate</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="sc">&#39;preferred&#39;</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">future</span><span class="o">.</span><span class="w"> </span><span class="nc">Please</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">comply</span><span class="o">.</span><span class="w">

   </span><span class="ss">WARNING</span><span class="p">:</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">ciphers</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">ciphersuites</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">groups</span><span class="w">
          </span><span class="nc">These</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">expert</span><span class="w"> </span><span class="n">features</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">correctly</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">improve</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w"> </span><span class="nc">But</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">easy</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">unwittingly</span><span class="w"> </span><span class="kn">use</span><span class="w">
          </span><span class="n">them</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">carefully</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">gun</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">foot</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">break</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w"> </span><span class="nc">Use</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">care!</span><span class="w">

   </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">cipher</span><span class="w"> </span><span class="n">l</span><span class="w">
          </span><span class="nc">A</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">allowable</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">delimited</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">colon</span><span class="w"> </span><span class="p" data-group-id="4008597425-27">(</span><span class="s">&quot;:&quot;</span><span class="p" data-group-id="4008597425-27">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">These</span><span class="w">  </span><span class="n">setting</span><span class="w">  </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">suites</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="p" data-group-id="4008597425-28">(</span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">used</span><span class="p" data-group-id="4008597425-28">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">secure</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">control</span><span class="w">
          </span><span class="n">channel</span><span class="p">,</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">protect</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">exchanged</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="p" data-group-id="4008597425-29">(</span><span class="k">after</span><span class="w"> </span><span class="n">potential</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="o">/</span><span class="nc">IANA</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">translation</span><span class="p" data-group-id="4008597425-29">)</span><span class="w"> </span><span class="n">simply</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">crypto</span><span class="w"> </span><span class="n">library</span><span class="o">.</span><span class="w"> </span><span class="nc">Please</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="nc">OpenSSL</span><span class="w">  </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w">
          </span><span class="n">mbed</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">documentation</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">interpretation</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">cipher</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="mf">1.2</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">below</span><span class="o">.</span><span class="w">

          </span><span class="nc">Use</span><span class="w"> </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">tls</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">crypto</span><span class="w"> </span><span class="n">library</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w">     </span><span class="n">default</span><span class="w">     </span><span class="k">for</span><span class="w">     </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">cipher</span><span class="w">    </span><span class="n">is</span><span class="w">    </span><span class="n">to</span><span class="w">    </span><span class="kn">use</span><span class="w">    </span><span class="n">mbed</span><span class="w">    </span><span class="nc">TLS</span><span class="sc">&#39;s    default    cipher    list    when    using    mbed    TLS    or    DE‐
          FAULT:!EXP:!LOW:!MEDIUM:!kDH:!kECDH:!DSS:!PSK:!SRP:!kRSA when using OpenSSL.

          The default for --tls-ciphersuites is to use the crypto library&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">default</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">ciphersuites</span><span class="w"> </span><span class="n">l</span><span class="w">
          </span><span class="nc">Same</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">cipher</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="mf">1.3</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">up</span><span class="o">.</span><span class="w"> </span><span class="n">mbed</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="mf">1.3</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">yet</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">cipher</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">client</span><span class="w">
          </span><span class="nc">Enable</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">assume</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">role</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w"> </span><span class="n">keyfile</span><span class="w">
          </span><span class="nc">Encrypt</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">authenticate</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">keyfile</span><span class="o">.</span><span class="w"> </span><span class="p" data-group-id="4008597425-30">(</span><span class="nc">See</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">background</span><span class="o">.</span><span class="p" data-group-id="4008597425-30">)</span><span class="w">

          </span><span class="nc">Encrypting</span><span class="w"> </span><span class="p" data-group-id="4008597425-31">(</span><span class="ow">and</span><span class="w"> </span><span class="n">authenticating</span><span class="p" data-group-id="4008597425-31">)</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="ss">packets</span><span class="p">:</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">privacy</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">hiding</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">connection</span><span class="p">,</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">harder</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">identify</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">such</span><span class="p">,</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="s">&quot;poor-man&#39;s&quot;</span><span class="w"> </span><span class="n">post</span><span class="o">-</span><span class="n">quantum</span><span class="w"> </span><span class="n">security</span><span class="p">,</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">attackers</span><span class="w"> </span><span class="n">who</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pre</span><span class="o">-</span><span class="n">shared</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="p" data-group-id="4008597425-32">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">forward</span><span class="w"> </span><span class="n">secrecy</span><span class="p" data-group-id="4008597425-32">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">In</span><span class="w"> </span><span class="n">contrast</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kn">require</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="o">--</span><span class="n">key</span><span class="o">-</span><span class="n">direction</span><span class="o">.</span><span class="w">

          </span><span class="nc">Security</span><span class="w"> </span><span class="nc">Considerations</span><span class="w">

          </span><span class="nc">All</span><span class="w"> </span><span class="n">peers</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w"> </span><span class="n">pre</span><span class="o">-</span><span class="n">shared</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">authenticate</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">encrypt</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">messages</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="nc">IV</span><span class="w"> </span><span class="n">collisions</span><span class="w"> </span><span class="n">remain</span><span class="w">  </span><span class="n">un</span><span class="err">‐</span><span class="w">
          </span><span class="n">likely</span><span class="p">,</span><span class="w">  </span><span class="n">this</span><span class="w">  </span><span class="n">key</span><span class="w">  </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">encrypt</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">2</span><span class="o">^</span><span class="mi">48</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">server</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">2</span><span class="o">^</span><span class="mi">48</span><span class="w"> </span><span class="n">server</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">messages</span><span class="o">.</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="n">typical</span><span class="w"> </span><span class="n">initial</span><span class="w">
          </span><span class="n">negotiation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">direction</span><span class="o">.</span><span class="w"> </span><span class="nc">Assuming</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">renegotiations</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="mi">2</span><span class="o">^</span><span class="mi">16</span><span class="w"> </span><span class="p" data-group-id="4008597425-33">(</span><span class="mi">65536</span><span class="p" data-group-id="4008597425-33">)</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="p" data-group-id="4008597425-34">(</span><span class="n">to</span><span class="w">  </span><span class="n">be</span><span class="w">  </span><span class="n">con</span><span class="err">‐</span><span class="w">
          </span><span class="n">servative</span><span class="p" data-group-id="4008597425-34">)</span><span class="p">,</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="p" data-group-id="4008597425-35">(</span><span class="n">re</span><span class="p" data-group-id="4008597425-35">)</span><span class="n">negotiations</span><span class="w"> </span><span class="n">happen</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">minute</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p" data-group-id="4008597425-36">(</span><span class="mi">24</span><span class="o">/</span><span class="mi">7</span><span class="p" data-group-id="4008597425-36">)</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">lifetime</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">8171</span><span class="w"> </span><span class="n">years</span><span class="w"> </span><span class="n">divided</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w">
          </span><span class="n">of</span><span class="w"> </span><span class="n">users</span><span class="o">.</span><span class="w"> </span><span class="nc">So</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">rotate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">once</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">eight</span><span class="w"> </span><span class="n">years</span><span class="o">.</span><span class="w"> </span><span class="p" data-group-id="4008597425-37">(</span><span class="nc">And</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="mi">8000</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">year</span><span class="o">.</span><span class="p" data-group-id="4008597425-37">)</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="nc">IV</span><span class="w"> </span><span class="n">collisions</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">occur</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w"> </span><span class="n">degrading</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">using</span><span class="w">  </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="o">.</span><span class="w">   </span><span class="nc">That</span><span class="w">  </span><span class="n">is</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w">
          </span><span class="n">control</span><span class="w">  </span><span class="n">channel</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">benefits</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">protection</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">man</span><span class="o">-</span><span class="ow">in</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">middle</span><span class="o">-</span><span class="n">attacks</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">DoS</span><span class="w"> </span><span class="n">attacks</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="n">offer</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">pri</span><span class="err">‐</span><span class="w">
          </span><span class="n">vacy</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">post</span><span class="o">-</span><span class="n">quantum</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">offers</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">setups</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">setups</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">trusted</span><span class="p">,</span><span class="w"> </span><span class="n">consider</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="n">instead</span><span class="o">.</span><span class="w"> </span><span class="nc">That</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="n">unique</span><span class="w">  </span><span class="n">keys</span><span class="p">,</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">thereby</span><span class="w">  </span><span class="n">im</span><span class="err">‐</span><span class="w">
          </span><span class="n">proves</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">bounds</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="sc">&#39;rotate a client key at least once per 8000 years&#39;</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="n">keyfile</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w"> </span><span class="n">keys</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="n">clients</span><span class="p">,</span><span class="w"> </span><span class="n">keyfile</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="w"> </span><span class="nc">Such</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w">  </span><span class="n">servers</span><span class="p">,</span><span class="w"> </span><span class="n">keyfile</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">unwrap</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">setup</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">used</span><span class="w">
          </span><span class="n">to</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="p" data-group-id="4008597425-38">(</span><span class="n">see</span><span class="w"> </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="o">-</span><span class="n">client</span><span class="p" data-group-id="4008597425-38">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">On</span><span class="w"> </span><span class="n">servers</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">together</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">case</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">detect</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">us</span><span class="err">‐</span><span class="w">
          </span><span class="n">ing</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">cmd</span><span class="w">
          </span><span class="nc">Run</span><span class="w">  </span><span class="n">command</span><span class="w">  </span><span class="n">cmd</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">verify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">administrators</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reject</span><span class="w">
          </span><span class="n">client</span><span class="w"> </span><span class="n">connections</span><span class="p">,</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">exposing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="p" data-group-id="4008597425-39">(</span><span class="n">including</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">notoriously</span><span class="w"> </span><span class="n">dangerous</span><span class="w"> </span><span class="nc">X</span><span class="o">.</span><span class="mi">509</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">ASN</span><span class="o">.</span><span class="mi">1</span><span class="w"> </span><span class="n">stacks</span><span class="p" data-group-id="4008597425-39">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w">

          </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">supplies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">command</span><span class="p">:</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="n">script_type</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="o">-</span><span class="n">verify</span><span class="w">

          </span><span class="err">•</span><span class="w"> </span><span class="n">metadata_type</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">supplied</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="sc">&#39;s a 64-bit unix timestamp representing the key creation time.

          • metadata_file contains the filename of a temporary file that contains the client metadata.

          The command can reject the connection by exiting with a non-zero exit code.

   --tls-exit
          Exit on TLS negotiation failure.

   --tls-export-cert directory
          Store the certificates the clients use upon connection to this directory. This will be done before --tls-verify is called. The certificates will use a
          temporary  name and will be deleted when the tls-verify script returns. The file name used for the certificate is available via the peer_cert environ‐
          ment variable.

   --tls-server
          Enable TLS and assume server role during TLS handshake. Note that OpenVPN is designed as a peer-to-peer application.  The  designation  of  client  or
          server is only for the purpose of negotiating the TLS control channel.

   --tls-timeout n
          Packet retransmit timeout on TLS control channel if no acknowledgment from remote within n seconds (default 2). When OpenVPN sends a control packet to
          its peer, it will expect to receive an acknowledgement within n seconds or it will retransmit the packet, subject to a  TCP-like  exponential  backoff
          algorithm.  This  parameter  only applies to control channel packets. Data channel packets (which carry encrypted tunnel data) are never acknowledged,
          sequenced, or retransmitted by OpenVPN because the higher level network protocols running on top of the tunnel such as TCP expect this role to be left
          to them.

   --tls-version-min args
          Sets the minimum TLS version we will accept from the peer (default is &quot;1.0&quot;).

          Valid syntax:

             tls-version-min version [&#39;</span><span class="ow">or</span><span class="o">-</span><span class="n">highest</span><span class="sc">&#39;]

          Examples  for  version include 1.0, 1.1, or 1.2. If or-highest is specified and version is not recognized, we will only accept the highest TLS version
          supported by the local SSL implementation.

   --tls-version-max version
          Set the maximum TLS version we will use (default is the highest version supported). Examples for version include 1.0, 1.1, or 1.2.

   --verify-hash args
          Specify SHA1 or SHA256 fingerprint for level-1 cert.

          Valid syntax:

             verify-hash hash [algo]

          The level-1 cert is the CA (or intermediate cert) that signs the leaf certificate, and is one removed from the leaf certificate in  the  direction  of
          the  root. When accepting a connection from a peer, the level-1 cert fingerprint must match hash or certificate verification will fail. Hash is speci‐
          fied as XX:XX:... For example:

             AD:B0:95:D8:09:C8:36:45:12:A9:89:C8:90:09:CB:13:72:A6:AD:16

          The algo flag can be either SHA1 or SHA256. If not provided, it defaults to SHA1.

   --verify-x509-name args
          Accept connections only if a host&#39;</span><span class="n">s</span><span class="w"> </span><span class="nc">X</span><span class="o">.</span><span class="mi">509</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">tests</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">verification</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">verify</span><span class="o">-</span><span class="n">x509</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">type</span><span class="w">

          </span><span class="nc">Which</span><span class="w"> </span><span class="nc">X</span><span class="o">.</span><span class="mi">509</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">compared</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">depends</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">type</span><span class="o">.</span><span class="w">  </span><span class="n">type</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">subject</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">complete</span><span class="w"> </span><span class="n">subject</span><span class="w"> </span><span class="nc">DN</span><span class="w"> </span><span class="p" data-group-id="4008597425-40">(</span><span class="n">default</span><span class="p" data-group-id="4008597425-40">)</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">match</span><span class="w">  </span><span class="n">a</span><span class="w">
          </span><span class="n">subject</span><span class="w">  </span><span class="nc">RDN</span><span class="w">  </span><span class="ow">or</span><span class="w"> </span><span class="n">name</span><span class="o">-</span><span class="n">prefix</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subject</span><span class="w"> </span><span class="nc">RDN</span><span class="w"> </span><span class="n">prefix</span><span class="o">.</span><span class="w"> </span><span class="nc">Which</span><span class="w"> </span><span class="nc">RDN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">verified</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">depends</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">x509</span><span class="o">-</span><span class="n">username</span><span class="o">-</span><span class="n">field</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w"> </span><span class="nc">But</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">defaults</span><span class="w">
          </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p" data-group-id="4008597425-41">(</span><span class="nc">CN</span><span class="p" data-group-id="4008597425-41">)</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subject</span><span class="w"> </span><span class="nc">DN</span><span class="w">

             </span><span class="nc">C</span><span class="o">=</span><span class="nc">KG</span><span class="p">,</span><span class="w"> </span><span class="nc">ST</span><span class="o">=</span><span class="nc">NA</span><span class="p">,</span><span class="w"> </span><span class="nc">L</span><span class="o">=</span><span class="nc">Bishkek</span><span class="p">,</span><span class="w"> </span><span class="nc">CN</span><span class="o">=</span><span class="nc">Server</span><span class="o">-</span><span class="mi">1</span><span class="w">

          </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">matched</span><span class="w"> </span><span class="ss">by</span><span class="p">:</span><span class="w">

             </span><span class="n">verify</span><span class="o">-</span><span class="n">x509</span><span class="o">-</span><span class="n">name</span><span class="w"> </span><span class="sc">&#39;C=KG, ST=NA, L=Bishkek, CN=Server-1&#39;</span><span class="w">
             </span><span class="n">verify</span><span class="o">-</span><span class="n">x509</span><span class="o">-</span><span class="n">name</span><span class="w"> </span><span class="nc">Server</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">name</span><span class="w">
             </span><span class="n">verify</span><span class="o">-</span><span class="n">x509</span><span class="o">-</span><span class="n">name</span><span class="w"> </span><span class="nc">Server</span><span class="o">-</span><span class="w"> </span><span class="n">name</span><span class="o">-</span><span class="n">prefix</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">Server</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nc">Server</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="o">.</span><span class="w">

          </span><span class="o">--</span><span class="n">verify</span><span class="o">-</span><span class="n">x509</span><span class="o">-</span><span class="n">name</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="n">replacement</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">verify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="p">,</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="o">--</span><span class="n">verify</span><span class="o">-</span><span class="n">x509</span><span class="o">-</span><span class="n">name</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">--</span><span class="n">chroot</span><span class="w"> </span><span class="n">envi</span><span class="err">‐</span><span class="w">
          </span><span class="n">ronment</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">dependencies</span><span class="o">.</span><span class="w">

          </span><span class="nc">Using</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">name</span><span class="w">  </span><span class="n">prefix</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="n">alternative</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">managing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">CRL</span><span class="w"> </span><span class="p" data-group-id="4008597425-42">(</span><span class="nc">Certificate</span><span class="w"> </span><span class="nc">Revocation</span><span class="w"> </span><span class="nc">List</span><span class="p" data-group-id="4008597425-42">)</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">refuse</span><span class="w"> </span><span class="n">all</span><span class="w">
          </span><span class="n">certificates</span><span class="w"> </span><span class="n">except</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">designated</span><span class="w"> </span><span class="n">servers</span><span class="o">.</span><span class="w">

          </span><span class="ss">NOTE</span><span class="p">:</span><span class="w">  </span><span class="nc">Test</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">control</span><span class="o">.</span><span class="w"> </span><span class="nc">Never</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w">  </span><span class="k">with</span><span class="w">
                 </span><span class="n">type</span><span class="w"> </span><span class="n">name</span><span class="o">-</span><span class="n">prefix</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">signed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">third</span><span class="w"> </span><span class="n">party</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">commercial</span><span class="w"> </span><span class="n">web</span><span class="w"> </span><span class="nc">CA</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">x509</span><span class="o">-</span><span class="n">track</span><span class="w"> </span><span class="n">attribute</span><span class="w">
          </span><span class="nc">Save</span><span class="w">  </span><span class="n">peer</span><span class="w">  </span><span class="nc">X509</span><span class="w">  </span><span class="n">attribute</span><span class="w">  </span><span class="n">value</span><span class="w">  </span><span class="ow">in</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w"> </span><span class="nc">Prepend</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">attribute</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">save</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="n">cert</span><span class="w">
          </span><span class="n">chain</span><span class="o">.</span><span class="w"> </span><span class="nc">Values</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">X509_</span><span class="o">&lt;</span><span class="n">depth</span><span class="o">&gt;</span><span class="bp">_</span><span class="o">&lt;</span><span class="n">attribute</span><span class="o">&gt;=</span><span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="o">.</span><span class="w"> </span><span class="nc">Multiple</span><span class="w"> </span><span class="o">--</span><span class="n">x509</span><span class="o">-</span><span class="n">track</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">track</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">attributes</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">x509</span><span class="o">-</span><span class="n">username</span><span class="o">-</span><span class="n">field</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Field</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">X</span><span class="o">.</span><span class="mi">509</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">subject</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="p" data-group-id="4008597425-43">(</span><span class="n">default</span><span class="w"> </span><span class="nc">CN</span><span class="p" data-group-id="4008597425-43">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">x509</span><span class="o">-</span><span class="n">username</span><span class="o">-</span><span class="n">field</span><span class="w"> </span><span class="p" data-group-id="4008597425-44">[</span><span class="n">ext</span><span class="p">:</span><span class="p" data-group-id="4008597425-44">]</span><span class="n">fieldname</span><span class="w">

          </span><span class="nc">Typically</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">fieldname</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">following</span><span class="p">:</span><span class="w">

             </span><span class="n">x509</span><span class="o">-</span><span class="n">username</span><span class="o">-</span><span class="n">field</span><span class="w"> </span><span class="n">emailAddress</span><span class="w">
             </span><span class="n">x509</span><span class="o">-</span><span class="n">username</span><span class="o">-</span><span class="n">field</span><span class="w"> </span><span class="n">ext</span><span class="ss">:subjectAltName</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">emailAddress</span><span class="w"> </span><span class="n">attribute</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="nc">Subject</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">username</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">example</span><span class="w">  </span><span class="n">uses</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="ss">ext</span><span class="p">:</span><span class="w">
          </span><span class="n">prefix</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">signify</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">X</span><span class="o">.</span><span class="mi">509</span><span class="w"> </span><span class="n">extension</span><span class="w"> </span><span class="n">fieldname</span><span class="w"> </span><span class="n">subjectAltName</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">searched</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">rfc822Name</span><span class="w"> </span><span class="p" data-group-id="4008597425-45">(</span><span class="n">email</span><span class="p" data-group-id="4008597425-45">)</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">username</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">cases</span><span class="w">
          </span><span class="n">where</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">ext</span><span class="ss">:fieldname</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">occurrence</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">chosen</span><span class="o">.</span><span class="w">

          </span><span class="nc">When</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">verify</span><span class="o">-</span><span class="n">x509</span><span class="o">-</span><span class="n">name</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">chosen</span><span class="w"> </span><span class="n">fieldname</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Common</span><span class="w"> </span><span class="nc">Name</span><span class="o">.</span><span class="w">

          </span><span class="nc">Only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">subjectAltName</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">issuerAltName</span><span class="w"> </span><span class="nc">X</span><span class="o">.</span><span class="mi">509</span><span class="w"> </span><span class="n">extensions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">supported</span><span class="o">.</span><span class="w">

          </span><span class="nc">Please</span><span class="w"> </span><span class="ss">note</span><span class="p">:</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">all</span><span class="o">-</span><span class="n">lowercase</span><span class="w"> </span><span class="n">fieldname</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">uppercase</span><span class="w"> </span><span class="n">characters</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="n">ou</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">OU</span><span class="o">.</span><span class="w"> </span><span class="nc">A</span><span class="w">  </span><span class="n">mixed</span><span class="o">-</span><span class="k">case</span><span class="w">  </span><span class="n">fieldname</span><span class="w">
          </span><span class="ow">or</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">having</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">ext</span><span class="p">:</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="n">as</span><span class="o">-</span><span class="n">is</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">automatic</span><span class="w"> </span><span class="n">upcasing</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">deprecated</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="n">release</span><span class="o">.</span></code></pre><p>   PKCS#11 / SmartCard options</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="o">--</span><span class="n">pkcs11</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">private</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">performed</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">login</span><span class="o">.</span><span class="w">  </span><span class="nc">Every</span><span class="w"> </span><span class="n">provider</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">setting</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">pkcs11</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">private</span><span class="w"> </span><span class="mi">0</span><span class="w">
             </span><span class="n">pkcs11</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">private</span><span class="w"> </span><span class="mi">1</span><span class="w">

   </span><span class="o">--</span><span class="n">pkcs11</span><span class="o">-</span><span class="n">id</span><span class="w"> </span><span class="n">name</span><span class="w">
          </span><span class="nc">Specify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">serialized</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">gotten</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">standalone</span><span class="w"> </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">pkcs11</span><span class="o">-</span><span class="n">ids</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">pkcs11</span><span class="o">-</span><span class="n">id</span><span class="o">-</span><span class="n">management</span><span class="w">
          </span><span class="nc">Acquire</span><span class="w">  </span><span class="nc">PKCS</span><span class="c1">#11  id  from  management interface. In this case a NEED-STR &#39;pkcs11-id-request&#39; real-time message will be triggered, application may use</span><span class="w">
          </span><span class="n">pkcs11</span><span class="o">-</span><span class="n">id</span><span class="o">-</span><span class="n">count</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">retrieve</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">certificates</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">pkcs11</span><span class="o">-</span><span class="n">id</span><span class="o">-</span><span class="n">get</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">retrieve</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">body</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">pkcs11</span><span class="o">-</span><span class="n">pin</span><span class="o">-</span><span class="n">cache</span><span class="w"> </span><span class="n">seconds</span><span class="w">
          </span><span class="nc">Specify</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PIN</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">cached</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">removed</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">pkcs11</span><span class="o">-</span><span class="n">private</span><span class="o">-</span><span class="n">mode</span><span class="w"> </span><span class="n">mode</span><span class="w">
          </span><span class="nc">Specify</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">operations</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">provider</span><span class="o">.</span><span class="w"> </span><span class="nc">Mode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">encoded</span><span class="w">  </span><span class="n">as</span><span class="w">  </span><span class="n">hex</span><span class="w">
          </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">mask</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">following</span><span class="p">:</span><span class="w">

          </span><span class="mi">0</span><span class="w"> </span><span class="p" data-group-id="4843466190-1">(</span><span class="n">default</span><span class="p" data-group-id="4843466190-1">)</span><span class="w">   </span><span class="nc">Try</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">automatically</span><span class="o">.</span><span class="w">

          </span><span class="mi">1</span><span class="w">             </span><span class="nc">Use</span><span class="w"> </span><span class="n">sign</span><span class="o">.</span><span class="w">

          </span><span class="mi">2</span><span class="w">             </span><span class="nc">Use</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="n">recover</span><span class="o">.</span><span class="w">

          </span><span class="mi">4</span><span class="w">             </span><span class="nc">Use</span><span class="w"> </span><span class="n">decrypt</span><span class="o">.</span><span class="w">

          </span><span class="mi">8</span><span class="w">             </span><span class="nc">Use</span><span class="w"> </span><span class="n">unwrap</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">pkcs11</span><span class="o">-</span><span class="n">protected</span><span class="o">-</span><span class="n">authentication</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="nc">PKCS</span><span class="c1">#11 protected authentication path, useful for biometric and external keypad devices. Every provider has its own setting.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">pkcs11</span><span class="o">-</span><span class="n">protected</span><span class="o">-</span><span class="n">authentication</span><span class="w"> </span><span class="mi">0</span><span class="w">
             </span><span class="n">pkcs11</span><span class="o">-</span><span class="n">protected</span><span class="o">-</span><span class="n">authentication</span><span class="w"> </span><span class="mi">1</span><span class="w">

   </span><span class="o">--</span><span class="n">pkcs11</span><span class="o">-</span><span class="n">providers</span><span class="w"> </span><span class="n">provider</span><span class="w">
          </span><span class="nc">Specify</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">RSA</span><span class="w"> </span><span class="nc">Security</span><span class="w"> </span><span class="nc">Inc</span><span class="o">.</span><span class="w"> </span><span class="nc">PKCS</span><span class="w"> </span><span class="c1">#11 Cryptographic Token Interface (Cryptoki) providers to load. This option can be used instead of --cert, --key and</span><span class="w">
          </span><span class="o">--</span><span class="n">pkcs12</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">p11</span><span class="o">-</span><span class="n">kit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="p">,</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">p11</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="n">proxy</span><span class="o">.</span><span class="n">so</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">pkcs11</span><span class="o">-</span><span class="n">id</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">pkcs11</span><span class="o">-</span><span class="n">id</span><span class="o">-</span><span class="n">management</span><span class="w"> </span><span class="n">options</span><span class="w">
          </span><span class="n">are</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="o">--</span><span class="n">pkcs11</span><span class="o">-</span><span class="n">provider</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">given</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">pkcs11</span><span class="o">-</span><span class="n">ids</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="p" data-group-id="4843466190-2">(</span><span class="nc">Standalone</span><span class="p" data-group-id="4843466190-2">)</span><span class="w"> </span><span class="nc">Show</span><span class="w"> </span><span class="nc">PKCS</span><span class="c1">#11 token object list.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">show</span><span class="o">-</span><span class="n">pkcs11</span><span class="w"> </span><span class="p" data-group-id="4843466190-3">[</span><span class="n">provider</span><span class="p" data-group-id="4843466190-3">]</span><span class="w"> </span><span class="p" data-group-id="4843466190-4">[</span><span class="n">cert_private</span><span class="p" data-group-id="4843466190-4">]</span><span class="w">

          </span><span class="nc">Specify</span><span class="w"> </span><span class="n">cert_private</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">objects</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">p11</span><span class="o">-</span><span class="n">kit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">provider</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">optional</span><span class="p">;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">omitted</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">p11</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="n">proxy</span><span class="o">.</span><span class="n">so</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">queried</span><span class="o">.</span><span class="w">

          </span><span class="o">--</span><span class="n">verb</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="nc">BEFORE</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">produce</span><span class="w"> </span><span class="n">debugging</span><span class="w"> </span><span class="n">information</span><span class="o">.</span></code></pre><p>DATA CHANNEL CIPHER NEGOTIATION</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="mf">2.4</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">higher</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">capability</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">negotiate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">encrypt</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">describes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">mechanism</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">more</span><span class="w">
   </span><span class="n">detail</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">backwards</span><span class="w"> </span><span class="n">compatibility</span><span class="w"> </span><span class="n">mechanism</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">clients</span><span class="o">.</span></code></pre><p>   OpenVPN 2.5 and higher behaviour</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">When</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.5</span><span class="p">,</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="sc">&#39;s --data-ciphers is used to pick the the  data  ci‐
   pher.   That  means that the first cipher in that list that is also in the client&#39;</span><span class="n">s</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">chosen</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">is</span><span class="w">
   </span><span class="n">rejected</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">AUTH_FAILED</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="p" data-group-id="3226537925-1">(</span><span class="n">as</span><span class="w"> </span><span class="n">seen</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">log</span><span class="p" data-group-id="3226537925-1">)</span><span class="p">:</span><span class="w">
      </span><span class="ss">AUTH</span><span class="p">:</span><span class="w"> </span><span class="nc">Received</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="ss">message</span><span class="p">:</span><span class="w"> </span><span class="nc">AUTH_FAILED</span><span class="p">,</span><span class="nc">Data</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="n">failed</span><span class="w"> </span><span class="p" data-group-id="3226537925-2">(</span><span class="n">no</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="n">cipher</span><span class="p" data-group-id="3226537925-2">)</span><span class="w">

   </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.5</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">backwards</span><span class="w"> </span><span class="n">compatibility</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="o">--</span><span class="n">cipher</span><span class="w">  </span><span class="n">op</span><span class="err">‐</span><span class="w">
   </span><span class="n">tion</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">unset</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">GCM</span><span class="ss">:AES</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="nc">GCM</span><span class="o">.</span></code></pre><p>   OpenVPN 2.4 clients</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">The</span><span class="w">  </span><span class="n">negotiation</span><span class="w">  </span><span class="n">support</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.4</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">iteration</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">quirks</span><span class="o">.</span><span class="w"> </span><span class="nc">Its</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">goal</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="s">&quot;upgrade to AES-256-GCM
   when possible&quot;</span><span class="o">.</span><span class="w">  </span><span class="nc">An</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.4</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">crypto</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="nc">AES</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">GCM</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="o">--</span><span class="n">ncp</span><span class="o">-</span><span class="n">disable</span><span class="w"> </span><span class="n">will</span><span class="w">  </span><span class="n">always</span><span class="w">  </span><span class="n">an</span><span class="err">‐</span><span class="w">
   </span><span class="n">nounce</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">GCM</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="nc">GCM</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sending</span><span class="w"> </span><span class="nc">IV_NCP</span><span class="o">=</span><span class="mi">2</span><span class="o">.</span><span class="w">

   </span><span class="nc">This</span><span class="w">  </span><span class="n">only</span><span class="w">  </span><span class="n">causes</span><span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="n">problem</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">--</span><span class="n">ncp</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">GCM</span><span class="ss">:AES</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="nc">GCM</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">two</span><span class="w">
   </span><span class="n">ciphers</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">servers</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">GCM</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="nc">GCM</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">will</span><span class="w">  </span><span class="n">then</span><span class="w">  </span><span class="n">fail</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">therefore</span><span class="w">  </span><span class="n">recommended</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">always</span><span class="w">  </span><span class="n">have</span><span class="w">  </span><span class="n">the</span><span class="w">
   </span><span class="nc">AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">GCM</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="nc">GCM</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ncp</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">behaviour</span><span class="o">.</span></code></pre><p>   OpenVPN 3 clients</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Clients</span><span class="w">  </span><span class="n">based</span><span class="w">  </span><span class="n">on</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mi">3</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="p" data-group-id="6094866065-1">(</span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">openvpn</span><span class="o">/</span><span class="n">openvpn3</span><span class="o">/</span><span class="p" data-group-id="6094866065-1">)</span><span class="w"> </span><span class="k" data-group-id="6094866065-2">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">configurable</span><span class="w"> </span><span class="o">--</span><span class="n">ncp</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w"> </span><span class="nc">Instead</span><span class="w">
   </span><span class="n">these</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">announce</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="nc">AEAD</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="p" data-group-id="6094866065-3">(</span><span class="nc">AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">GCM</span><span class="p">,</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="nc">GCM</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">newer</span><span class="w"> </span><span class="n">versions</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="nc">Chacha20</span><span class="o">-</span><span class="nc">Poly1305</span><span class="p" data-group-id="6094866065-3">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">To</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mi">3</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="n">option</span><span class="o">.</span></code></pre><p>   OpenVPN 2.3 and older clients (and clients with --ncp-disable)</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">When</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">connects</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">cipher</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">must</span><span class="w">  </span><span class="n">be</span><span class="w">  </span><span class="ow">in</span><span class="err">‐</span><span class="w">
   </span><span class="n">cluded</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="o">.</span><span class="w"> </span><span class="nc">Otherwise</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">AUTH_FAILED</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">no</span><span class="w">
   </span><span class="n">shared</span><span class="w"> </span><span class="n">cipher</span><span class="o">.</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mf">2.3</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">small</span><span class="w">  </span><span class="o">.</span><span class="o">/</span><span class="n">configure</span><span class="w"> </span><span class="n">argument</span><span class="p">,</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="o">-</span><span class="n">fallback</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w">  </span><span class="n">config</span><span class="w">
   </span><span class="n">file</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">explicit</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">necessary</span><span class="o">.</span></code></pre><p>   OpenVPN 2.4 server</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">When</span><span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="nc">GCM</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">GCM</span><span class="w"> </span><span class="p" data-group-id="2678365499-1">(</span><span class="k">with</span><span class="w"> </span><span class="nc">IV_NCP</span><span class="o">=</span><span class="mi">2</span><span class="p" data-group-id="2678365499-1">)</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.4</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ncp</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w">
   </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">regardless</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">is</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">emulate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">behaviour</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.4</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">have</span><span class="w">  </span><span class="n">compatibility</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">setup</span><span class="w">
   </span><span class="n">that</span><span class="w">  </span><span class="n">depends</span><span class="w">  </span><span class="n">on</span><span class="w">  </span><span class="n">this</span><span class="w">  </span><span class="n">quirk</span><span class="p">,</span><span class="w">  </span><span class="n">adding</span><span class="w">   </span><span class="nc">AES</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="nc">GCM</span><span class="w">  </span><span class="ow">and</span><span class="w"> </span><span class="nc">AES</span><span class="o">-</span><span class="mi">256</span><span class="o">-</span><span class="nc">GCM</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">required</span><span class="o">.</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.5</span><span class="o">+</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">announce</span><span class="w"> </span><span class="n">the</span><span class="w">
   </span><span class="nc">IV_NCP</span><span class="o">=</span><span class="mi">2</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">ciphers</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">present</span><span class="o">.</span></code></pre><p>   OpenVPN 2.3 and older servers (and servers with --ncp-disable)</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="w">  </span><span class="p" data-group-id="0617186771-1">(</span><span class="nc">For</span><span class="w"> </span><span class="n">compat</span><span class="err">‐</span><span class="w">
   </span><span class="n">ibility</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.5</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">cipher</span><span class="p" data-group-id="0617186771-1">)</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mf">2.3</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="ow">and</span><span class="w">  </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">small</span><span class="w"> </span><span class="o">.</span><span class="o">/</span><span class="n">configure</span><span class="w"> </span><span class="n">argument</span><span class="p">,</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="o">-</span><span class="n">fallback</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">config</span><span class="w">
   </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">explicit</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">necessary</span><span class="o">.</span></code></pre><p>   Blowfish in CBC mode (BF-CBC) deprecation</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">cipher</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">defaulted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">BF</span><span class="o">-</span><span class="nc">CBC</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.4</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">version</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">backwards</span><span class="w"> </span><span class="n">compatibility</span><span class="o">.</span><span class="w">   </span><span class="nc">In</span><span class="w">  </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="mf">2.5</span><span class="w">
   </span><span class="n">this</span><span class="w">  </span><span class="n">behaviour</span><span class="w">  </span><span class="n">has</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">cipher</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">weak</span><span class="w"> </span><span class="nc">BF</span><span class="o">-</span><span class="nc">CBC</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">explicitly</span><span class="w">
   </span><span class="n">added</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">--</span><span class="n">cipher</span><span class="w"> </span><span class="nc">BFC</span><span class="o">-</span><span class="nc">CBC</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">ciphers</span><span class="o">.</span><span class="w">

   </span><span class="nc">We</span><span class="w"> </span><span class="n">strongly</span><span class="w"> </span><span class="n">recommend</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">switching</span><span class="w"> </span><span class="n">away</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="nc">BF</span><span class="o">-</span><span class="nc">CBC</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">secure</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">soon</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">instead</span><span class="o">.</span></code></pre><p>NETWORK CONFIGURATION</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">sides</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">configuration</span><span class="o">.</span><span class="w">  </span><span class="nc">One</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">other</span><span class="w">  </span><span class="n">side</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">virtual</span><span class="w">  </span><span class="n">network</span><span class="w">
   </span><span class="n">adapter</span><span class="w"> </span><span class="p" data-group-id="9288071605-1">(</span><span class="n">tun</span><span class="o">/</span><span class="n">tap</span><span class="w"> </span><span class="n">device</span><span class="p" data-group-id="9288071605-1">)</span><span class="o">.</span></code></pre><p>   Link Options</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">This</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">covers</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">related</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">bind</span><span class="w"> </span><span class="n">keywords</span><span class="w">
          </span><span class="nc">Bind</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">port</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">--</span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">socks</span><span class="o">-</span><span class="n">proxy</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">ipv6only</span><span class="w"> </span><span class="n">keyword</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="p" data-group-id="8865608190-1">(</span><span class="n">as</span><span class="w"> </span><span class="n">opposed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">IPv4</span><span class="p" data-group-id="8865608190-1">)</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">opened</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">float</span><span class="w">
          </span><span class="nc">Allow</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="p" data-group-id="8865608190-2">(</span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">used</span><span class="p" data-group-id="8865608190-2">)</span><span class="o">.</span><span class="w">  </span><span class="o">--</span><span class="n">float</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">speci</span><span class="err">‐</span><span class="w">
          </span><span class="n">fied</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">initially</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="n">however</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">arrive</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w">  </span><span class="n">pass</span><span class="w">
          </span><span class="n">all</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">tests</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">session</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">holds</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">ad</span><span class="err">‐</span><span class="w">
          </span><span class="n">dress</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dial</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w">

          </span><span class="nc">Essentially</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">float</span><span class="w"> </span><span class="n">tells</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="n">authenticated</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">fragment</span><span class="w"> </span><span class="n">max</span><span class="w">
          </span><span class="nc">Enable</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">datagram</span><span class="w"> </span><span class="n">fragmentation</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">datagrams</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">larger</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="n">bytes</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">link</span><span class="o">-</span><span class="n">mtu</span><span class="w"> </span><span class="n">parameter</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">encapsulation</span><span class="w"> </span><span class="n">overhead</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="ow">in</span><span class="p">,</span><span class="w">
          </span><span class="n">but</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">itself</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">fragment</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">sense</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="p" data-group-id="8865608190-3">(</span><span class="o">--</span><span class="n">proto</span><span class="w"> </span><span class="n">udp</span><span class="p" data-group-id="8865608190-3">)</span><span class="o">.</span><span class="w">

          </span><span class="o">--</span><span class="n">fragment</span><span class="w"> </span><span class="n">adds</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">overhead</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">datagram</span><span class="o">.</span><span class="w">

          </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">mssfix</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">important</span><span class="w"> </span><span class="n">related</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">fragment</span><span class="o">.</span><span class="w">

          </span><span class="nc">It</span><span class="w">  </span><span class="n">should</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">noted</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">meant</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">fragmentation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="n">level</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">meant</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">resort</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">path</span><span class="w">
          </span><span class="nc">MTU</span><span class="w"> </span><span class="n">discovery</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">broken</span><span class="o">.</span><span class="w"> </span><span class="nc">Using</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">efficient</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">fixing</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="nc">MTU</span><span class="w"> </span><span class="n">discovery</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">using</span><span class="w">  </span><span class="n">native</span><span class="w">  </span><span class="nc">IP</span><span class="w">  </span><span class="n">fragmentation</span><span class="w">  </span><span class="ow">in</span><span class="err">‐</span><span class="w">
          </span><span class="n">stead</span><span class="o">.</span><span class="w">

          </span><span class="nc">Having</span><span class="w">  </span><span class="n">said</span><span class="w">  </span><span class="n">that</span><span class="p">,</span><span class="w">  </span><span class="n">there</span><span class="w">  </span><span class="n">are</span><span class="w"> </span><span class="n">circumstances</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="sc">&#39;s internal fragmentation capability may be your only option, such as tunneling a UDP
          multicast stream which requires fragmentation.

   --keepalive args
          A helper directive designed to simplify the expression of --ping and --ping-restart.

          Valid syntax:

             keepalive interval timeout

          This option can be used on both client and server side, but it is enough to add this on the server  side  as  it  will  push  appropriate  --ping  and
          --ping-restart options to the client. If used on both server and client, the values pushed from server will override the client local values.

          The timeout argument will be twice as long on the server side. This ensures that a timeout is detected on client side before the server side drops the
          connection.

          For example, --keepalive 10 60 expands as follows:

             if mode server:
                 ping 10                    # Argument: interval
                 ping-restart 120           # Argument: timeout*2
                 push &quot;ping 10&quot;             # Argument: interval
                 push &quot;ping-restart 60&quot;     # Argument: timeout
             else
                 ping 10                    # Argument: interval
                 ping-restart 60            # Argument: timeout

   --link-mtu n
          Sets an upper bound on the size of UDP packets which are sent between OpenVPN peers. It&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">best</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">know</span><span class="w">  </span><span class="n">what</span><span class="w">  </span><span class="n">you</span><span class="sc">&#39;re
          doing.

   --local host
          Local host name or IP address for bind. If specified, OpenVPN will bind to this address only. If unspecified, OpenVPN will bind to all interfaces.

   --lport port
          Set local TCP/UDP port number or name. Cannot be used together with --nobind option.

   --mark value
          Mark encrypted packets being sent with value. The mark value can be matched in policy routing and packetfilter rules. This option is only supported in
          Linux and does nothing on other operating systems.

   --mode m
          Set OpenVPN major mode. By default, OpenVPN runs in point-to-point mode (p2p).  OpenVPN  2.0  introduces  a  new  mode  (server)  which  implements  a
          multi-client server capability.

   --mssfix max
          Announce to TCP sessions running over the tunnel that they should limit their send packet sizes such that after OpenVPN has encapsulated them, the re‐
          sulting UDP packet size that OpenVPN sends to its peer will not exceed max bytes. The default value is 1450.

          The max parameter is interpreted in the same way as the --link-mtu parameter, i.e. the UDP packet size after encapsulation overhead has been added in,
          but  not including the UDP header itself.  Resulting packet would be at most 28 bytes larger for IPv4 and 48 bytes for IPv6 (20/40 bytes for IP header
          and 8 bytes for UDP header). Default value of 1450 allows IPv4 packets to be transmitted over a link with MTU 1473 or higher without IP level fragmen‐
          tation.

          The --mssfix option only makes sense when you are using the UDP protocol for OpenVPN peer-to-peer communication, i.e. --proto udp.

          --mssfix and --fragment can be ideally used together, where --mssfix will try to keep TCP from needing packet fragmentation in the first place, and if
          big packets come through anyhow (from protocols other than TCP), --fragment will internally fragment them.

          Both --fragment and --mssfix are designed to work around cases where Path MTU discovery is broken on the network path between OpenVPN peers.

          The usual symptom of such a breakdown is an OpenVPN connection which successfully starts, but then stalls during active usage.

          If --fragment and --mssfix are used together, --mssfix will take its default max parameter from the --fragment max option.

          Therefore, one could lower the maximum UDP packet size to 1300 (a good first try for solving MTU-related connection problems) with the  following  op‐
          tions:

             --tun-mtu 1500 --fragment 1300 --mssfix

   --mtu-disc type
          Should we do Path MTU discovery on TCP/UDP channel? Only supported on OSes such as Linux that supports the necessary system call to set.

          Valid types:

          no      Never send DF (Don&#39;</span><span class="n">t</span><span class="w"> </span><span class="nc">Fragment</span><span class="p">)</span><span class="w"> </span><span class="n">frames</span><span class="w">

          </span><span class="n">maybe</span><span class="w">   </span><span class="nc">Use</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">route</span><span class="w"> </span><span class="n">hints</span><span class="w">

          </span><span class="n">yes</span><span class="w">     </span><span class="nc">Always</span><span class="w"> </span><span class="nc">DF</span><span class="w"> </span><span class="p" data-group-id="8865608190-4">(</span><span class="nc">Don</span><span class="sc">&#39;t Fragment)

   --mtu-test
          To  empirically measure MTU on connection startup, add the --mtu-test option to your configuration. OpenVPN will send ping packets of various sizes to
          the remote peer and measure the largest packets which were successfully received. The --mtu-test process normally takes about 3 minutes to complete.

   --nobind
          Do not bind to local address and port. The IP stack will allocate a dynamic port for returning packets. Since the value of the dynamic port could  not
          be known in advance by a peer, this option is only suitable for peers which will be initiating connections by using the --remote option.

   --passtos
          Set the TOS field of the tunnel packet to what the payload&#39;</span><span class="n">s</span><span class="w"> </span><span class="nc">TOS</span><span class="w"> </span><span class="n">is</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">ping</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Ping</span><span class="w">  </span><span class="n">remote</span><span class="w">  </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">UDP</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="p" data-group-id="8865608190-5">(</span><span class="n">specify</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">peers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="n">packets</span><span class="w">
          </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">directions</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">echoed</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="n">packets</span><span class="p" data-group-id="8865608190-5">)</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="sc">&#39;s secure modes (where --se‐
          cret, --tls-server or --tls-client is specified), the ping packet will be cryptographically secure.

          This option has two intended uses:

          1. Compatibility  with  stateful  firewalls. The periodic ping will ensure that a stateful firewall rule which allows OpenVPN UDP packets to pass will
             not time out.

          2. To provide a basis for the remote to test the existence of its peer using the --ping-exit option.

   --ping-exit n
          Causes OpenVPN to exit after n seconds pass without reception of a ping or other packet from remote. This option  can  be  combined  with  --inactive,
          --ping and --ping-exit to create a two-tiered inactivity disconnect.

          For example,

             openvpn [options...] --inactive 3600 --ping 10 --ping-exit 60

          when used on both peers will cause OpenVPN to exit within 60 seconds if its peer disconnects, but will exit after one hour if no actual tunnel data is
          exchanged.

   --ping-restart n
          Similar to --ping-exit, but trigger a SIGUSR1 restart after n seconds pass without reception of a ping or other packet from remote.

          This option is useful in cases where the remote peer has a dynamic IP address and a low-TTL DNS name is used to track the IP address using  a  service
          such as http://dyndns.org/ + a dynamic DNS client such as ddclient.

          If the peer cannot be reached, a restart will be triggered, causing the hostname used with --remote to be re-resolved (if --resolv-retry is also spec‐
          ified).

          In server mode, --ping-restart, --inactive or any other type of internally generated signal will always be applied to individual client  instance  ob‐
          jects,  never  to  whole server itself. Note also in server mode that any internally generated signal which would normally cause a restart, will cause
          the deletion of the client instance object instead.

          In client mode, the --ping-restart parameter is set to 120 seconds by default. This default will hold until the client pulls a replacement value  from
          the server, based on the --keepalive setting in the server configuration. To disable the 120 second default, set --ping-restart 0 on the client.

          See the signals section below for more information on SIGUSR1.

          Note that the behavior of SIGUSR1 can be modified by the --persist-tun, --persist-key, --persist-local-ip and --persist-remote-ip options.

          Also note that --ping-exit and --ping-restart are mutually exclusive and cannot be used together.

   --ping-timer-rem
          Run the --ping-exit / --ping-restart timer only if we have a remote address. Use this option if you are starting the daemon in listen mode (i.e. with‐
          out an explicit --remote peer), and you don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">clocking</span><span class="w"> </span><span class="n">timeouts</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">connects</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">proto</span><span class="w"> </span><span class="n">p</span><span class="w">
          </span><span class="nc">Use</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">communicating</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="o">.</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">udp</span><span class="p">,</span><span class="w"> </span><span class="n">tcp</span><span class="o">-</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">tcp</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">udp</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="o">--</span><span class="n">proto</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">specified</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">operation</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">proto</span><span class="w"> </span><span class="n">udp</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">peers</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">operation</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="o">--</span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="o">-</span><span class="n">server</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="o">--</span><span class="n">proto</span><span class="w"> </span><span class="n">tcp</span><span class="o">-</span><span class="n">client</span><span class="o">.</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">tcp</span><span class="o">-</span><span class="n">server</span><span class="w">  </span><span class="n">will</span><span class="w">  </span><span class="n">wait</span><span class="w">  </span><span class="n">indefi</span><span class="err">‐</span><span class="w">
          </span><span class="n">nitely</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">incoming</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">tcp</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">attempt</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">fails</span><span class="p">,</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">sleep</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="p" data-group-id="8865608190-6">(</span><span class="n">adjustable</span><span class="w"> </span><span class="n">via</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">connect</span><span class="o">-</span><span class="n">retry</span><span class="w"> </span><span class="n">option</span><span class="p" data-group-id="8865608190-6">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">again</span><span class="w"> </span><span class="n">infinite</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">N</span><span class="w"> </span><span class="n">retries</span><span class="w"> </span><span class="p" data-group-id="8865608190-7">(</span><span class="n">adjustable</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">connect</span><span class="o">-</span><span class="n">retry</span><span class="o">-</span><span class="n">max</span><span class="w"> </span><span class="n">option</span><span class="p" data-group-id="8865608190-7">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Both</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">will</span><span class="w">
          </span><span class="n">simulate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">SIGUSR1</span><span class="w"> </span><span class="n">restart</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">resets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w">

          </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">designed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">operate</span><span class="w"> </span><span class="n">optimally</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="nc">UDP</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">capability</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">situations</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">comparison</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">UDP</span><span class="p">,</span><span class="w"> </span><span class="nc">TCP</span><span class="w">
          </span><span class="n">will</span><span class="w"> </span><span class="n">usually</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">somewhat</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">efficient</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">robust</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">unreliable</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">congested</span><span class="w"> </span><span class="n">networks</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">article</span><span class="w"> </span><span class="n">outlines</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">problems</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">tunneling</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="ss">TCP</span><span class="p">:</span><span class="w"> </span><span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">sites</span><span class="o">.</span><span class="n">inka</span><span class="o">.</span><span class="n">de</span><span class="o">/</span><span class="n">sites</span><span class="o">/</span><span class="n">bigred</span><span class="o">/</span><span class="n">devel</span><span class="o">/</span><span class="n">tcp</span><span class="o">-</span><span class="n">tcp</span><span class="o">.</span><span class="n">html</span><span class="w">

          </span><span class="nc">There</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="n">cases</span><span class="p">,</span><span class="w"> </span><span class="n">however</span><span class="p">,</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">advantageous</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">robustness</span><span class="w"> </span><span class="n">perspective</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">tunneling</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">IP</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">applica</span><span class="err">‐</span><span class="w">
          </span><span class="n">tion</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">protocols</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">tunneling</span><span class="w"> </span><span class="n">protocols</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">don</span><span class="sc">&#39;t possess a built-in reliability layer.

   --port port
          TCP/UDP  port  number or port name for both local and remote (sets both --lport and --rport options to given port). The current default of 1194 repre‐
          sents the official IANA port number assignment for OpenVPN and has been used since version 2.0-beta17. Previous versions used port  5000  as  the  de‐
          fault.

   --rport port
          Set TCP/UDP port number or name used by the --remote option. The port can also be set directly using the --remote option.

   --replay-window args
          Modify the replay protection sliding-window size and time window.

          Valid syntax:

             replay-window n [t]

          Use a replay protection sliding-window of size n and a time window of t seconds.

          By default n is 64 (the IPSec default) and t is 15 seconds.

          This option is only relevant in UDP mode, i.e. when either --proto udp is specified, or no --proto option is specified.

          When  OpenVPN  tunnels  IP  packets  over UDP, there is the possibility that packets might be dropped or delivered out of order. Because OpenVPN, like
          IPSec, is emulating the physical network layer, it will accept an out-of-order packet sequence, and will deliver such packets in the same  order  they
          were received to the TCP/IP protocol stack, provided they satisfy several constraints.

          a. The packet cannot be a replay (unless --no-replay is specified, which disables replay protection altogether).

          b. If  a  packet arrives out of order, it will only be accepted if the difference between its sequence number and the highest sequence number received
             so far is less than n.

          c. If a packet arrives out of order, it will only be accepted if it arrives no later than t seconds after any packet containing a higher sequence num‐
             ber.

          If  you are using a network link with a large pipeline (meaning that the product of bandwidth and latency is high), you may want to use a larger value
          for n. Satellite links in particular often require this.

          If you run OpenVPN at --verb 4, you will see the message &quot;Replay-window backtrack occurred [x]&quot; every time the maximum sequence number backtrack  seen
          thus far increases. This can be used to calibrate n.

          There is some controversy on the appropriate method of handling packet reordering at the security layer.

          Namely,  to  what  extent should the security layer protect the encapsulated protocol from attacks which masquerade as the kinds of normal packet loss
          and reordering that occur over IP networks?

          The IPSec and OpenVPN approach is to allow packet reordering within a certain fixed sequence number window.

          OpenVPN adds to the IPSec model by limiting the window size in time as well as sequence space.

          OpenVPN also adds TCP transport as an option (not offered by IPSec) in which case OpenVPN can adopt a very strict attitude  towards  message  deletion
          and reordering: Don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="w"> </span><span class="nc">Since</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">guarantees</span><span class="w"> </span><span class="n">reliability</span><span class="p">,</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">loss</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">reordering</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">assumed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">attack</span><span class="o">.</span><span class="w">

          </span><span class="nc">In</span><span class="w">  </span><span class="n">this</span><span class="w"> </span><span class="n">sense</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">argued</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">transport</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">preferred</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">tunneling</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">IP</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">protocols</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">vulnerable</span><span class="w">
          </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">deletion</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">reordering</span><span class="w"> </span><span class="n">attack</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">falls</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">operational</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">networks</span><span class="o">.</span><span class="w">

          </span><span class="nc">So</span><span class="w"> </span><span class="nc">I</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">statement</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">IP</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="nc">UDP</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">vulnerable</span><span class="w">
          </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">deletion</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">reordering</span><span class="w"> </span><span class="n">attack</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">falls</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">physical</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">layer</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w">
          </span><span class="n">problem</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">easily</span><span class="w"> </span><span class="n">fixed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">simply</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">transport</span><span class="w"> </span><span class="n">layer</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">replay</span><span class="o">-</span><span class="n">persist</span><span class="w"> </span><span class="n">file</span><span class="w">
          </span><span class="nc">Persist</span><span class="w"> </span><span class="n">replay</span><span class="o">-</span><span class="n">protection</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="n">sessions</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">save</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reload</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">state</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">strengthen</span><span class="w"> </span><span class="n">protection</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">replay</span><span class="w"> </span><span class="n">attacks</span><span class="p">,</span><span class="w"> </span><span class="n">especially</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="p" data-group-id="8865608190-8">(</span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">inetd</span><span class="p" data-group-id="8865608190-8">)</span><span class="w">  </span><span class="ow">when</span><span class="w">
          </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">sessions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">frequently</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">stopped</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w">  </span><span class="n">option</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">disk</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">replay</span><span class="w"> </span><span class="n">protection</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="p" data-group-id="8865608190-9">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">timestamp</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w">
          </span><span class="n">remote</span><span class="w"> </span><span class="n">peer</span><span class="p" data-group-id="8865608190-9">)</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">stopped</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">restarted</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">replays</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">by</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">prior</span><span class="w">
          </span><span class="n">session</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w">  </span><span class="n">option</span><span class="w">  </span><span class="n">only</span><span class="w">  </span><span class="n">makes</span><span class="w"> </span><span class="n">sense</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">replay</span><span class="w"> </span><span class="n">protection</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="p" data-group-id="8865608190-10">(</span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="p" data-group-id="8865608190-10">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="o">--</span><span class="n">secret</span><span class="w"> </span><span class="p" data-group-id="8865608190-11">(</span><span class="n">shared</span><span class="o">-</span><span class="n">secret</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">mode</span><span class="p" data-group-id="8865608190-11">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">mode</span><span class="w">
          </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">socket</span><span class="o">-</span><span class="n">flags</span><span class="w"> </span><span class="n">flags</span><span class="w">
          </span><span class="nc">Apply</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">transport</span><span class="w"> </span><span class="n">socket</span><span class="o">.</span><span class="w"> </span><span class="nc">Currently</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="nc">TCP_NODELAY</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">supported</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="nc">TCP_NODELAY</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">causes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">trying</span><span class="w">  </span><span class="n">to</span><span class="w">
          </span><span class="n">group</span><span class="w"> </span><span class="n">several</span><span class="w"> </span><span class="n">smaller</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">larger</span><span class="w"> </span><span class="n">packet</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">considerably</span><span class="w"> </span><span class="n">improvement</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">latency</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">pushable</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">effect</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tcp</span><span class="o">-</span><span class="n">nodelay</span><span class="w">
          </span><span class="nc">This</span><span class="w">  </span><span class="n">macro</span><span class="w">  </span><span class="n">sets</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP_NODELAY</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">pushes</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">clients</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="nc">TCP_NODELAY</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">disables</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Nagle</span><span class="w"> </span><span class="n">algo</span><span class="err">‐</span><span class="w">
          </span><span class="n">rithm</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">sockets</span><span class="w"> </span><span class="n">causing</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">transmitted</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="n">latency</span><span class="p">,</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">waiting</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">short</span><span class="w"> </span><span class="n">period</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w">  </span><span class="n">aggregate</span><span class="w">
          </span><span class="n">several</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">larger</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">packet</span><span class="o">.</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">applications</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="nc">TCP</span><span class="p">,</span><span class="w"> </span><span class="nc">TCP_NODELAY</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">generally</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">good</span><span class="w"> </span><span class="n">latency</span><span class="w"> </span><span class="n">optimization</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">macro</span><span class="w"> </span><span class="n">expands</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

             </span><span class="k">if</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="ss">server</span><span class="p">:</span><span class="w">
                 </span><span class="n">socket</span><span class="o">-</span><span class="n">flags</span><span class="w"> </span><span class="nc">TCP_NODELAY</span><span class="w">
                 </span><span class="n">push</span><span class="w"> </span><span class="s">&quot;socket-flags TCP_NODELAY&quot;</span></code></pre><p>   Virtual Network Adapter (VPN interface)</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Options</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">relates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">tun</span><span class="o">/</span><span class="n">tap</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">interface</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">routing</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">bind</span><span class="o">-</span><span class="n">dev</span><span class="w"> </span><span class="n">device</span><span class="w">
          </span><span class="p" data-group-id="1883174061-1">(</span><span class="nc">Linux</span><span class="w"> </span><span class="n">only</span><span class="p" data-group-id="1883174061-1">)</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">Virtual</span><span class="w"> </span><span class="nc">Routing</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Forwarding</span><span class="w"> </span><span class="n">device</span><span class="w">

   </span><span class="o">--</span><span class="n">block</span><span class="o">-</span><span class="n">ipv6</span><span class="w">
          </span><span class="nc">On</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">sending</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">tunnel</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">answered</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">ICMPv6</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">message</span><span class="o">.</span><span class="w"> </span><span class="nc">On</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="p">,</span><span class="w">
          </span><span class="n">all</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">answered</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">ICMPv6</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">message</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">intended</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">cases</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">blocked</span><span class="w"> </span><span class="ow">and</span><span class="w">
          </span><span class="n">other</span><span class="w">  </span><span class="n">options</span><span class="w">  </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">available</span><span class="o">.</span><span class="w"> </span><span class="o">--</span><span class="n">block</span><span class="o">-</span><span class="n">ipv6</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">ICMPv6</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="mi">7</span><span class="w"> </span><span class="n">as</span><span class="w">
          </span><span class="n">source</span><span class="w"> </span><span class="n">address</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">sense</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">actually</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">IPv6</span><span class="w">  </span><span class="n">traffic</span><span class="w">
          </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">host</span><span class="p">,</span><span class="w"> </span><span class="n">effectively</span><span class="w"> </span><span class="n">blocking</span><span class="w"> </span><span class="nc">IPv6</span><span class="o">.</span><span class="w">

          </span><span class="nc">Client</span><span class="w"> </span><span class="n">config</span><span class="w">

                    </span><span class="o">--</span><span class="n">ifconfig</span><span class="o">-</span><span class="n">ipv6</span><span class="w"> </span><span class="n">fd15</span><span class="p">:</span><span class="mi">53</span><span class="n">b6</span><span class="ss">:dead</span><span class="o">::</span><span class="mi">2</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="n">fd15</span><span class="p">:</span><span class="mi">53</span><span class="n">b6</span><span class="ss">:dead</span><span class="o">::</span><span class="mi">1</span><span class="w">
                    </span><span class="o">--</span><span class="n">redirect</span><span class="o">-</span><span class="n">gateway</span><span class="w"> </span><span class="n">ipv6</span><span class="w">
                    </span><span class="o">--</span><span class="n">block</span><span class="o">-</span><span class="n">ipv6</span><span class="w">

          </span><span class="nc">Server</span><span class="w"> </span><span class="n">config</span><span class="w">
                 </span><span class="nc">Push</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="s">&quot;valid&quot;</span><span class="w"> </span><span class="n">ipv6</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w">

                    </span><span class="o">--</span><span class="n">push</span><span class="w"> </span><span class="s">&quot;ifconfig-ipv6 fd15:53b6:dead::2/64 fd15:53b6:dead::1&quot;</span><span class="w">
                    </span><span class="o">--</span><span class="n">push</span><span class="w"> </span><span class="s">&quot;redirect-gateway ipv6&quot;</span><span class="w">
                    </span><span class="o">--</span><span class="n">block</span><span class="o">-</span><span class="n">ipv6</span><span class="w">

   </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">device</span><span class="w">
          </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">tunX</span><span class="p">,</span><span class="w"> </span><span class="n">tapX</span><span class="p">,</span><span class="w"> </span><span class="n">null</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">arbitrary</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="p" data-group-id="1883174061-2">(</span><span class="nc">X</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">omitted</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="p" data-group-id="1883174061-2">)</span><span class="w">

          </span><span class="nc">See</span><span class="w"> </span><span class="n">examples</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">TUN</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w">

          </span><span class="nc">You</span><span class="w">  </span><span class="n">must</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">ends</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">tap</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">ends</span><span class="o">.</span><span class="w"> </span><span class="nc">You</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">mix</span><span class="w"> </span><span class="n">them</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">represent</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">underly</span><span class="err">‐</span><span class="w">
          </span><span class="n">ing</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="ss">layers</span><span class="p">:</span><span class="w">

          </span><span class="n">tun</span><span class="w">    </span><span class="n">devices</span><span class="w"> </span><span class="n">encapsulate</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="p" data-group-id="1883174061-3">(</span><span class="nc">OSI</span><span class="w"> </span><span class="nc">Layer</span><span class="w"> </span><span class="mi">3</span><span class="p" data-group-id="1883174061-3">)</span><span class="w">

          </span><span class="n">tap</span><span class="w">    </span><span class="n">devices</span><span class="w"> </span><span class="n">encapsulate</span><span class="w"> </span><span class="nc">Ethernet</span><span class="w"> </span><span class="mf">802.3</span><span class="w"> </span><span class="p" data-group-id="1883174061-4">(</span><span class="nc">OSI</span><span class="w"> </span><span class="nc">Layer</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="1883174061-4">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">dev</span><span class="w"> </span><span class="n">tun2</span><span class="w">
             </span><span class="n">dev</span><span class="w"> </span><span class="n">tap4</span><span class="w">
             </span><span class="n">dev</span><span class="w"> </span><span class="n">ovpn</span><span class="w">

          </span><span class="nc">When</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">starts</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">tap</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">extracted</span><span class="w"> </span><span class="n">automatically</span><span class="o">.</span><span class="w">  </span><span class="nc">Otherwise</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="o">-</span><span class="n">type</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">dev</span><span class="o">-</span><span class="n">node</span><span class="w"> </span><span class="n">node</span><span class="w">
          </span><span class="nc">Explicitly</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">net</span><span class="o">/</span><span class="n">tun</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">tun</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">tap</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">figure</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">TUN</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">TAP</span><span class="w">  </span><span class="n">de</span><span class="err">‐</span><span class="w">
          </span><span class="n">vice</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="o">-</span><span class="n">type</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="o">-</span><span class="n">type</span><span class="w"> </span><span class="n">tap</span><span class="o">.</span><span class="w">

          </span><span class="nc">Under</span><span class="w">  </span><span class="nc">Mac</span><span class="w">  </span><span class="nc">OS</span><span class="w"> </span><span class="nc">X</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">implementation</span><span class="o">.</span><span class="w"> </span><span class="nc">Using</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="o">-</span><span class="n">node</span><span class="w"> </span><span class="n">utun</span><span class="w"> </span><span class="n">forces</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">native</span><span class="w"> </span><span class="nc">Darwin</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">kernel</span><span class="w">
          </span><span class="n">support</span><span class="o">.</span><span class="w"> </span><span class="nc">Use</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="o">-</span><span class="n">node</span><span class="w"> </span><span class="n">utunN</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">utun</span><span class="w"> </span><span class="n">instance</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tun</span><span class="o">.</span><span class="n">kext</span><span class="w"> </span><span class="p" data-group-id="1883174061-5">(</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">tunX</span><span class="p" data-group-id="1883174061-5">)</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="o">-</span><span class="n">node</span><span class="w"> </span><span class="n">tun</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w">  </span><span class="ow">not</span><span class="w">  </span><span class="n">specifying</span><span class="w">  </span><span class="n">a</span><span class="w">
          </span><span class="o">--</span><span class="n">dev</span><span class="o">-</span><span class="n">node</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">openvpn</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="n">utun</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">fall</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">tun</span><span class="o">.</span><span class="n">kext</span><span class="o">.</span><span class="w">

          </span><span class="nc">On</span><span class="w">  </span><span class="nc">Windows</span><span class="w"> </span><span class="n">systems</span><span class="p">,</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Network</span><span class="w"> </span><span class="nc">Connections</span><span class="w"> </span><span class="nc">Control</span><span class="w"> </span><span class="nc">Panel</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="nc">GUID</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">enclosed</span><span class="w">
          </span><span class="n">by</span><span class="w"> </span><span class="n">braces</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">adapters</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">enumerate</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapters</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">con</span><span class="err">‐</span><span class="w">
          </span><span class="n">nections</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">panel</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">GUID</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">dev</span><span class="o">-</span><span class="n">type</span><span class="w"> </span><span class="n">device</span><span class="o">-</span><span class="n">type</span><span class="w">
          </span><span class="nc">Which</span><span class="w">  </span><span class="n">device</span><span class="w">  </span><span class="n">type</span><span class="w">  </span><span class="n">are</span><span class="w">  </span><span class="n">we</span><span class="w"> </span><span class="n">using?</span><span class="w"> </span><span class="n">device</span><span class="o">-</span><span class="n">type</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="p" data-group-id="1883174061-6">(</span><span class="nc">OSI</span><span class="w"> </span><span class="nc">Layer</span><span class="w"> </span><span class="mi">3</span><span class="p" data-group-id="1883174061-6">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">tap</span><span class="w"> </span><span class="p" data-group-id="1883174061-7">(</span><span class="nc">OSI</span><span class="w"> </span><span class="nc">Layer</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="1883174061-7">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w">
          </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">begin</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">tap</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">dhcp</span><span class="o">-</span><span class="n">option</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">platforms</span><span class="o">.</span><span class="w"> </span><span class="nc">May</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="o">.</span><span class="w"> </span><span class="nc">On</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">are</span><span class="w">  </span><span class="n">han</span><span class="err">‐</span><span class="w">
          </span><span class="n">dled</span><span class="w">  </span><span class="n">by</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">tap</span><span class="o">-</span><span class="n">windows6</span><span class="w"> </span><span class="n">driver</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">directly</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">dhcp</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">disabled</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">wintun</span><span class="w"> </span><span class="n">driver</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="kn">use</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">Android</span><span class="w"> </span><span class="n">client</span><span class="w">
          </span><span class="n">also</span><span class="w"> </span><span class="n">handles</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">internally</span><span class="o">.</span><span class="w">

          </span><span class="nc">On</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">platforms</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="sc">&#39;s environment under the name foreign_options_{n} before the --up script is called. A
          plugin  or  an --up script must be used to pick up and interpret these as required. Many Linux distributions include such scripts and some third-party
          user interfaces such as tunnelblick also come with scripts that process these options.

          Valid syntax:

             dhcp-options type [parm]

          DOMAIN name
                 Set Connection-specific DNS Suffix to name.

          ADAPTER_DOMAIN_SUFFIX name
                 Alias to DOMAIN. This is a compatibility option, it should not be used in new deployments.

          DOMAIN-SEARCH name
                 Add name to the domain search list.  Repeat this option to add more entries. Up to 10 domains are supported.

          DNS address
                 Set primary domain name server IPv4 or IPv6 address.  Repeat this option to set secondary DNS server addresses.

                 Note: DNS IPv6 servers are currently set using netsh (the existing DHCP code can only do IPv4 DHCP, and that protocol  only  permits  IPv4  ad‐
                 dresses anywhere). The option will be put into the environment, so an --up script could act upon it if needed.

          WINS address
                 Set primary WINS server address (NetBIOS over TCP/IP Name Server).  Repeat this option to set secondary WINS server addresses.

          NBDD address
                 Set primary NBDD server address (NetBIOS over TCP/IP Datagram Distribution Server). Repeat this option to set secondary NBDD server addresses.

          NTP address
                 Set primary NTP server address (Network Time Protocol).  Repeat this option to set secondary NTP server addresses.

          NBT type
                 Set NetBIOS over TCP/IP Node type. Possible options:

                 1      b-node (broadcasts)

                 2      p-node (point-to-point name queries to a WINS server)

                 4      m-node (broadcast then query name server)

                 8      h-node (query name server, then broadcast).

          NBS scope-id
                 Set  NetBIOS  over  TCP/IP Scope. A NetBIOS Scope ID provides an extended naming service for the NetBIOS over TCP/IP (Known as NBT) module. The
                 primary purpose of a NetBIOS scope ID is to isolate NetBIOS traffic on a single network to only those nodes with the same NetBIOS scope ID. The
                 NetBIOS  scope  ID  is  a character string that is appended to the NetBIOS name. The NetBIOS scope ID on two hosts must match, or the two hosts
                 will not be able to communicate.  The NetBIOS Scope ID also allows computers to use the same computer name, as they have different  scope  IDs.
                 The Scope ID becomes a part of the NetBIOS name, making the name unique. (This description of NetBIOS scopes courtesy of NeonSurge@abyss.com)

          DISABLE-NBT
                 Disable Netbios-over-TCP/IP.

   --ifconfig args
          Set  TUN/TAP  adapter parameters. It requires the IP address of the local VPN endpoint. For TUN devices in point-to-point mode, the next argument must
          be the VPN IP address of the remote VPN endpoint. For TAP devices, or TUN devices used with --topology subnet, the second argument is the subnet  mask
          of the virtual network segment which is being created or connected to.

          For TUN devices, which facilitate virtual point-to-point IP connections (when used in --topology net30 or p2p mode), the proper usage of --ifconfig is
          to use two private IP addresses which are not a member of any existing subnet which is in use. The IP addresses may be  consecutive  and  should  have
          their order reversed on the remote peer.  After the VPN is established, by pinging rn, you will be pinging across the VPN.

          For TAP devices, which provide the ability to create virtual ethernet segments, or TUN devices in --topology subnet mode (which create virtual &quot;multi‐
          point networks&quot;), --ifconfig is used to set an IP address and subnet mask just as a physical ethernet adapter would be similarly  configured.  If  you
          are  attempting to connect to a remote ethernet bridge, the IP address and subnet should be set to values which would be valid on the the bridged eth‐
          ernet segment (note also that DHCP can be used for the same purpose).

          This option, while primarily a proxy for the ifconfig(8) command, is designed to simplify TUN/TAP tunnel configuration by providing a standard  inter‐
          face to the different ifconfig implementations on different platforms.

          --ifconfig parameters which are IP addresses can also be specified as a DNS or /etc/hosts file resolvable name.

          For TAP devices, --ifconfig should not be used if the TAP interface will be getting an IP address lease from a DHCP server.

          Examples:

             # tun device in net30/p2p mode
             ifconfig 10.8.0.2 10.8.0.1

             # tun/tap device in subnet mode
             ifconfig 10.8.0.2 255.255.255.0

   --ifconfig-ipv6 args
          Configure an IPv6 address on the tun device.

          Valid syntax:

             ifconfig-ipv6 ipv6addr/bits [ipv6remote]

          The ipv6addr/bits argument is the IPv6 address to use. The second parameter is used as route target for --route-ipv6 if no gateway is specified.

          The --topology option has no influence with --ifconfig-ipv6

   --ifconfig-noexec
          Don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">actually</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">ifconfig</span><span class="o">/</span><span class="n">netsh</span><span class="w"> </span><span class="n">commands</span><span class="p">,</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">environmental</span><span class="w"> </span><span class="n">variables</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">ifconfig</span><span class="o">-</span><span class="n">nowarn</span><span class="w">
          </span><span class="nc">Don</span><span class="sc">&#39;t output an options consistency check warning if the --ifconfig option on this side of the connection doesn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">side</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="kn">use</span><span class="err">‐</span><span class="w">
          </span><span class="n">ful</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">retain</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">overall</span><span class="w"> </span><span class="n">benefits</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">consistency</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="p" data-group-id="1883174061-8">(</span><span class="n">also</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="o">--</span><span class="n">disable</span><span class="o">-</span><span class="n">occ</span><span class="w"> </span><span class="n">option</span><span class="p" data-group-id="1883174061-8">)</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">only</span><span class="w">  </span><span class="n">disabling</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">ifconfig</span><span class="w">
          </span><span class="n">component</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">check</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="p">,</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="o">-</span><span class="n">nowarn</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">host</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w">  </span><span class="n">option</span><span class="w">  </span><span class="n">will</span><span class="w">  </span><span class="n">also</span><span class="w"> </span><span class="n">silence</span><span class="w"> </span><span class="n">warnings</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">potential</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">conflicts</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">occasionally</span><span class="w"> </span><span class="n">annoy</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">experienced</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">triggering</span><span class="w"> </span><span class="s">&quot;false posi‐
          tive&quot;</span><span class="w"> </span><span class="n">warnings</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">lladdr</span><span class="w"> </span><span class="n">address</span><span class="w">
          </span><span class="nc">Specify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">layer</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">commonly</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MAC</span><span class="w"> </span><span class="n">address</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">TAP</span><span class="w"> </span><span class="n">devices</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">persist</span><span class="o">-</span><span class="n">tun</span><span class="w">
          </span><span class="nc">Don</span><span class="sc">&#39;t close and reopen TUN/TAP device or run up/down scripts across SIGUSR1 or --ping-restart restarts.

          SIGUSR1 is a restart signal similar to SIGHUP, but which offers finer-grained control over reset options.

   --redirect-gateway flags
          Automatically execute routing commands to cause all outgoing IP traffic to be redirected over the VPN. This is a client-side option.

          This option performs three steps:

          1. Create a static route for the --remote address which forwards to the pre-existing default gateway. This is done so that (3) will not create a rout‐
             ing loop.

          2. Delete the default gateway route.

          3. Set  the  new  default gateway to be the VPN endpoint address (derived either from --route-gateway or the second parameter to --ifconfig when --dev
             tun is specified).

          When the tunnel is torn down, all of the above steps are reversed so that the original default route is restored.

          Option flags:

          local  Add the local flag if both OpenVPN peers are directly connected via a common subnet, such as with wireless. The local flag will cause step  (1)
                 above to be omitted.

          autolocal
                 Try to automatically determine whether to enable local flag above.

          def1   Use  this flag to override the default gateway by using 0.0.0.0/1 and 128.0.0.0/1 rather than 0.0.0.0/0. This has the benefit of overriding but
                 not wiping out the original default gateway.

          bypass-dhcp
                 Add a direct route to the DHCP server (if it is non-local) which bypasses the tunnel (Available on Windows clients, may  not  be  available  on
                 non-Windows clients).

          bypass-dns
                 Add  a  direct route to the DNS server(s) (if they are non-local) which bypasses the tunnel (Available on Windows clients, may not be available
                 on non-Windows clients).

          block-local
                 Block access to local LAN when the tunnel is active, except for the LAN gateway itself. This is accomplished by routing the local  LAN  (except
                 for the LAN gateway address) into the tunnel.

          ipv6   Redirect  IPv6 routing into the tunnel. This works similar to the def1 flag, that is, more specific IPv6 routes are added (2000::/4, 3000::/4),
                 covering the whole IPv6 unicast space.

          !ipv4  Do not redirect IPv4 traffic - typically used in the flag pair ipv6 !ipv4 to redirect IPv6-only.

   --redirect-private flags
          Like --redirect-gateway, but omit actually changing the default gateway.  Useful when pushing private subnets.

   --route args
          Add route to routing table after connection is established. Multiple routes can be specified. Routes will be automatically torn down in reverse  order
          prior to TUN/TAP device close.

          Valid syntaxes:

             route network/IP
             route network/IP netmask
             route network/IP netmask gateway
             route network/IP netmask gateway metric

          This  option  is  intended as a convenience proxy for the route(8) shell command, while at the same time providing portable semantics across OpenVPN&#39;</span><span class="n">s</span><span class="w">
          </span><span class="n">platform</span><span class="w"> </span><span class="n">space</span><span class="o">.</span><span class="w">

          </span><span class="n">netmask</span><span class="w">
                 </span><span class="n">defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.255</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">given</span><span class="w">

          </span><span class="n">gateway</span><span class="w">
                 </span><span class="n">default</span><span class="w"> </span><span class="n">taken</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">gateway</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="o">.</span><span class="w">

          </span><span class="n">metric</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">taken</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">metric</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">leaving</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">blank</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">default</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">DNS</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">resolvable</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">three</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="ss">keywords</span><span class="p">:</span><span class="w">

          </span><span class="n">vpn_gateway</span><span class="w">
                 </span><span class="nc">The</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">endpoint</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="p" data-group-id="1883174061-9">(</span><span class="n">derived</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">gateway</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p" data-group-id="1883174061-9">)</span><span class="o">.</span><span class="w">

          </span><span class="n">net_gateway</span><span class="w">
                 </span><span class="nc">The</span><span class="w"> </span><span class="n">pre</span><span class="o">-</span><span class="n">existing</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">gateway</span><span class="p">,</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="p" data-group-id="1883174061-10">(</span><span class="ow">not</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">OSes</span><span class="p" data-group-id="1883174061-10">)</span><span class="o">.</span><span class="w">

          </span><span class="n">remote_host</span><span class="w">
                 </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">undefined</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">delay</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">route</span><span class="o">-</span><span class="n">delay</span><span class="w">
             </span><span class="n">route</span><span class="o">-</span><span class="n">delay</span><span class="w"> </span><span class="n">n</span><span class="w">
             </span><span class="n">route</span><span class="o">-</span><span class="n">delay</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">m</span><span class="w">

          </span><span class="nc">Delay</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="p" data-group-id="1883174061-11">(</span><span class="n">default</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1883174061-11">)</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">establishment</span><span class="p">,</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="n">routes</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="n">upon</span><span class="w">  </span><span class="n">connection</span><span class="w">  </span><span class="n">estab</span><span class="err">‐</span><span class="w">
          </span><span class="n">lishment</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w">  </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">delay</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">omitted</span><span class="p">,</span><span class="w">  </span><span class="n">routes</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="p">,</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="o">--</span><span class="n">user</span><span class="w"> </span><span class="ow">or</span><span class="w">
          </span><span class="o">--</span><span class="n">group</span><span class="w"> </span><span class="n">privilege</span><span class="w"> </span><span class="n">downgrade</span><span class="w"> </span><span class="p" data-group-id="1883174061-12">(</span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">chroot</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="p" data-group-id="1883174061-12">)</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">designed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">scenarios</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">tap</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">addresses</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">delay</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">give</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">handshake</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">com</span><span class="err">‐</span><span class="w">
          </span><span class="n">plete</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">added</span><span class="o">.</span><span class="w">

          </span><span class="nc">On</span><span class="w"> </span><span class="nc">Windows</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">delay</span><span class="w"> </span><span class="n">tries</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">intelligent</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">waiting</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="p" data-group-id="1883174061-13">(</span><span class="n">default</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="p" data-group-id="1883174061-13">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">come</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">adding</span><span class="w">
          </span><span class="n">routes</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">ipv6</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Setup</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="sc">&#39;s tun.

          Valid syntax:

             route-ipv6 ipv6addr/bits [gateway] [metric]

          The gateway parameter is only used for IPv6 routes across tap devices, and if missing, the ipv6remote field from --ifconfig-ipv6 or --route-ipv6-gate‐
          way is used.

   --route-gateway arg
          Specify a default gateway for use with --route.

          If dhcp is specified as the parameter, the gateway address will be extracted from a DHCP negotiation with the OpenVPN server-side LAN.

          Valid syntaxes:

             route-gateway gateway
             route-gateway dhcp

   --route-ipv6-gateway gw
          Specify a default gateway gw for use with --route-ipv6.

   --route-metric m
          Specify a default metric m for use with --route.

   --route-noexec
          Don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">automatically</span><span class="o">.</span><span class="w"> </span><span class="nc">Instead</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">environmental</span><span class="w"> </span><span class="n">variables</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">nopull</span><span class="w">
          </span><span class="nc">When</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">pull</span><span class="p">,</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="nc">EXCEPT</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">routes</span><span class="p">,</span><span class="w"> </span><span class="n">block</span><span class="o">-</span><span class="n">outside</span><span class="o">-</span><span class="n">dns</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">dhcp</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="nc">DNS</span><span class="w"> </span><span class="n">servers</span><span class="o">.</span><span class="w">

          </span><span class="nc">When</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">effectively</span><span class="w"> </span><span class="n">bars</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="sc">&#39;s routing table, however note that this option still
          allows the server to set the TCP/IP properties of the client&#39;</span><span class="n">s</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">topology</span><span class="w"> </span><span class="n">mode</span><span class="w">
          </span><span class="nc">Configure</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">addressing</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">meaning</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tap</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w">  </span><span class="n">which</span><span class="w">  </span><span class="n">always</span><span class="w">  </span><span class="n">uses</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">subnet</span><span class="w">
          </span><span class="n">topology</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w">  </span><span class="n">you</span><span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">server</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">server</span><span class="o">-</span><span class="n">bridge</span><span class="w"> </span><span class="n">directives</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">chosen</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">clients</span><span class="w">
          </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">manually</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">clients</span><span class="o">.</span><span class="w"> </span><span class="nc">Like</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">directive</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">compatible</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">client</span><span class="w">  </span><span class="ow">and</span><span class="w">
          </span><span class="n">server</span><span class="o">.</span><span class="w">

          </span><span class="n">mode</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ss">of</span><span class="p">:</span><span class="w">

          </span><span class="n">net30</span><span class="w">  </span><span class="nc">Use</span><span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="n">point</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">point</span><span class="w"> </span><span class="n">topology</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">allocating</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="mi">30</span><span class="w"> </span><span class="n">subnet</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">designed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">point</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">point</span><span class="w"> </span><span class="n">semantics</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w">
                 </span><span class="n">the</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">systems</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.0</span><span class="o">.</span><span class="w">

          </span><span class="n">p2p</span><span class="w">    </span><span class="nc">Use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">point</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">point</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">endpoint</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="sc">&#39;s tun interface always points to the local endpoint of the  server&#39;</span><span class="n">s</span><span class="w">  </span><span class="n">tun</span><span class="w">
                 </span><span class="n">interface</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">allocates</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w"> </span><span class="nc">Only</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">none</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">systems</span><span class="o">.</span><span class="w">

          </span><span class="n">subnet</span><span class="w"> </span><span class="nc">Use</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">subnet</span><span class="w">  </span><span class="n">rather</span><span class="w">  </span><span class="n">than</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">point</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">point</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">configuring</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">subnet</span><span class="w"> </span><span class="n">mask</span><span class="p">,</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w">
                 </span><span class="n">topology</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tap</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ethernet</span><span class="w"> </span><span class="n">bridging</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">allocates</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">works</span><span class="w">  </span><span class="n">on</span><span class="w">  </span><span class="nc">Windows</span><span class="w">  </span><span class="n">as</span><span class="w">
                 </span><span class="n">well</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w">  </span><span class="n">available</span><span class="w">  </span><span class="ow">when</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.1</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">higher</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.0</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">manually</span><span class="w"> </span><span class="n">patched</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">topology</span><span class="w">
                 </span><span class="n">directive</span><span class="w"> </span><span class="n">code</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Windows</span><span class="p">,</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">8.2</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">driver</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="o">*</span><span class="n">nix</span><span class="p">,</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">tun</span><span class="w">  </span><span class="n">driver</span><span class="w">
                 </span><span class="n">supports</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">ifconfig</span><span class="p" data-group-id="1883174061-14">(</span><span class="mi">8</span><span class="p" data-group-id="1883174061-14">)</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">sets</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subnet</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">endpoint</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="o">.</span><span class="w">

          </span><span class="ss">Note</span><span class="p">:</span><span class="w"> </span><span class="nc">Using</span><span class="w"> </span><span class="o">--</span><span class="n">topology</span><span class="w"> </span><span class="n">subnet</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interpretation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="s">&quot;address netmask&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="s">&quot;local remote&quot;</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tun</span><span class="o">-</span><span class="n">mtu</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Take</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="nc">TUN</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="nc">MTU</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">derive</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="nc">MTU</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="p" data-group-id="1883174061-15">(</span><span class="n">default</span><span class="w"> </span><span class="mi">1500</span><span class="p" data-group-id="1883174061-15">)</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">cases</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">probably</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w">
          </span><span class="n">its</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">value</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="nc">MTU</span><span class="w"> </span><span class="p" data-group-id="1883174061-16">(</span><span class="nc">Maximum</span><span class="w"> </span><span class="nc">Transmission</span><span class="w"> </span><span class="nc">Units</span><span class="p" data-group-id="1883174061-16">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">datagram</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">unfragmented</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="w">  </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="n">re</span><span class="err">‐</span><span class="w">
          </span><span class="n">quires</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">channels</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">unfragmented</span><span class="o">.</span><span class="w">

          </span><span class="nc">MTU</span><span class="w"> </span><span class="n">problems</span><span class="w"> </span><span class="n">often</span><span class="w"> </span><span class="n">manifest</span><span class="w"> </span><span class="n">themselves</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">hang</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">periods</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">usage</span><span class="o">.</span><span class="w">

          </span><span class="nc">It</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">best</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">fragment</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">mssfix</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">deal</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">MTU</span><span class="w"> </span><span class="n">sizing</span><span class="w"> </span><span class="n">issues</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tun</span><span class="o">-</span><span class="n">mtu</span><span class="o">-</span><span class="n">extra</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Assume</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">tun</span><span class="o">-</span><span class="n">mtu</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">read</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">sufficient</span><span class="w">
          </span><span class="k">for</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="nc">TUN</span><span class="w"> </span><span class="n">devices</span><span class="o">.</span><span class="w"> </span><span class="nc">TAP</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">introduce</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">overhead</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">excess</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MTU</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="nc">TAP</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">are</span><span class="w">
          </span><span class="n">used</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">controls</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="n">sizing</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">transmission</span><span class="w"> </span><span class="n">overhead</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">larger</span><span class="w"> </span><span class="n">value</span><span class="o">.</span></code></pre><p>   TUN/TAP standalone operations</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">These</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">standalone</span><span class="w"> </span><span class="n">operations</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">require</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="o">--</span><span class="n">user</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">group</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">mktun</span><span class="w">
          </span><span class="p" data-group-id="7592068904-1">(</span><span class="nc">Standalone</span><span class="p" data-group-id="7592068904-1">)</span><span class="w"> </span><span class="nc">Create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">platforms</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">Linux</span><span class="o">.</span><span class="w"> </span><span class="nc">Normally</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">tunnels</span><span class="w"> </span><span class="n">exist</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">period</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">that</span><span class="w">
          </span><span class="n">an</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">open</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="n">advantage</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">driver</span><span class="sc">&#39;s ability to build persistent tunnels that live through  multiple  in‐
          stantiations of OpenVPN and die only when they are deleted or the machine is rebooted.

          One  of  the  advantages of persistent tunnels is that they eliminate the need for separate --up and --down scripts to run the appropriate ifconfig(8)
          and route(8) commands. These commands can be placed in the the same shell script which starts or terminates an OpenVPN session.

          Another advantage is that open connections through the TUN/TAP-based tunnel will not be reset if the OpenVPN peer restarts. This can be useful to pro‐
          vide uninterrupted connectivity through the tunnel in the event of a DHCP reset of the peer&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="p" data-group-id="7592068904-2">(</span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ipchange</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">above</span><span class="p" data-group-id="7592068904-2">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">One</span><span class="w"> </span><span class="n">disadvantage</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">tunnels</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">harder</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">configure</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="nc">MTU</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="p" data-group-id="7592068904-3">(</span><span class="n">see</span><span class="w"> </span><span class="o">--</span><span class="n">link</span><span class="o">-</span><span class="n">mtu</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">tun</span><span class="o">-</span><span class="n">mtu</span><span class="w"> </span><span class="n">above</span><span class="p" data-group-id="7592068904-3">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">On</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">platforms</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">Windows</span><span class="p">,</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">tunnels</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">rmtun</span><span class="w">
          </span><span class="p" data-group-id="7592068904-4">(</span><span class="nc">Standalone</span><span class="p" data-group-id="7592068904-4">)</span><span class="w"> </span><span class="nc">Remove</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">tunnel</span><span class="o">.</span></code></pre><p>   Virtual Routing and Forwarding</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Options</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">relates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">forwarding</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">combination</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">underlying</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">system</span><span class="o">.</span><span class="w">

   </span><span class="nc">As</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">today</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Linux</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">4.9</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">recommended</span><span class="o">.</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">come</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">handy</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">external</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">endpoints</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">regular</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">should</span><span class="w">
   </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">routed</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">tunnel</span><span class="p" data-group-id="2127244243-1">(</span><span class="n">s</span><span class="p" data-group-id="2127244243-1">)</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">achieved</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">VRF</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">configuring</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">connected</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">external</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w">  </span><span class="n">part</span><span class="w">
   </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VRF</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">examples</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cover</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">setup</span><span class="o">.</span><span class="w">

   </span><span class="nc">Another</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tun</span><span class="o">/</span><span class="n">tap</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">VRF</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">up</span><span class="o">-</span><span class="n">script</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">shown</span><span class="w"> </span><span class="n">below</span><span class="o">.</span></code></pre><p>   VRF setup with iproute2</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Create</span><span class="w"> </span><span class="nc">VRF</span><span class="w"> </span><span class="n">vrf_external</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="mi">1023</span><span class="w">

      </span><span class="n">ip</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">vrf_external</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">vrf</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="mi">1023</span><span class="w">

   </span><span class="nc">Move</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">vrf_external</span><span class="w">

      </span><span class="n">ip</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">master</span><span class="w"> </span><span class="n">vrf_external</span><span class="w"> </span><span class="n">dev</span><span class="w"> </span><span class="n">eth0</span><span class="w">

   </span><span class="nc">Any</span><span class="w"> </span><span class="n">prefixes</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">moved</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">:code</span><span class="err">`</span><span class="n">main</span><span class="err">`</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="mi">1023</span></code></pre><p>   VRF setup with ifupdown</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">For</span><span class="w">  </span><span class="nc">Debian</span><span class="w">  </span><span class="n">based</span><span class="w"> </span><span class="nc">Distributions</span><span class="w"> </span><span class="n">ifupdown2</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">almost</span><span class="w"> </span><span class="n">drop</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">replacement</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">ifupdown</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="nc">VRFs</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">features</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="ow">in</span><span class="err">‐</span><span class="w">
   </span><span class="n">terface</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">VRF</span><span class="w"> </span><span class="n">code</span><span class="ss">:vrf_external</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="ss">this</span><span class="p">:</span><span class="w">

      </span><span class="n">auto</span><span class="w"> </span><span class="n">eth0</span><span class="w">
      </span><span class="n">iface</span><span class="w"> </span><span class="n">eth0</span><span class="w">
          </span><span class="n">address</span><span class="w"> </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.42</span><span class="o">/</span><span class="mi">24</span><span class="w">
          </span><span class="n">address</span><span class="w"> </span><span class="mi">2001</span><span class="ss">:db8</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">15</span><span class="o">::</span><span class="mi">42</span><span class="o">/</span><span class="mi">64</span><span class="w">
          </span><span class="n">gateway</span><span class="w"> </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.1</span><span class="w">
          </span><span class="n">gateway</span><span class="w"> </span><span class="mi">2001</span><span class="ss">:db8</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">15</span><span class="o">::</span><span class="mi">1</span><span class="w">
          </span><span class="n">vrf</span><span class="w"> </span><span class="n">vrf_external</span><span class="w">

      </span><span class="n">auto</span><span class="w"> </span><span class="n">vrf_external</span><span class="w">
      </span><span class="n">iface</span><span class="w"> </span><span class="n">vrf_external</span><span class="w">
          </span><span class="n">vrf</span><span class="o">-</span><span class="n">table</span><span class="w"> </span><span class="mi">1023</span></code></pre><p>   OpenVPN configuration</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="ss">line</span><span class="p">:</span><span class="w">

      </span><span class="n">bind</span><span class="o">-</span><span class="n">dev</span><span class="w"> </span><span class="n">vrf_external</span></code></pre><p>   Further reading</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Wikipedia</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">nice</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ss">VRFs</span><span class="p">:</span><span class="w"> </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">en</span><span class="o">.</span><span class="n">wikipedia</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">wiki</span><span class="o">/</span><span class="nc">Virtual_routing_and_forwarding</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">talk</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Network</span><span class="w"> </span><span class="nc">Track</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">FrOSCon</span><span class="w"> </span><span class="mi">2018</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">overview</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">advanced</span><span class="w"> </span><span class="n">layer</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">layer</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">Linux</span><span class="w">

      </span><span class="err">•</span><span class="w"> </span><span class="ss">Slides</span><span class="p">:</span><span class="w"> </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">www</span><span class="o">.</span><span class="n">slideshare</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="nc">BarbarossaTM</span><span class="o">/</span><span class="n">l2l3</span><span class="o">-</span><span class="n">fr</span><span class="o">-</span><span class="n">fortgeschrittene</span><span class="o">-</span><span class="n">helle</span><span class="o">-</span><span class="n">und</span><span class="o">-</span><span class="n">dunkle</span><span class="o">-</span><span class="n">magie</span><span class="o">-</span><span class="n">im</span><span class="o">-</span><span class="n">linuxnetzwerkstack</span><span class="w">

      </span><span class="err">•</span><span class="w"> </span><span class="nc">Video</span><span class="w"> </span><span class="p" data-group-id="7652520071-1">(</span><span class="n">german</span><span class="p" data-group-id="7652520071-1">)</span><span class="p">:</span><span class="w"> </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">media</span><span class="o">.</span><span class="n">ccc</span><span class="o">.</span><span class="n">de</span><span class="o">/</span><span class="n">v</span><span class="o">/</span><span class="n">froscon2018</span><span class="o">-</span><span class="mi">2247</span><span class="o">-</span><span class="n">l2_l3_fur_fortgeschrittene_</span><span class="o">-</span><span class="c">_helle_und_dunkle_magie_im_linux</span><span class="o">-</span><span class="n">netzwerkstack</span></code></pre><p>SCRIPTING INTEGRATION</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">external</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">various</span><span class="w"> </span><span class="n">phases</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">lifetime</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">process</span><span class="o">.</span></code></pre><p>   Script Order of Execution</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="mi">1</span><span class="o">.</span><span class="w">  </span><span class="o">--</span><span class="n">up</span><span class="w">

       </span><span class="nc">Executed</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">UDP</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">open</span><span class="o">.</span><span class="w">

   </span><span class="mi">2</span><span class="o">.</span><span class="w">  </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">verify</span><span class="w">

       </span><span class="nc">Executed</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">untrusted</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">peer</span><span class="o">.</span><span class="w">

   </span><span class="mi">3</span><span class="o">.</span><span class="w">  </span><span class="o">--</span><span class="n">ipchange</span><span class="w">

       </span><span class="nc">Executed</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">authentication</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">change</span><span class="o">.</span><span class="w">

   </span><span class="mi">4</span><span class="o">.</span><span class="w">  </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w">

       </span><span class="nc">Executed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">--</span><span class="n">mode</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">authentication</span><span class="o">.</span><span class="w">

   </span><span class="mi">5</span><span class="o">.</span><span class="w">  </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">up</span><span class="w">

       </span><span class="nc">Executed</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">authentication</span><span class="p">,</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="k">after</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">delay</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

   </span><span class="mi">6</span><span class="o">.</span><span class="w">  </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">pre</span><span class="o">-</span><span class="n">down</span><span class="w">

       </span><span class="nc">Executed</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">removed</span><span class="o">.</span><span class="w">

   </span><span class="mi">7</span><span class="o">.</span><span class="w">  </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">disconnect</span><span class="w">

       </span><span class="nc">Executed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">--</span><span class="n">mode</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="n">shutdown</span><span class="o">.</span><span class="w">

   </span><span class="mi">8</span><span class="o">.</span><span class="w">  </span><span class="o">--</span><span class="n">down</span><span class="w">

       </span><span class="nc">Executed</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">UDP</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">close</span><span class="o">.</span><span class="w">

   </span><span class="mi">9</span><span class="o">.</span><span class="w">  </span><span class="o">--</span><span class="n">learn</span><span class="o">-</span><span class="n">address</span><span class="w">

       </span><span class="nc">Executed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">--</span><span class="n">mode</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">whenever</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">address</span><span class="o">/</span><span class="n">route</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">MAC</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="o">.</span><span class="w">

   </span><span class="mi">10</span><span class="o">.</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="o">-</span><span class="n">verify</span><span class="w">

       </span><span class="nc">Executed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">--</span><span class="n">mode</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">connections</span><span class="p">,</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">untrusted</span><span class="o">.</span></code></pre><p>   SCRIPT HOOKS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Require</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="p" data-group-id="6352679269-1">(</span><span class="n">possibly</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">addition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">certificate</span><span class="p" data-group-id="6352679269-1">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">authentication</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="n">method</span><span class="w">

          </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">validate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w">

          </span><span class="n">cmd</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="p" data-group-id="6352679269-2">(</span><span class="ow">or</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="n">program</span><span class="p" data-group-id="6352679269-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">arguments</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="n">double</span><span class="o">-</span><span class="n">quoted</span><span class="w">
          </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">escaped</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">backslash</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">spaces</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">via</span><span class="o">-</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environmental</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="n">strings</span><span class="w"> </span><span class="n">pro</span><span class="err">‐</span><span class="w">
          </span><span class="n">vided</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w"> </span><span class="nc">Beware</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">insecure</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">platforms</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">publicly</span><span class="w"> </span><span class="n">visible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">other</span><span class="w">  </span><span class="n">unprivi</span><span class="err">‐</span><span class="w">
          </span><span class="n">leged</span><span class="w"> </span><span class="n">processes</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w">  </span><span class="n">method</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">via</span><span class="o">-</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">temporary</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">filename</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">as</span><span class="w">
          </span><span class="n">an</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">script</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">deleted</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">returns</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">of</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">temporary</span><span class="w">  </span><span class="n">file</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">con</span><span class="err">‐</span><span class="w">
          </span><span class="n">trolled</span><span class="w">  </span><span class="n">by</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="o">--</span><span class="n">tmp</span><span class="o">-</span><span class="n">dir</span><span class="w">  </span><span class="n">option</span><span class="p">,</span><span class="w">  </span><span class="ow">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">unspecified</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">security</span><span class="p">,</span><span class="w"> </span><span class="n">consider</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="o">--</span><span class="n">tmp</span><span class="o">-</span><span class="n">dir</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">volatile</span><span class="w">
          </span><span class="n">storage</span><span class="w"> </span><span class="n">medium</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">shm</span><span class="w"> </span><span class="p" data-group-id="6352679269-3">(</span><span class="k">if</span><span class="w"> </span><span class="n">available</span><span class="p" data-group-id="6352679269-3">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">touching</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">drive</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">examine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="n">returning</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="p" data-group-id="6352679269-4">(</span><span class="mi">0</span><span class="p" data-group-id="6352679269-4">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="sc">&#39;s authentication request is to be accepted, or  a
          failure code (1) to reject the client.

          This directive is designed to enable a plugin-style interface for extending OpenVPN&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">capabilities</span><span class="o">.</span><span class="w">

          </span><span class="nc">To</span><span class="w">  </span><span class="n">protect</span><span class="w">  </span><span class="n">against</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">passing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">maliciously</span><span class="w"> </span><span class="n">formed</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">consist</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="ss">characters</span><span class="p">:</span><span class="w"> </span><span class="n">al</span><span class="err">‐</span><span class="w">
          </span><span class="n">phanumeric</span><span class="p">,</span><span class="w"> </span><span class="n">underbar</span><span class="w"> </span><span class="p" data-group-id="6352679269-5">(</span><span class="sc">&#39;_&#39;</span><span class="p" data-group-id="6352679269-5">)</span><span class="p">,</span><span class="w"> </span><span class="n">dash</span><span class="w"> </span><span class="p" data-group-id="6352679269-6">(</span><span class="sc">&#39;-&#39;</span><span class="p" data-group-id="6352679269-6">)</span><span class="p">,</span><span class="w"> </span><span class="n">dot</span><span class="w"> </span><span class="p" data-group-id="6352679269-7">(</span><span class="sc">&#39;.&#39;</span><span class="p" data-group-id="6352679269-7">)</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="p" data-group-id="6352679269-8">(</span><span class="sc">&#39;@&#39;</span><span class="p" data-group-id="6352679269-8">)</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">consist</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">printable</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="n">except</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">CR</span><span class="w"> </span><span class="ow">or</span><span class="w">  </span><span class="nc">LF</span><span class="o">.</span><span class="w">  </span><span class="nc">Any</span><span class="w">
          </span><span class="n">illegal</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">converted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">underbar</span><span class="w"> </span><span class="p" data-group-id="6352679269-9">(</span><span class="sc">&#39;_&#39;</span><span class="p" data-group-id="6352679269-9">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">Care</span><span class="w">  </span><span class="n">must</span><span class="w">  </span><span class="n">be</span><span class="w"> </span><span class="n">taken</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="n">defined</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">creating</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">vulnerability</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">strings</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">handled</span><span class="o">.</span><span class="w"> </span><span class="nc">Never</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">these</span><span class="w">
          </span><span class="n">strings</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">escaped</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">evaluated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">interpreter</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">sample</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">performs</span><span class="w"> </span><span class="nc">PAM</span><span class="w"> </span><span class="n">authentication</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">sample</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">auth</span><span class="o">-</span><span class="n">pam</span><span class="o">.</span><span class="n">pl</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">distribution</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">cmd</span><span class="w">
          </span><span class="nc">Run</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w">

          </span><span class="n">cmd</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="p" data-group-id="6352679269-10">(</span><span class="ow">or</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="n">program</span><span class="p" data-group-id="6352679269-10">)</span><span class="p">,</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">arguments</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="n">double</span><span class="o">-</span><span class="n">quoted</span><span class="w">
          </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">escaped</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">backslash</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">spaces</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w">  </span><span class="n">command</span><span class="w">  </span><span class="n">is</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">just</span><span class="o">-</span><span class="n">authenticated</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">environmental</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="p" data-group-id="6352679269-11">(</span><span class="n">see</span><span class="w"> </span><span class="n">environmental</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">section</span><span class="w">
          </span><span class="n">below</span><span class="p" data-group-id="6352679269-11">)</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pathname</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">freshly</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="n">temporary</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="p" data-group-id="6352679269-12">(</span><span class="k">after</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">cmd</span><span class="w">  </span><span class="p" data-group-id="6352679269-12">)</span><span class="p">,</span><span class="w">  </span><span class="n">to</span><span class="w">
          </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">dynamically</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">directives</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">script</span><span class="w">  </span><span class="n">wants</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">connects</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="n">by</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">argument</span><span class="o">.</span><span class="w">

          </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">dir</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">legally</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dynamically</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

          </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">significant</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">disconnected</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">wants</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">defer</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">generating</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client_connect_deferred_file</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">client_con</span><span class="err">‐</span><span class="w">
          </span><span class="n">nect_config_file</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variables</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">accordingly</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">files</span><span class="o">.</span><span class="w">  </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Environmental</span><span class="w"> </span><span class="nc">Variables</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">details</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">disconnect</span><span class="w"> </span><span class="n">cmd</span><span class="w">
          </span><span class="nc">Like</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="n">shutdown</span><span class="o">.</span><span class="w"> </span><span class="nc">Will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="p" data-group-id="6352679269-13">(</span><span class="k">if</span><span class="w"> </span><span class="n">defined</span><span class="p" data-group-id="6352679269-13">)</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">pre</span><span class="err">‐</span><span class="w">
          </span><span class="n">viously</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">successful</span><span class="w"> </span><span class="p" data-group-id="6352679269-14">(</span><span class="mi">0</span><span class="p" data-group-id="6352679269-14">)</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">returns</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">exception</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">disconnect</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">cascaded</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">succeeded</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="nc">ALL</span><span class="w">
          </span><span class="n">of</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">disconnect</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">deletion</span><span class="p">,</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">cases</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">related</span><span class="w">
          </span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">returned</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">status</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">disconnect</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="p" data-group-id="6352679269-15">(</span><span class="n">only</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">cmd</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">any</span><span class="p" data-group-id="6352679269-15">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">down</span><span class="w"> </span><span class="n">cmd</span><span class="w">
          </span><span class="nc">Run</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="p" data-group-id="6352679269-16">(</span><span class="n">post</span><span class="w"> </span><span class="o">--</span><span class="n">user</span><span class="w"> </span><span class="nc">UID</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">chroot</span><span class="w"> </span><span class="p" data-group-id="6352679269-16">)</span><span class="o">.</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="p" data-group-id="6352679269-17">(</span><span class="ow">or</span><span class="w">  </span><span class="n">executable</span><span class="w">  </span><span class="n">program</span><span class="p" data-group-id="6352679269-17">)</span><span class="p">,</span><span class="w">  </span><span class="n">op</span><span class="err">‐</span><span class="w">
          </span><span class="n">tionally</span><span class="w">  </span><span class="n">followed</span><span class="w">  </span><span class="n">by</span><span class="w">  </span><span class="n">arguments</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">double</span><span class="o">-</span><span class="n">quoted</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">escaped</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">backslash</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w">
          </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">spaces</span><span class="o">.</span><span class="w">

          </span><span class="nc">Called</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">environmental</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">above</span><span class="o">.</span><span class="w">

          </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">reduce</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="o">--</span><span class="n">user</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="o">--</span><span class="n">down</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">reduced</span><span class="w"> </span><span class="n">privilege</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">down</span><span class="o">-</span><span class="n">pre</span><span class="w">
          </span><span class="nc">Call</span><span class="w"> </span><span class="o">--</span><span class="n">down</span><span class="w"> </span><span class="n">cmd</span><span class="o">/</span><span class="n">script</span><span class="w"> </span><span class="n">before</span><span class="p">,</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="k">after</span><span class="p">,</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">close</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">ipchange</span><span class="w"> </span><span class="n">cmd</span><span class="w">
          </span><span class="nc">Run</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">ip</span><span class="o">-</span><span class="n">address</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">initially</span><span class="w"> </span><span class="n">authenticated</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">changes</span><span class="o">.</span><span class="w">

          </span><span class="n">cmd</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="p" data-group-id="6352679269-18">(</span><span class="ow">or</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="n">program</span><span class="p" data-group-id="6352679269-18">)</span><span class="p">,</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">arguments</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="n">double</span><span class="o">-</span><span class="n">quoted</span><span class="w">
          </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">escaped</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">backslash</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">spaces</span><span class="o">.</span><span class="w">

          </span><span class="nc">When</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">executed</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">appended</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

             </span><span class="n">cmd</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">number</span><span class="w">

          </span><span class="nc">Don</span><span class="sc">&#39;t use --ipchange in --mode server mode. Use a --client-connect script instead.

          See the Environmental Variables section below for additional parameters passed as environmental variables.

          If you are running in a dynamic IP address environment where the IP addresses of either peer could change without notice, you can use this script, for
          example, to edit the /etc/hosts file with the current address of the peer. The script will be run every time the remote peer changes its IP address.

          Similarly if our IP address changes due to DHCP, we should configure our IP address change script (see man page for dhcpcd(8)) to deliver a SIGHUP  or
          SIGUSR1 signal to OpenVPN. OpenVPN will then re-establish a connection with its most recently authenticated peer on its new IP address.

   --learn-address cmd
          Run command cmd to validate client virtual addresses or routes.

          cmd  consists  of a path to a script (or executable program), optionally followed by arguments. The path and arguments may be single- or double-quoted
          and/or escaped using a backslash, and should be separated by one or more spaces.

          Three arguments will be appended to any arguments in cmd as follows:

          $1 - [operation]
                 &quot;add&quot;, &quot;update&quot;, or &quot;delete&quot; based on whether or not the address is being added to, modified, or deleted from OpenVPN&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="o">.</span><span class="w">

          </span><span class="err">$</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p" data-group-id="6352679269-19">[</span><span class="n">address</span><span class="p" data-group-id="6352679269-19">]</span><span class="w">
                 </span><span class="nc">The</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">learned</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">unlearned</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="s">&quot;198.162.10.14&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">subnet</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w">  </span><span class="s">&quot;198.162.10.0/24&quot;</span><span class="p">,</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="n">an</span><span class="w">
                 </span><span class="n">ethernet</span><span class="w"> </span><span class="nc">MAC</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="p" data-group-id="6352679269-20">(</span><span class="ow">when</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tap</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">used</span><span class="p" data-group-id="6352679269-20">)</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="s">&quot;00:FF:01:02:03:04&quot;</span><span class="o">.</span><span class="w">

          </span><span class="err">$</span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p" data-group-id="6352679269-21">[</span><span class="n">common</span><span class="w"> </span><span class="n">name</span><span class="p" data-group-id="6352679269-21">]</span><span class="w">
                 </span><span class="nc">The</span><span class="w">  </span><span class="n">common</span><span class="w">  </span><span class="n">name</span><span class="w">  </span><span class="n">on</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">certificate</span><span class="w">  </span><span class="n">associated</span><span class="w">  </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">linked</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">address</span><span class="o">.</span><span class="w"> </span><span class="nc">Only</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s">&quot;add&quot;</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s">&quot;update&quot;</span><span class="w"> </span><span class="n">operations</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w">
                 </span><span class="s">&quot;delete&quot;</span><span class="o">.</span><span class="w">

          </span><span class="nc">On</span><span class="w"> </span><span class="s">&quot;add&quot;</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s">&quot;update&quot;</span><span class="w"> </span><span class="n">methods</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="p" data-group-id="6352679269-22">(</span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="p" data-group-id="6352679269-22">)</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">modify</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">internal</span><span class="w">  </span><span class="n">rout</span><span class="err">‐</span><span class="w">
          </span><span class="n">ing</span><span class="w"> </span><span class="n">table</span><span class="o">.</span><span class="w">

          </span><span class="nc">Normally</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">appropriate</span><span class="w"> </span><span class="n">firewall</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w"> </span><span class="nc">Since</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">pro</span><span class="err">‐</span><span class="w">
          </span><span class="n">vides</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">association</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">MAC</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="sc">&#39;s authenticated common name, it allows a user-defined script to configure fire‐
          wall access policies with regard to the client&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">high</span><span class="o">-</span><span class="n">level</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">addresses</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">up</span><span class="w"> </span><span class="n">cmd</span><span class="w">
          </span><span class="nc">Run</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">added</span><span class="p">,</span><span class="w"> </span><span class="n">subject</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">delay</span><span class="o">.</span><span class="w">

          </span><span class="n">cmd</span><span class="w">  </span><span class="n">consists</span><span class="w">  </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="p" data-group-id="6352679269-23">(</span><span class="ow">or</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="n">program</span><span class="p" data-group-id="6352679269-23">)</span><span class="p">,</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">arguments</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">double</span><span class="o">-</span><span class="n">quoted</span><span class="w">
          </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">escaped</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">backslash</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">spaces</span><span class="o">.</span><span class="w">

          </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Environmental</span><span class="w"> </span><span class="nc">Variables</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">environmental</span><span class="w"> </span><span class="n">variables</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">pre</span><span class="o">-</span><span class="n">down</span><span class="w"> </span><span class="n">cmd</span><span class="w">
          </span><span class="nc">Run</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="n">upon</span><span class="w"> </span><span class="n">disconnection</span><span class="o">.</span><span class="w">

          </span><span class="n">cmd</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="p" data-group-id="6352679269-24">(</span><span class="ow">or</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="n">program</span><span class="p" data-group-id="6352679269-24">)</span><span class="p">,</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">arguments</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="n">double</span><span class="o">-</span><span class="n">quoted</span><span class="w">
          </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">escaped</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">backslash</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">spaces</span><span class="o">.</span><span class="w">

          </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Environmental</span><span class="w"> </span><span class="nc">Variables</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">environmental</span><span class="w"> </span><span class="n">variables</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">setenv</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">environmental</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">script</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">setenv</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">value</span><span class="w">
             </span><span class="n">setenv</span><span class="w"> </span><span class="nc">FORWARD_COMPATIBLE</span><span class="w"> </span><span class="mi">1</span><span class="w">
             </span><span class="n">setenv</span><span class="w"> </span><span class="n">opt</span><span class="w"> </span><span class="n">config_option</span><span class="w">

          </span><span class="nc">By</span><span class="w">  </span><span class="n">setting</span><span class="w">  </span><span class="nc">FORWARD_COMPATIBLE</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">syntax</span><span class="w"> </span><span class="n">checking</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">relaxed</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">unknown</span><span class="w"> </span><span class="n">directives</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">trigger</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">warning</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fatal</span><span class="w"> </span><span class="n">er</span><span class="err">‐</span><span class="w">
          </span><span class="n">ror</span><span class="p">,</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">unknown</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">versions</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">caution</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">good</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">reasons</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">having</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">detects</span><span class="w"> </span><span class="n">problems</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">config</span><span class="w">  </span><span class="n">file</span><span class="o">.</span><span class="w">   </span><span class="nc">Having</span><span class="w">
          </span><span class="n">said</span><span class="w"> </span><span class="n">that</span><span class="p">,</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">reasons</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">wanting</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">software</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">gracefully</span><span class="w"> </span><span class="n">degrade</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">encountered</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">software</span><span class="w"> </span><span class="n">versions</span><span class="o">.</span><span class="w">

          </span><span class="nc">It</span><span class="w">  </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">trigger</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fatal</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">isn</span><span class="sc">&#39;t recognized. To do this, prepend the following
          before the directive: setenv opt

          Versions prior to OpenVPN 2.3.3 will always ignore options set with the setenv opt directive.

          See also --ignore-unknown-option

   --setenv-safe args
          Set a custom environmental variable OPENVPN_name to value to pass to scripts.

          Valid syntaxes:

             setenv-safe name value

          This directive is designed to be pushed by the server to clients, and the prepending of OPENVPN_ to the environmental variable is a safety  precaution
          to prevent a LD_PRELOAD style attack from a malicious or compromised server.

   --tls-verify cmd
          Run  command cmd to verify the X509 name of a pending TLS connection that has otherwise passed all other tests of certification (except for revocation
          via --crl-verify directive; the revocation test occurs after the --tls-verify test).

          cmd should return 0 to allow the TLS handshake to proceed, or 1 to fail.

          cmd consists of a path to a script (or executable program), optionally followed by arguments. The path and arguments may be single-  or  double-quoted
          and/or escaped using a backslash, and should be separated by one or more spaces.

          When cmd is executed two arguments are appended after any arguments specified in cmd, as follows:

             cmd certificate_depth subject

          These arguments are, respectively, the current certificate depth and the X509 subject distinguished name (dn) of the peer.

          This feature is useful if the peer you want to trust has a certificate which was signed by a certificate authority who also signed many other certifi‐
          cates, where you don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">necessarily</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">trust</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">them</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">selective</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">accept</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w">  </span><span class="n">feature</span><span class="w">  </span><span class="n">al</span><span class="err">‐</span><span class="w">
          </span><span class="n">lows</span><span class="w">  </span><span class="n">you</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">write</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">X509</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">decide</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">accepted</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">perl</span><span class="w"> </span><span class="n">script</span><span class="w">
          </span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">verify</span><span class="o">-</span><span class="n">cn</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">distribution</span><span class="o">.</span><span class="w">

          </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Environmental</span><span class="w"> </span><span class="nc">Variables</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">environmental</span><span class="w"> </span><span class="n">variables</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">cmd</span><span class="w">
          </span><span class="nc">Run</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">successful</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="p" data-group-id="6352679269-25">(</span><span class="n">pre</span><span class="w"> </span><span class="o">--</span><span class="n">user</span><span class="w"> </span><span class="nc">UID</span><span class="w"> </span><span class="n">change</span><span class="p" data-group-id="6352679269-25">)</span><span class="o">.</span><span class="w">

          </span><span class="n">cmd</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="p" data-group-id="6352679269-26">(</span><span class="ow">or</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="n">program</span><span class="p" data-group-id="6352679269-26">)</span><span class="p">,</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">arguments</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="n">double</span><span class="o">-</span><span class="n">quoted</span><span class="w">
          </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">escaped</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">backslash</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">spaces</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w">  </span><span class="n">up</span><span class="w">  </span><span class="n">command</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">useful</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">destined</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">subnets</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">exist</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w">
          </span><span class="n">connection</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="ss">as</span><span class="p">:</span><span class="w">

             </span><span class="n">cmd</span><span class="w"> </span><span class="n">tun_dev</span><span class="w"> </span><span class="n">tun_mtu</span><span class="w"> </span><span class="n">link_mtu</span><span class="w"> </span><span class="n">ifconfig_local_ip</span><span class="w"> </span><span class="n">ifconfig_remote_ip</span><span class="w"> </span><span class="p" data-group-id="6352679269-27">[</span><span class="n">init</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">restart</span><span class="p" data-group-id="6352679269-27">]</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tap</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="ss">as</span><span class="p">:</span><span class="w">

             </span><span class="n">cmd</span><span class="w"> </span><span class="n">tap_dev</span><span class="w"> </span><span class="n">tap_mtu</span><span class="w"> </span><span class="n">link_mtu</span><span class="w"> </span><span class="n">ifconfig_local_ip</span><span class="w"> </span><span class="n">ifconfig_netmask</span><span class="w"> </span><span class="p" data-group-id="6352679269-28">[</span><span class="n">init</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">restart</span><span class="p" data-group-id="6352679269-28">]</span><span class="w">

          </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Environmental</span><span class="w"> </span><span class="nc">Variables</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">environmental</span><span class="w"> </span><span class="n">variables</span><span class="o">.</span><span class="w">

          </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="n">includes</span><span class="w"> </span><span class="n">arguments</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="o">-</span><span class="n">generated</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">appended</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="n">will</span><span class="w">
          </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

          </span><span class="nc">Typically</span><span class="p">,</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="o">.</span><span class="w">

          </span><span class="nc">Normally</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">up</span><span class="w">  </span><span class="n">script</span><span class="w">  </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">opened</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w">
          </span><span class="n">init</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="o">-</span><span class="n">restart</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">restarts</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="o">.</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="n">restart</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">considered</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w">  </span><span class="n">partial</span><span class="w">  </span><span class="n">reinitial</span><span class="err">‐</span><span class="w">
          </span><span class="n">ization</span><span class="w">  </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">preserved</span><span class="w"> </span><span class="p" data-group-id="6352679269-29">(</span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">persist</span><span class="o">-</span><span class="n">tun</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">preservation</span><span class="p" data-group-id="6352679269-29">)</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">restart</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w">
          </span><span class="nc">SIGUSR1</span><span class="w"> </span><span class="n">signal</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="o">-</span><span class="n">restart</span><span class="w"> </span><span class="n">timeout</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">proto</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">restart</span><span class="w">  </span><span class="n">occurs</span><span class="p">,</span><span class="w">  </span><span class="ow">and</span><span class="w">
          </span><span class="o">--</span><span class="n">up</span><span class="o">-</span><span class="n">restart</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">restart</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">parameter</span><span class="o">.</span><span class="w">

          </span><span class="ss">NOTE</span><span class="p">:</span><span class="w">  </span><span class="nc">On</span><span class="w">  </span><span class="n">restart</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">script</span><span class="o">.</span><span class="w"> </span><span class="nc">Namely</span><span class="p">,</span><span class="w"> </span><span class="n">everything</span><span class="w"> </span><span class="n">related</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">gateways</span><span class="w"> </span><span class="n">will</span><span class="w">
                 </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">passed</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="n">anyway</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">place</span><span class="o">.</span><span class="w"> </span><span class="nc">Additionally</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">up</span><span class="o">-</span><span class="n">restart</span><span class="w">  </span><span class="n">script</span><span class="w">  </span><span class="n">will</span><span class="w">  </span><span class="n">run</span><span class="w">
                 </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">downgraded</span><span class="w"> </span><span class="nc">UID</span><span class="o">/</span><span class="nc">GID</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="p" data-group-id="6352679269-30">(</span><span class="k">if</span><span class="w"> </span><span class="n">configured</span><span class="p" data-group-id="6352679269-30">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w">  </span><span class="n">following</span><span class="w">  </span><span class="n">standalone</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">shows</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">initialization</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">restart</span><span class="w"> </span><span class="n">context</span><span class="o">.</span><span class="w"> </span><span class="p" data-group-id="6352679269-31">(</span><span class="ss">NOTE</span><span class="p">:</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">reasons</span><span class="p">,</span><span class="w">
          </span><span class="n">don</span><span class="sc">&#39;t run the following example unless UDP port 9999 is blocked by your firewall. Also, the example will run indefinitely, so you  should  abort  with
          control-c).

             openvpn --dev tun --port 9999 --verb 4 --ping-restart 10 </span><span class="se">\
</span><span class="sc">                     --up &#39;</span><span class="n">echo</span><span class="w"> </span><span class="n">up</span><span class="sc">&#39; --down &#39;</span><span class="n">echo</span><span class="w"> </span><span class="n">down</span><span class="err">&#39;</span><span class="w"> </span><span class="o">--</span><span class="n">persist</span><span class="o">-</span><span class="n">tun</span><span class="w">  </span><span class="err">\</span><span class="w">
                     </span><span class="o">--</span><span class="n">up</span><span class="o">-</span><span class="n">restart</span><span class="w">

          </span><span class="nc">Note</span><span class="w">  </span><span class="n">that</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">ifconfig</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="w"> </span><span class="n">device</span><span class="p">,</span><span class="w"> </span><span class="n">eliminating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">define</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="p">,</span><span class="w"> </span><span class="k">unless</span><span class="w">
          </span><span class="n">you</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">configure</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ifconfig</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">endpoints</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">can</span><span class="w">  </span><span class="n">be</span><span class="w">
          </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">configure</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="ss">as</span><span class="p">:</span><span class="w">

             </span><span class="n">route</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">-</span><span class="n">net</span><span class="w"> </span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.0</span><span class="w"> </span><span class="n">netmask</span><span class="w"> </span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span><span class="w"> </span><span class="n">gw</span><span class="w"> </span><span class="err">$</span><span class="mi">5</span><span class="w">

   </span><span class="o">--</span><span class="n">up</span><span class="o">-</span><span class="n">delay</span><span class="w">
          </span><span class="nc">Delay</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">UDP</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">establishment</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">peer</span><span class="o">.</span><span class="w">

          </span><span class="nc">In</span><span class="w">  </span><span class="o">--</span><span class="n">proto</span><span class="w"> </span><span class="n">udp</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">initiation</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">sensed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">absence</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w">
          </span><span class="nc">UDP</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="s">&quot;connectionless&quot;</span><span class="w"> </span><span class="n">protocol</span><span class="o">.</span><span class="w">

          </span><span class="nc">On</span><span class="w"> </span><span class="nc">Windows</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">delay</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">media</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">transitioning</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s">&quot;connected&quot;</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">establishment</span><span class="p">,</span><span class="w">  </span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">receipt</span><span class="w">  </span><span class="n">of</span><span class="w">  </span><span class="n">the</span><span class="w">
          </span><span class="n">first</span><span class="w"> </span><span class="n">authenticated</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">peer</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">up</span><span class="o">-</span><span class="n">restart</span><span class="w">
          </span><span class="nc">Enable</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">down</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">restarts</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">fully</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w">
          </span><span class="n">option</span><span class="w"> </span><span class="n">documentation</span><span class="o">.</span></code></pre><p>   String Types and Remapping</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">In</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="n">cases</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">remapping</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w"> </span><span class="nc">Essentially</span><span class="p">,</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">set</span><span class="w">  </span><span class="n">of</span><span class="w">  </span><span class="n">permitted</span><span class="w">  </span><span class="n">characters</span><span class="w">  </span><span class="k">for</span><span class="w">  </span><span class="n">each</span><span class="w">
   </span><span class="n">string</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">converted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">underbar</span><span class="w"> </span><span class="p" data-group-id="2319250643-1">(</span><span class="sc">&#39;_&#39;</span><span class="p" data-group-id="2319250643-1">)</span><span class="o">.</span><span class="w">

   </span><span class="ss">Q</span><span class="p">:</span><span class="w"> </span><span class="nc">Why</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">remapping</span><span class="w"> </span><span class="n">necessary?</span><span class="w">
          </span><span class="nc">It</span><span class="sc">&#39;s  an  important security feature to prevent the malicious coding of strings from untrusted sources to be passed as parameters to scripts, saved in
          the environment, used as a common name, translated to a filename, etc.

   Q: Can string remapping be disabled?
          Yes, by using the --no-name-remapping option, however this should be considered an advanced option.

   Here is a brief rundown of OpenVPN&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">permitted</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="ss">string</span><span class="p">:</span><span class="w">

   </span><span class="nc">X509</span><span class="w"> </span><span class="nc">Names</span><span class="w">
          </span><span class="nc">Alphanumeric</span><span class="p">,</span><span class="w"> </span><span class="n">underbar</span><span class="w"> </span><span class="p" data-group-id="2319250643-2">(</span><span class="sc">&#39;_&#39;</span><span class="p" data-group-id="2319250643-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">dash</span><span class="w"> </span><span class="p" data-group-id="2319250643-3">(</span><span class="sc">&#39;-&#39;</span><span class="p" data-group-id="2319250643-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">dot</span><span class="w"> </span><span class="p" data-group-id="2319250643-4">(</span><span class="sc">&#39;.&#39;</span><span class="p" data-group-id="2319250643-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="p" data-group-id="2319250643-5">(</span><span class="sc">&#39;@&#39;</span><span class="p" data-group-id="2319250643-5">)</span><span class="p">,</span><span class="w"> </span><span class="n">colon</span><span class="w"> </span><span class="p" data-group-id="2319250643-6">(</span><span class="sc">&#39;:&#39;</span><span class="p" data-group-id="2319250643-6">)</span><span class="p">,</span><span class="w"> </span><span class="n">slash</span><span class="w"> </span><span class="p" data-group-id="2319250643-7">(</span><span class="sc">&#39;/&#39;</span><span class="p" data-group-id="2319250643-7">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="p" data-group-id="2319250643-8">(</span><span class="sc">&#39;=&#39;</span><span class="p" data-group-id="2319250643-8">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Alphanumeric</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">which</span><span class="w">
          </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">isalnum</span><span class="p" data-group-id="2319250643-9">(</span><span class="p" data-group-id="2319250643-9">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="no">true</span><span class="o">.</span><span class="w">

   </span><span class="nc">Common</span><span class="w"> </span><span class="nc">Names</span><span class="w">
          </span><span class="nc">Alphanumeric</span><span class="p">,</span><span class="w"> </span><span class="n">underbar</span><span class="w"> </span><span class="p" data-group-id="2319250643-10">(</span><span class="sc">&#39;_&#39;</span><span class="p" data-group-id="2319250643-10">)</span><span class="p">,</span><span class="w"> </span><span class="n">dash</span><span class="w"> </span><span class="p" data-group-id="2319250643-11">(</span><span class="sc">&#39;-&#39;</span><span class="p" data-group-id="2319250643-11">)</span><span class="p">,</span><span class="w"> </span><span class="n">dot</span><span class="w"> </span><span class="p" data-group-id="2319250643-12">(</span><span class="sc">&#39;.&#39;</span><span class="p" data-group-id="2319250643-12">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="p" data-group-id="2319250643-13">(</span><span class="sc">&#39;@&#39;</span><span class="p" data-group-id="2319250643-13">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="w"> </span><span class="n">username</span><span class="w">
          </span><span class="nc">Same</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">Common</span><span class="w"> </span><span class="nc">Name</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ss">exception</span><span class="p">:</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.0</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OPENVPN_PLUGIN_AUTH_USER_PASS_VERIFY</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">its</span><span class="w">
          </span><span class="n">raw</span><span class="w"> </span><span class="n">form</span><span class="p">,</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">remapping</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="w"> </span><span class="n">password</span><span class="w">
          </span><span class="nc">Any</span><span class="w"> </span><span class="s">&quot;printable&quot;</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">except</span><span class="w"> </span><span class="nc">CR</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">LF</span><span class="o">.</span><span class="w"> </span><span class="nc">Printable</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">isprint</span><span class="p" data-group-id="2319250643-14">(</span><span class="p" data-group-id="2319250643-14">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="no">true</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">dir</span><span class="w"> </span><span class="n">filename</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">derived</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">or</span><span class="err">`</span><span class="n">username</span><span class="w">
          </span><span class="nc">Alphanumeric</span><span class="p">,</span><span class="w"> </span><span class="n">underbar</span><span class="w"> </span><span class="p" data-group-id="2319250643-15">(</span><span class="sc">&#39;_&#39;</span><span class="p" data-group-id="2319250643-15">)</span><span class="p">,</span><span class="w"> </span><span class="n">dash</span><span class="w"> </span><span class="p" data-group-id="2319250643-16">(</span><span class="sc">&#39;-&#39;</span><span class="p" data-group-id="2319250643-16">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">dot</span><span class="w"> </span><span class="p" data-group-id="2319250643-17">(</span><span class="sc">&#39;.&#39;</span><span class="p" data-group-id="2319250643-17">)</span><span class="w"> </span><span class="n">except</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w">  </span><span class="ow">or</span><span class="w"> </span><span class="s">&quot;..&quot;</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">standalone</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w"> </span><span class="nc">As</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">v2</span><span class="o">.</span><span class="mf">0.1</span><span class="o">-</span><span class="n">rc6</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">at</span><span class="w">  </span><span class="p" data-group-id="2319250643-18">(</span><span class="sc">&#39;@&#39;</span><span class="p" data-group-id="2319250643-18">)</span><span class="w">  </span><span class="n">character</span><span class="w">  </span><span class="n">has</span><span class="w">
          </span><span class="n">been</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">compatibility</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">class</span><span class="o">.</span><span class="w">

   </span><span class="nc">Environmental</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">names</span><span class="w">
          </span><span class="nc">Alphanumeric</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">underbar</span><span class="w"> </span><span class="p" data-group-id="2319250643-19">(</span><span class="sc">&#39;_&#39;</span><span class="p" data-group-id="2319250643-19">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">Environmental</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">values</span><span class="w">
          </span><span class="nc">Any</span><span class="w"> </span><span class="n">printable</span><span class="w"> </span><span class="n">character</span><span class="o">.</span><span class="w">

   </span><span class="nc">For</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">cases</span><span class="p">,</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">members</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">legal</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">remapped</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">underbar</span><span class="w"> </span><span class="p" data-group-id="2319250643-20">(</span><span class="sc">&#39;_&#39;</span><span class="p" data-group-id="2319250643-20">)</span><span class="o">.</span></code></pre><p>   Environmental Variables</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Once</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">persisted</span><span class="w"> </span><span class="n">indefinitely</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">restart</span><span class="p">,</span><span class="w">

   </span><span class="nc">As</span><span class="w">  </span><span class="n">of</span><span class="w">  </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="mf">2.0</span><span class="o">-</span><span class="n">beta12</span><span class="p">,</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="n">server</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">environmental</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">scoped</span><span class="w"> </span><span class="n">according</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w">
   </span><span class="n">there</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">issues</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="n">having</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">stale</span><span class="p">,</span><span class="w"> </span><span class="n">previously</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">refer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">instances</span><span class="o">.</span><span class="w">

   </span><span class="n">bytes_received</span><span class="w">
          </span><span class="nc">Total</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">session</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">disconnect</span><span class="w"> </span><span class="n">script</span><span class="o">.</span><span class="w">

   </span><span class="n">bytes_sent</span><span class="w">
          </span><span class="nc">Total</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">session</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">disconnect</span><span class="w"> </span><span class="n">script</span><span class="o">.</span><span class="w">

   </span><span class="n">client_connect_config_file</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="p" data-group-id="6781736270-1">(</span><span class="n">optional</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">session</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">desired</span><span class="p" data-group-id="6781736270-1">)</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w">
          </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">script</span><span class="o">.</span><span class="w">

   </span><span class="n">client_connect_deferred_file</span><span class="w">
          </span><span class="nc">This</span><span class="w">  </span><span class="n">file</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">communicate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">plgin</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="ow">in</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">relevant</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">indicate</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p" data-group-id="6781736270-2">(</span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">that</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">non</span><span class="w">  </span><span class="n">zero</span><span class="w">  </span><span class="n">exit</span><span class="w">  </span><span class="n">status</span><span class="w">
          </span><span class="n">does</span><span class="p" data-group-id="6781736270-2">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">indicate</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">deferred</span><span class="w"> </span><span class="n">returning</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w">  </span><span class="n">deferred</span><span class="w"> </span><span class="p" data-group-id="6781736270-3">(</span><span class="n">background</span><span class="p" data-group-id="6781736270-3">)</span><span class="w"> </span><span class="n">handling</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">MUST</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">indicate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">deferral</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">signal</span><span class="w">
          </span><span class="n">deferred</span><span class="w"> </span><span class="n">handler</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="nc">OK</span><span class="o">.</span><span class="w">

          </span><span class="nc">A</span><span class="w"> </span><span class="n">background</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">care</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">writing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">indicated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">client_connect_config_file</span><span class="w">  </span><span class="n">environment</span><span class="w">
          </span><span class="n">variable</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">finished</span><span class="p">,</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="p" data-group-id="6781736270-4">(</span><span class="ow">or</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="p" data-group-id="6781736270-4">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w">  </span><span class="n">absence</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">finishes</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">to</span><span class="w">
          </span><span class="n">support</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">defer</span><span class="w"> </span><span class="n">mechanism</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">unmodified</span><span class="o">.</span><span class="w">

   </span><span class="n">common_name</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="nc">X509</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">authenticated</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">disconnect</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">scripts</span><span class="o">.</span><span class="w">

   </span><span class="n">config</span><span class="w"> </span><span class="nc">Name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="o">--</span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">initiation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">SIGHUP</span><span class="o">.</span><span class="w">

   </span><span class="n">daemon</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">daemon</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="n">otherwise</span><span class="o">.</span><span class="w">  </span><span class="nc">Set</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">initiation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">SIGHUP</span><span class="o">.</span><span class="w">

   </span><span class="n">daemon_log_redirect</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">log</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">log</span><span class="o">-</span><span class="n">append</span><span class="w"> </span><span class="n">directives</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="n">otherwise</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">initiation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">SIGHUP</span><span class="o">.</span><span class="w">

   </span><span class="n">dev</span><span class="w">    </span><span class="nc">The</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">device</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">exists</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">down</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">

   </span><span class="n">dev_idx</span><span class="w">
          </span><span class="nc">On</span><span class="w"> </span><span class="nc">Windows</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="p" data-group-id="6781736270-5">(</span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">netsh</span><span class="o">.</span><span class="n">exe</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">sometimes</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="k" data-group-id="6781736270-6">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">interface</span><span class="w">  </span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Set</span><span class="w">
          </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">down</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">

   </span><span class="n">foreign_option_</span><span class="p" data-group-id="6781736270-7">{</span><span class="n">n</span><span class="p" data-group-id="6781736270-7">}</span><span class="w">
          </span><span class="nc">An</span><span class="w">  </span><span class="n">option</span><span class="w">  </span><span class="n">pushed</span><span class="w">  </span><span class="n">via</span><span class="w"> </span><span class="o">--</span><span class="n">push</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">natively</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">it</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">--</span><span class="n">dhcp</span><span class="o">-</span><span class="n">option</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">Windows</span><span class="w"> </span><span class="n">system</span><span class="p">,</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">recorded</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w">
          </span><span class="n">environmental</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">

   </span><span class="n">ifconfig_broadcast</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">broadcast</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">ethernet</span><span class="w"> </span><span class="n">segment</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">derived</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tap</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="n">call</span><span class="err">‐</span><span class="w">
          </span><span class="n">ing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ifconfig</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">netsh</span><span class="w"> </span><span class="p" data-group-id="6781736270-8">(</span><span class="n">windows</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ifconfig</span><span class="p" data-group-id="6781736270-8">)</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">occurs</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">

   </span><span class="n">ifconfig_ipv6_local</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">endpoint</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="o">-</span><span class="n">ipv6</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="p" data-group-id="6781736270-9">(</span><span class="n">first</span><span class="w"> </span><span class="n">parameter</span><span class="p" data-group-id="6781736270-9">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ifconfig</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">code</span><span class="ss">:netsh</span><span class="w">
          </span><span class="p" data-group-id="6781736270-10">(</span><span class="n">windows</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ifconfig</span><span class="p" data-group-id="6781736270-10">)</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">occurs</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">

   </span><span class="n">ifconfig_ipv6_netbits</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w"> </span><span class="nc">Derived</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">/</span><span class="n">nnn</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="o">-</span><span class="n">ipv6</span><span class="w">  </span><span class="n">option</span><span class="w">  </span><span class="p" data-group-id="6781736270-11">(</span><span class="n">first</span><span class="w">
          </span><span class="n">parameter</span><span class="p" data-group-id="6781736270-11">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ifconfig</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">netsh</span><span class="w"> </span><span class="p" data-group-id="6781736270-12">(</span><span class="n">windows</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ifconfig</span><span class="p" data-group-id="6781736270-12">)</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">occurs</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">exe</span><span class="err">‐</span><span class="w">
          </span><span class="n">cution</span><span class="o">.</span><span class="w">

   </span><span class="n">ifconfig_ipv6_remote</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">endpoint</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="o">-</span><span class="n">ipv6</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="p" data-group-id="6781736270-13">(</span><span class="n">second</span><span class="w"> </span><span class="n">parameter</span><span class="p" data-group-id="6781736270-13">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">ifconfig</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="n">netsh</span><span class="w">
          </span><span class="p" data-group-id="6781736270-14">(</span><span class="n">windows</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ifconfig</span><span class="p" data-group-id="6781736270-14">)</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">occurs</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">

   </span><span class="n">ifconfig_local</span><span class="w">
          </span><span class="nc">The</span><span class="w">  </span><span class="n">local</span><span class="w">  </span><span class="nc">VPN</span><span class="w">  </span><span class="n">endpoint</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="p" data-group-id="6781736270-15">(</span><span class="n">first</span><span class="w"> </span><span class="n">parameter</span><span class="p" data-group-id="6781736270-15">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ifconfig</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">netsh</span><span class="w"> </span><span class="p" data-group-id="6781736270-16">(</span><span class="n">windows</span><span class="w">
          </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ifconfig</span><span class="p" data-group-id="6781736270-16">)</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">occurs</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">

   </span><span class="n">ifconfig_remote</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">endpoint</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="p" data-group-id="6781736270-17">(</span><span class="n">second</span><span class="w"> </span><span class="n">parameter</span><span class="p" data-group-id="6781736270-17">)</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="k">if</span><span class="err">‐</span><span class="w">
          </span><span class="n">config</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">netsh</span><span class="w"> </span><span class="p" data-group-id="6781736270-18">(</span><span class="n">windows</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ifconfig</span><span class="p" data-group-id="6781736270-18">)</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">occurs</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">

   </span><span class="n">ifconfig_netmask</span><span class="w">
          </span><span class="nc">The</span><span class="w">  </span><span class="n">subnet</span><span class="w">  </span><span class="n">mask</span><span class="w">  </span><span class="n">of</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">ethernet</span><span class="w"> </span><span class="n">segment</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tap</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w">
          </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ifconfig</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">netsh</span><span class="w"> </span><span class="p" data-group-id="6781736270-19">(</span><span class="n">windows</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ifconfig</span><span class="p" data-group-id="6781736270-19">)</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">occurs</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">

   </span><span class="n">ifconfig_pool_local_ip</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">taken</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="o">-</span><span class="n">push</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">ifconfig</span><span class="w">  </span><span class="n">pool</span><span class="w">  </span><span class="p" data-group-id="6781736270-20">(</span><span class="n">con</span><span class="err">‐</span><span class="w">
          </span><span class="n">trolled</span><span class="w">  </span><span class="n">by</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="o">--</span><span class="n">ifconfig</span><span class="o">-</span><span class="n">pool</span><span class="w">  </span><span class="n">config</span><span class="w">  </span><span class="n">file</span><span class="w"> </span><span class="n">directive</span><span class="p" data-group-id="6781736270-20">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Only</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">tunnels</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w">
          </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">disconnect</span><span class="w"> </span><span class="n">scripts</span><span class="o">.</span><span class="w">

   </span><span class="n">ifconfig_pool_netmask</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">netmask</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">taken</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="o">-</span><span class="n">push</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ifconfig</span><span class="w"> </span><span class="n">pool</span><span class="w"> </span><span class="p" data-group-id="6781736270-21">(</span><span class="n">controlled</span><span class="w"> </span><span class="n">by</span><span class="w">
          </span><span class="n">the</span><span class="w">  </span><span class="o">--</span><span class="n">ifconfig</span><span class="o">-</span><span class="n">pool</span><span class="w">  </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">directive</span><span class="p" data-group-id="6781736270-21">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Only</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tap</span><span class="w"> </span><span class="n">tunnels</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">con</span><span class="err">‐</span><span class="w">
          </span><span class="n">nect</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">disconnect</span><span class="w"> </span><span class="n">scripts</span><span class="o">.</span><span class="w">

   </span><span class="n">ifconfig_pool_remote_ip</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">taken</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="o">-</span><span class="n">push</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ifconfig</span><span class="w">  </span><span class="n">pool</span><span class="w">  </span><span class="p" data-group-id="6781736270-22">(</span><span class="n">con</span><span class="err">‐</span><span class="w">
          </span><span class="n">trolled</span><span class="w">  </span><span class="n">by</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="o">-</span><span class="n">pool</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">directive</span><span class="p" data-group-id="6781736270-22">)</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">dis</span><span class="err">‐</span><span class="w">
          </span><span class="n">connect</span><span class="w"> </span><span class="n">scripts</span><span class="o">.</span><span class="w">

   </span><span class="n">link_mtu</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p" data-group-id="6781736270-23">(</span><span class="ow">not</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">header</span><span class="p" data-group-id="6781736270-23">)</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">transport</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">down</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">

   </span><span class="n">local</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">local</span><span class="w"> </span><span class="n">parameter</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">initiation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">SIGHUP</span><span class="o">.</span><span class="w">

   </span><span class="n">local_port</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">--</span><span class="n">port</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">lport</span><span class="o">.</span><span class="w">  </span><span class="nc">Set</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">initiation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">SIGHUP</span><span class="o">.</span><span class="w">

   </span><span class="n">password</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="o">-</span><span class="n">verify</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">via</span><span class="o">-</span><span class="n">env</span><span class="w"> </span><span class="n">modifier</span><span class="w"> </span><span class="n">is</span><span class="w">  </span><span class="n">specified</span><span class="p">,</span><span class="w">  </span><span class="ow">and</span><span class="w">
          </span><span class="n">deleted</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="k" data-group-id="6781736270-6">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">returns</span><span class="o">.</span><span class="w">

   </span><span class="n">proto</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">proto</span><span class="w"> </span><span class="n">parameter</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">initiation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">SIGHUP</span><span class="o">.</span><span class="w">

   </span><span class="n">remote_</span><span class="p" data-group-id="6781736270-24">{</span><span class="n">n</span><span class="p" data-group-id="6781736270-24">}</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">parameter</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">initiation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">SIGHUP</span><span class="o">.</span><span class="w">

   </span><span class="n">remote_port_</span><span class="p" data-group-id="6781736270-25">{</span><span class="n">n</span><span class="p" data-group-id="6781736270-25">}</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">--</span><span class="n">port</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">rport</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">initiation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">SIGHUP</span><span class="o">.</span><span class="w">

   </span><span class="n">route_net_gateway</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">pre</span><span class="o">-</span><span class="n">existing</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">

   </span><span class="n">route_vpn_gateway</span><span class="w">
          </span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="w"> </span><span class="n">options</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">gateway</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">is</span><span class="w">
          </span><span class="n">specified</span><span class="o">.</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">

   </span><span class="n">route_</span><span class="p" data-group-id="6781736270-26">{</span><span class="n">parm</span><span class="p" data-group-id="6781736270-26">}</span><span class="bp">_</span><span class="p" data-group-id="6781736270-27">{</span><span class="n">n</span><span class="p" data-group-id="6781736270-27">}</span><span class="w">
          </span><span class="nc">A</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">define</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">added</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">

          </span><span class="n">parm</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">network</span><span class="p">,</span><span class="w"> </span><span class="n">netmask</span><span class="s">&quot;, gateway, or metric.

          n is the OpenVPN route number, starting from 1.

          If the network or gateway are resolvable DNS names, their IP address translations will be recorded rather than their names as denoted on  the  command
          line or configuration file.

   route_ipv6_{parm}_{n}
          A set of variables which define each IPv6 route to be added, and are set prior to --up script execution.

          parm will be one of network, gateway or metric. route_ipv6_network_{n} contains netmask as /nnn, unlike IPv4 where it is passed in a separate environ‐
          ment variable.

          n is the OpenVPN route number, starting from 1.

          If the network or gateway are resolvable DNS names, their IP address translations will be recorded rather than their names as denoted on  the  command
          line or configuration file.

   peer_cert
          Temporary file name containing the client certificate upon connection.  Useful in conjunction with --tls-verify.

   script_context
          Set to &quot;</span><span class="n">init</span><span class="s">&quot; or &quot;</span><span class="n">restart</span><span class="s">&quot; prior to up/down script execution. For more information, see documentation for --up.

   script_type
          Prior  to execution of any script, this variable is set to the type of script being run. It can be one of the following: up, down, ipchange, route-up,
          tls-verify, auth-user-pass-verify, client-connect, client-disconnect or learn-address. Set prior to execution of any script.

   signal The reason for exit or restart. Can be one of sigusr1, sighup, sigterm, sigint, inactive (controlled by --inactive option), ping-exit  (controlled  by
          --ping-exit  option),  ping-restart (controlled by --ping-restart option), connection-reset (triggered on TCP connection reset), error or unknown (un‐
          known signal).  This variable is set just prior to down script execution.

   time_ascii
          Client connection timestamp, formatted as a human-readable time string.  Set prior to execution of the --client-connect script.

   time_duration
          The duration (in seconds) of the client session which is now disconnecting. Set prior to execution of the --client-disconnect script.

   time_unix
          Client connection timestamp, formatted as a unix integer date/time value. Set prior to execution of the --client-connect script.

   tls_digest_{n} / tls_digest_sha256_{n}
          Contains the certificate SHA1 / SHA256 fingerprint, where n is the verification level. Only set  for  TLS  connections.  Set  prior  to  execution  of
          --tls-verify script.

   tls_id_{n}
          A  series  of  certificate  fields  from  the  remote peer, where n is the verification level. Only set for TLS connections. Set prior to execution of
          --tls-verify script.

   tls_serial_{n}
          The serial number of the certificate from the remote peer, where n is the verification level. Only set for TLS connections. Set prior to execution  of
          --tls-verify script. This is in the form of a decimal string like &quot;</span><span class="mi">933971680</span><span class="s">&quot;, which is suitable for doing serial-based OCSP queries (with OpenSSL, do
          not prepend &quot;</span><span class="mi">0</span><span class="n">x</span><span class="s">&quot; to the string) If something goes wrong while reading the value from the certificate it will be an empty string, so your  code  should
          check that. See the contrib/OCSP_check/OCSP_check.sh script for an example.

   tls_serial_hex_{n}
          Like tls_serial_{n}, but in hex form (e.g.  12:34:56:78:9A).

   tun_mtu
          The MTU of the TUN/TAP device. Set prior to --up or --down script execution.

   trusted_ip / trusted_ip6)
          Actual  IP address of connecting client or peer which has been authenticated. Set prior to execution of --ipchange, --client-connect and --client-dis‐
          connect scripts. If using ipv6 endpoints (udp6, tcp6), trusted_ip6 will be set instead.

   trusted_port
          Actual port number of connecting client or peer which has been authenticated. Set prior to execution of --ipchange, --client-connect and --client-dis‐
          connect scripts.

   untrusted_ip / untrusted_ip6
          Actual  IP  address  of  connecting  client or peer which has not been authenticated yet. Sometimes used to nmap the connecting host in a --tls-verify
          script to ensure it is firewalled properly. Set prior to execution of --tls-verify and --auth-user-pass-verify scripts. If using ipv6 endpoints (udp6,
          tcp6), untrusted_ip6 will be set instead.

   untrusted_port
          Actual port number of connecting client or peer which has not been authenticated yet. Set prior to execution of --tls-verify and --auth-user-pass-ver‐
          ify scripts.

   username
          The username provided by a connecting client. Set prior to --auth-user-pass-verify script execution only when the via-env modifier is specified.

   X509_{n}_{subject_field}
          An X509 subject field from the remote peer certificate, where n is the verification level. Only set for TLS connections. Set  prior  to  execution  of
          --tls-verify script. This variable is similar to tls_id_{n} except the component X509 subject fields are broken out, and no string remapping occurs on
          these field values (except for remapping of control characters to &quot;</span><span class="bp">_</span><span class="err">&quot;</span><span class="p">)</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">server</span><span class="w">  </span><span class="n">using</span><span class="w">
          </span><span class="n">the</span><span class="w">  </span><span class="n">sample</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sample</span><span class="o">-</span><span class="n">keys</span><span class="w"> </span><span class="p" data-group-id="6781736270-28">(</span><span class="n">client</span><span class="o">.</span><span class="n">crt</span><span class="p" data-group-id="6781736270-28">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">verification</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">CA</span><span class="w"> </span><span class="n">certifi</span><span class="err">‐</span><span class="w">
          </span><span class="n">cate</span><span class="o">.</span><span class="w">

             </span><span class="nc">X509_0_emailAddress</span><span class="o">=</span><span class="n">me</span><span class="na">@myhost</span><span class="o">.</span><span class="n">mydomain</span><span class="w">
             </span><span class="nc">X509_0_CN</span><span class="o">=</span><span class="nc">Test</span><span class="o">-</span><span class="nc">Client</span><span class="w">
             </span><span class="nc">X509_0_O</span><span class="o">=</span><span class="nc">OpenVPN</span><span class="o">-</span><span class="nc">TEST</span><span class="w">
             </span><span class="nc">X509_0_ST</span><span class="o">=</span><span class="nc">NA</span><span class="w">
             </span><span class="nc">X509_0_C</span><span class="o">=</span><span class="nc">KG</span><span class="w">
             </span><span class="nc">X509_1_emailAddress</span><span class="o">=</span><span class="n">me</span><span class="na">@myhost</span><span class="o">.</span><span class="n">mydomain</span><span class="w">
             </span><span class="nc">X509_1_O</span><span class="o">=</span><span class="nc">OpenVPN</span><span class="o">-</span><span class="nc">TEST</span><span class="w">
             </span><span class="nc">X509_1_L</span><span class="o">=</span><span class="nc">BISHKEK</span><span class="w">
             </span><span class="nc">X509_1_ST</span><span class="o">=</span><span class="nc">NA</span><span class="w">
             </span><span class="nc">X509_1_C</span><span class="o">=</span><span class="nc">KG</span></code></pre><p>   Management Interface Options</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="n">rich</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">operations</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Enable</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">socket</span><span class="o">-</span><span class="n">name</span><span class="w"> </span><span class="nc">Unix</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">platforms</span><span class="w"> </span><span class="n">supporting</span><span class="w"> </span><span class="n">it</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">designated</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">port</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">management</span><span class="w"> </span><span class="n">socket</span><span class="o">-</span><span class="n">name</span><span class="w"> </span><span class="n">unix</span><span class="w">          </span><span class="c1">#</span><span class="w">
             </span><span class="n">management</span><span class="w"> </span><span class="n">socket</span><span class="o">-</span><span class="n">name</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">pw</span><span class="o">-</span><span class="n">file</span><span class="w">  </span><span class="c1"># (recommended)</span><span class="w">
             </span><span class="n">management</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">port</span><span class="w">                   </span><span class="c1"># (INSECURE)</span><span class="w">
             </span><span class="n">management</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">pw</span><span class="o">-</span><span class="n">file</span><span class="w">           </span><span class="c1">#</span><span class="w">

          </span><span class="n">pw</span><span class="o">-</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">line</span><span class="o">.</span><span class="w"> </span><span class="nc">Instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">filename</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="kn">use</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">keyword</span><span class="w">  </span><span class="n">stdin</span><span class="w">  </span><span class="n">which</span><span class="w">  </span><span class="n">will</span><span class="w">
          </span><span class="n">prompt</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">starting</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w">  </span><span class="n">unix</span><span class="w">  </span><span class="n">sockets</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">behaviour</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">connected</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="w"> </span><span class="nc">Use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">user</span><span class="w">
          </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">group</span><span class="w"> </span><span class="n">directives</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">restrict</span><span class="w"> </span><span class="n">access</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">operate</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">itself</span><span class="o">.</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">tun</span><span class="err">‐</span><span class="w">
          </span><span class="n">nel</span><span class="o">.</span><span class="w"> </span><span class="nc">Tunnel</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">listen</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w">

          </span><span class="o">*</span><span class="nc">BEWARE</span><span class="o">*</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">enabling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="nc">TCP</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">cases</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="nc">ALWAYS</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">pw</span><span class="o">-</span><span class="n">file</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">protect</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">inter</span><span class="err">‐</span><span class="w">
          </span><span class="n">face</span><span class="o">.</span><span class="w"> </span><span class="nc">Any</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">who</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="nc">IP</span><span class="ss">:port</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">manage</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="p" data-group-id="2677016708-1">(</span><span class="ow">and</span><span class="w"> </span><span class="n">interfere</span><span class="w"> </span><span class="k">with</span><span class="p" data-group-id="2677016708-1">)</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">also</span><span class="w">  </span><span class="n">strongly</span><span class="w">
          </span><span class="n">recommended</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="p" data-group-id="2677016708-2">(</span><span class="n">localhost</span><span class="p" data-group-id="2677016708-2">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">restrict</span><span class="w"> </span><span class="n">accessibility</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">clients</span><span class="o">.</span><span class="w">

          </span><span class="nc">While</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">designed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">programmatic</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">applications</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">telnet</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">telnet</span><span class="w">
          </span><span class="n">client</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="s">&quot;raw&quot;</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w"> </span><span class="nc">Once</span><span class="w"> </span><span class="n">connected</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">help</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">commands</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="n">documentation</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">interface</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="o">-</span><span class="n">notes</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">folder</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">distribution</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">client</span><span class="w">
          </span><span class="nc">Management</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">IP</span><span class="ss">:port</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">--</span><span class="n">management</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">listen</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="k" data-group-id="2677016708-3">do</span><span class="err">‐</span><span class="w">
          </span><span class="n">main</span><span class="w"> </span><span class="n">socket</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">fails</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">disconnected</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">SIGTERM</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">causing</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">quit</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">auth</span><span class="w">
          </span><span class="nc">Gives</span><span class="w">  </span><span class="n">management</span><span class="w">  </span><span class="n">interface</span><span class="w">  </span><span class="n">client</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">responsibility</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">authenticate</span><span class="w">  </span><span class="n">clients</span><span class="w">  </span><span class="k" data-group-id="2677016708-3">after</span><span class="w">  </span><span class="n">their</span><span class="w">  </span><span class="n">client</span><span class="w">  </span><span class="n">certificate</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">verified</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="n">manage</span><span class="err">‐</span><span class="w">
          </span><span class="n">ment</span><span class="o">-</span><span class="n">notes</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="n">notes</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">group</span><span class="w"> </span><span class="n">g</span><span class="w">
          </span><span class="nc">When</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">listening</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">g</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">pf</span><span class="w">
          </span><span class="nc">Management</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="n">management</span><span class="o">-</span><span class="n">notes</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="n">distribution</span><span class="w">  </span><span class="k">for</span><span class="w">  </span><span class="n">de</span><span class="err">‐</span><span class="w">
          </span><span class="n">tailed</span><span class="w"> </span><span class="n">notes</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">user</span><span class="w"> </span><span class="n">u</span><span class="w">
          </span><span class="nc">When</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">listening</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">u</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">external</span><span class="o">-</span><span class="n">cert</span><span class="w"> </span><span class="n">certificate</span><span class="o">-</span><span class="n">hint</span><span class="w">
          </span><span class="nc">Allows</span><span class="w">  </span><span class="n">usage</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">external</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">--</span><span class="n">cert</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="p" data-group-id="2677016708-4">(</span><span class="n">client</span><span class="o">-</span><span class="n">only</span><span class="p" data-group-id="2677016708-4">)</span><span class="o">.</span><span class="w"> </span><span class="n">certificate</span><span class="o">-</span><span class="n">hint</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">arbitrary</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">management</span><span class="w">
          </span><span class="n">interface</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">NEED</span><span class="o">-</span><span class="nc">CERTIFICATE</span><span class="w"> </span><span class="n">notification</span><span class="o">.</span><span class="w"> </span><span class="nc">Requires</span><span class="w"> </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">external</span><span class="o">-</span><span class="n">key</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">external</span><span class="o">-</span><span class="n">key</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Allows</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">external</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">--</span><span class="n">key</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="p" data-group-id="2677016708-5">(</span><span class="n">client</span><span class="o">-</span><span class="n">only</span><span class="p" data-group-id="2677016708-5">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">management</span><span class="o">-</span><span class="n">external</span><span class="o">-</span><span class="n">key</span><span class="w">
             </span><span class="n">management</span><span class="o">-</span><span class="n">external</span><span class="o">-</span><span class="n">key</span><span class="w"> </span><span class="n">nopadding</span><span class="w">
             </span><span class="n">management</span><span class="o">-</span><span class="n">external</span><span class="o">-</span><span class="n">key</span><span class="w"> </span><span class="n">pkcs1</span><span class="w">
             </span><span class="n">management</span><span class="o">-</span><span class="n">external</span><span class="o">-</span><span class="n">key</span><span class="w"> </span><span class="n">nopadding</span><span class="w"> </span><span class="n">pkcs1</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">nopadding</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">pkcs1</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">padding</span><span class="w"> </span><span class="n">algorithms</span><span class="o">.</span><span class="w"> </span><span class="nc">See</span><span class="w"> </span><span class="n">doc</span><span class="o">/</span><span class="n">mangement</span><span class="o">-</span><span class="n">notes</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">complete</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">of</span><span class="w">
          </span><span class="n">this</span><span class="w"> </span><span class="n">feature</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">forget</span><span class="o">-</span><span class="n">disconnect</span><span class="w">
          </span><span class="nc">Make</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">forget</span><span class="w"> </span><span class="n">passwords</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">disconnects</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">affect</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">cached</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">hold</span><span class="w">
          </span><span class="nc">Start</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">hibernating</span><span class="w"> </span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">starts</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="n">release</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">log</span><span class="o">-</span><span class="n">cache</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Cache</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">channel</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">query</span><span class="o">-</span><span class="n">passwords</span><span class="w">
          </span><span class="nc">Query</span><span class="w">  </span><span class="n">management</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="w"> </span><span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="o">.</span><span class="w"> </span><span class="nc">Only</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">inputs</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">ordinar</span><span class="err">‐</span><span class="w">
          </span><span class="n">ily</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">queried</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">console</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">query</span><span class="o">-</span><span class="n">proxy</span><span class="w">
          </span><span class="nc">Query</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">proxy</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="p" data-group-id="2677016708-6">(</span><span class="n">client</span><span class="o">-</span><span class="n">only</span><span class="p" data-group-id="2677016708-6">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">query</span><span class="o">-</span><span class="n">remote</span><span class="w">
          </span><span class="nc">Allow</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">override</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">directives</span><span class="w"> </span><span class="p" data-group-id="2677016708-7">(</span><span class="n">client</span><span class="o">-</span><span class="n">only</span><span class="p" data-group-id="2677016708-7">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">signal</span><span class="w">
          </span><span class="nc">Send</span><span class="w"> </span><span class="nc">SIGUSR1</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">disconnects</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">wish</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">disconnect</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">user</span><span class="w">  </span><span class="n">logoff</span><span class="o">.</span><span class="w">   </span><span class="nc">For</span><span class="w">
          </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">disconnect</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">SIGTERM</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">management</span><span class="o">-</span><span class="n">up</span><span class="o">-</span><span class="n">down</span><span class="w">
          </span><span class="nc">Report</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">up</span><span class="o">/</span><span class="n">down</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">management</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span></code></pre><p>   Plug-in Interface Options</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">extended</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">loading</span><span class="w"> </span><span class="n">external</span><span class="w"> </span><span class="n">plug</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">modules</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">runtime</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w"> </span><span class="n">plug</span><span class="o">-</span><span class="n">ins</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">prebuilt</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">adhere</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="nc">Plug</span><span class="o">-</span><span class="nc">In</span><span class="w"> </span><span class="nc">API</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">plugin</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Loads</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">plug</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">module</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">plugin</span><span class="w"> </span><span class="n">module</span><span class="o">-</span><span class="n">name</span><span class="w">
             </span><span class="n">plugin</span><span class="w"> </span><span class="n">module</span><span class="o">-</span><span class="n">name</span><span class="w"> </span><span class="s">&quot;arguments&quot;</span><span class="w">

          </span><span class="nc">The</span><span class="w">  </span><span class="n">module</span><span class="o">-</span><span class="n">name</span><span class="w">  </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">argument</span><span class="p">,</span><span class="w"> </span><span class="n">indicating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plug</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">passed</span><span class="w">
          </span><span class="n">directly</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plug</span><span class="o">-</span><span class="ow">in</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">enclosed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">double</span><span class="o">-</span><span class="n">quotes</span><span class="w"> </span><span class="p" data-group-id="3823584469-1">(</span><span class="err">&quot;</span><span class="p" data-group-id="3823584469-1">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Multiple</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">modules</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w">  </span><span class="n">loaded</span><span class="w">
          </span><span class="n">into</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w">  </span><span class="n">module</span><span class="o">-</span><span class="n">name</span><span class="w">  </span><span class="n">argument</span><span class="w">  </span><span class="n">can</span><span class="w">  </span><span class="n">be</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">filename</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">filename</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">relative</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">absolute</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filename</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">defines</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w">
          </span><span class="n">plug</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">plug</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">directory</span><span class="o">.</span><span class="w">

             </span><span class="o">--</span><span class="n">plugin</span><span class="w"> </span><span class="n">path</span><span class="w">         </span><span class="nc">Effective</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">used</span><span class="w">
             </span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="w"> </span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">==</span><span class="w">
              </span><span class="n">myplug</span><span class="o">.</span><span class="n">so</span><span class="w">            </span><span class="nc">DEFAULT_DIR</span><span class="o">/</span><span class="n">myplug</span><span class="o">.</span><span class="n">so</span><span class="w">
              </span><span class="n">subdir</span><span class="o">/</span><span class="n">myplug</span><span class="o">.</span><span class="n">so</span><span class="w">     </span><span class="nc">DEFAULT_DIR</span><span class="o">/</span><span class="n">subdir</span><span class="o">/</span><span class="n">myplug</span><span class="o">.</span><span class="n">so</span><span class="w">
              </span><span class="o">.</span><span class="o">/</span><span class="n">subdir</span><span class="o">/</span><span class="n">myplug</span><span class="o">.</span><span class="n">so</span><span class="w">   </span><span class="nc">CWD</span><span class="o">/</span><span class="n">subdir</span><span class="o">/</span><span class="n">myplug</span><span class="o">.</span><span class="n">so</span><span class="w">
              </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">plug</span><span class="o">.</span><span class="n">so</span><span class="w">  </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">plug</span><span class="o">.</span><span class="n">so</span><span class="w">

          </span><span class="nc">DEFAULT_DIR</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">replaced</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">plug</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">directory</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="o">.</span><span class="w"> </span><span class="nc">CWD</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w">
          </span><span class="n">was</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">switched</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">cd</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">plugin</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

          </span><span class="nc">For</span><span class="w">  </span><span class="n">more</span><span class="w">  </span><span class="n">information</span><span class="w">  </span><span class="ow">and</span><span class="w"> </span><span class="n">examples</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">plug</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">modules</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">README</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">folder</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">distribu</span><span class="err">‐</span><span class="w">
          </span><span class="n">tion</span><span class="o">.</span><span class="w">

          </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">RPM</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">openvpn</span><span class="o">/</span><span class="n">plugin</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">documentation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">doc</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">modules</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">lib</span><span class="o">.</span><span class="w">

          </span><span class="nc">Multiple</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">modules</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">cascaded</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">modules</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tandem</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">scripts</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">modules</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">that</span><span class="w">  </span><span class="n">they</span><span class="w">
          </span><span class="n">are</span><span class="w">  </span><span class="n">declared</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">callback</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">last</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">code</span><span class="w">
          </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">module</span><span class="o">/</span><span class="n">script</span><span class="w"> </span><span class="n">controls</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p" data-group-id="3823584469-2">(</span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">verify</span><span class="p">,</span><span class="w"> </span><span class="n">auth</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="o">-</span><span class="n">verify</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">connect</span><span class="p" data-group-id="3823584469-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="ow">and</span><span class="w">  </span><span class="n">script</span><span class="w">
          </span><span class="n">must</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="p" data-group-id="3823584469-3">(</span><span class="mi">0</span><span class="p" data-group-id="3823584469-3">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">authenticated</span><span class="o">.</span></code></pre><p>   Windows-Specific Options</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="o">--</span><span class="n">allow</span><span class="o">-</span><span class="n">nonadmin</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="n">adapter</span><span class="w">
          </span><span class="p" data-group-id="5508127138-1">(</span><span class="nc">Standalone</span><span class="p" data-group-id="5508127138-1">)</span><span class="w">  </span><span class="nc">Set</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="n">adapter</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">administrative</span><span class="w"> </span><span class="n">accounts</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="n">adapter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">TAP</span><span class="w"> </span><span class="n">adapters</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">con</span><span class="err">‐</span><span class="w">
          </span><span class="n">figured</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">admin</span><span class="w"> </span><span class="n">access</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">admin</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">persist</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">object</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">driver</span><span class="w">
          </span><span class="n">remain</span><span class="w">  </span><span class="n">loaded</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">enabled</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">reboot</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">driver</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">unloaded</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reloaded</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">admin</span><span class="err">‐</span><span class="w">
          </span><span class="n">istrator</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">block</span><span class="o">-</span><span class="n">outside</span><span class="o">-</span><span class="n">dns</span><span class="w">
          </span><span class="nc">Block</span><span class="w"> </span><span class="nc">DNS</span><span class="w"> </span><span class="n">servers</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">adapters</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="nc">DNS</span><span class="w"> </span><span class="n">leaks</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">prevents</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">accessing</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">port</span><span class="w">  </span><span class="mi">53</span><span class="w">  </span><span class="n">except</span><span class="w">  </span><span class="n">one</span><span class="w">
          </span><span class="n">inside</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="nc">Filtering</span><span class="w"> </span><span class="nc">Platform</span><span class="w"> </span><span class="p" data-group-id="5508127138-2">(</span><span class="nc">WFP</span><span class="p" data-group-id="5508127138-2">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="nc">Vista</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">later</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w">  </span><span class="n">option</span><span class="w">  </span><span class="n">is</span><span class="w"> </span><span class="n">considered</span><span class="w"> </span><span class="n">unknown</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">Windows</span><span class="w"> </span><span class="n">platforms</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">unsupported</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="nc">XP</span><span class="p">,</span><span class="w"> </span><span class="n">resulting</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">fatal</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w"> </span><span class="nc">You</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="o">--</span><span class="n">setenv</span><span class="w"> </span><span class="n">opt</span><span class="w">
          </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">ignore</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">option</span><span class="w"> </span><span class="p" data-group-id="5508127138-3">(</span><span class="ow">not</span><span class="w"> </span><span class="n">suitable</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="nc">XP</span><span class="p" data-group-id="5508127138-3">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ignore</span><span class="w"> </span><span class="n">said</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">pushing</span><span class="w"> </span><span class="n">unknown</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">does</span><span class="w">  </span><span class="ow">not</span><span class="w">  </span><span class="n">trigger</span><span class="w">  </span><span class="n">fatal</span><span class="w">
          </span><span class="n">errors</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">cryptoapicert</span><span class="w"> </span><span class="n">select</span><span class="o">-</span><span class="n">string</span><span class="w">
          </span><span class="p" data-group-id="5508127138-4">(</span><span class="nc">Windows</span><span class="o">/</span><span class="nc">OpenSSL</span><span class="w"> </span><span class="nc">Only</span><span class="p" data-group-id="5508127138-4">)</span><span class="w"> </span><span class="nc">Load</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="nc">Certificate</span><span class="w"> </span><span class="nc">System</span><span class="w"> </span><span class="nc">Store</span><span class="o">.</span><span class="w">

          </span><span class="nc">Use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">--</span><span class="n">cert</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">key</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w">  </span><span class="n">makes</span><span class="w">  </span><span class="n">it</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">smart</span><span class="w"> </span><span class="n">card</span><span class="p">,</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">Windows</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">kind</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">certificate</span><span class="p">,</span><span class="w"> </span><span class="n">residing</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Cert</span><span class="w"> </span><span class="nc">Store</span><span class="p">,</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">ac</span><span class="err">‐</span><span class="w">
          </span><span class="n">cess</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">tested</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">couple</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">smart</span><span class="w"> </span><span class="n">cards</span><span class="w"> </span><span class="p" data-group-id="5508127138-5">(</span><span class="nc">GemSAFE</span><span class="p">,</span><span class="w"> </span><span class="nc">Cryptoflex</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Swedish</span><span class="w"> </span><span class="nc">Post</span><span class="w"> </span><span class="nc">Office</span><span class="w"> </span><span class="n">eID</span><span class="p" data-group-id="5508127138-5">)</span><span class="w"> </span><span class="n">on</span><span class="w">  </span><span class="n">the</span><span class="w">
          </span><span class="n">client</span><span class="w"> </span><span class="n">side</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">imported</span><span class="w"> </span><span class="nc">PKCS12</span><span class="w"> </span><span class="n">software</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">side</span><span class="o">.</span><span class="w">

          </span><span class="nc">To</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">certificate</span><span class="p">,</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">substring</span><span class="w"> </span><span class="n">search</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span><span class="sc">&#39;s subject:

             cryptoapicert &quot;SUBJ:Peter Runestig&quot;

          To select a certificate, based on certificate&#39;</span><span class="n">s</span><span class="w"> </span><span class="ss">thumbprint</span><span class="p">:</span><span class="w">

             </span><span class="n">cryptoapicert</span><span class="w"> </span><span class="s">&quot;THUMB:f6 49 24 41 01 b4 ...&quot;</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">thumbprint</span><span class="w"> </span><span class="n">hex</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">easily</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">copy</span><span class="o">-</span><span class="ow">and</span><span class="o">-</span><span class="n">pasted</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="nc">Certificate</span><span class="w"> </span><span class="nc">Store</span><span class="w"> </span><span class="nc">GUI</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">dhcp</span><span class="o">-</span><span class="n">release</span><span class="w">
          </span><span class="nc">Ask</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">release</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">lease</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">shutdown</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">effect</span><span class="w"> </span><span class="n">now</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.4</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">dhcp</span><span class="o">-</span><span class="n">renew</span><span class="w">
          </span><span class="nc">Ask</span><span class="w">  </span><span class="nc">Windows</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">renew</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">lease</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">startup</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">unnecessary</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">triggers</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">renegotiation</span><span class="w"> </span><span class="n">on</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">comes</span><span class="w"> </span><span class="n">up</span><span class="p">,</span><span class="w"> </span><span class="n">however</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="nc">Media</span><span class="w"> </span><span class="nc">Status</span><span class="w"> </span><span class="n">property</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s">&quot;Always Connected&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">flag</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">ip</span><span class="o">-</span><span class="n">win32</span><span class="w"> </span><span class="n">method</span><span class="w">
          </span><span class="nc">When</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Windows</span><span class="p">,</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">netmask</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">method</span><span class="o">.</span><span class="w"> </span><span class="nc">Don</span><span class="sc">&#39;t use this option unless you are also using --if‐
          config.

          manual Don&#39;</span><span class="n">t</span><span class="w">  </span><span class="n">set</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">netmask</span><span class="w"> </span><span class="n">automatically</span><span class="o">.</span><span class="w"> </span><span class="nc">Instead</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">console</span><span class="w"> </span><span class="n">telling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">configure</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">manually</span><span class="w">
                 </span><span class="ow">and</span><span class="w"> </span><span class="n">indicating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="o">/</span><span class="n">netmask</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">expects</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="o">.</span><span class="w">

          </span><span class="n">dynamic</span><span class="w"> </span><span class="p" data-group-id="5508127138-6">[</span><span class="n">offset</span><span class="p" data-group-id="5508127138-6">]</span><span class="w"> </span><span class="p" data-group-id="5508127138-7">[</span><span class="n">lease</span><span class="o">-</span><span class="n">time</span><span class="p" data-group-id="5508127138-7">]</span><span class="w">
                 </span><span class="nc">Automatically</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">netmask</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">replying</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">probably</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="s">&quot;cleanest&quot;</span><span class="w">
                 </span><span class="n">solution</span><span class="w">  </span><span class="k">for</span><span class="w">  </span><span class="n">setting</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">IP</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">well</span><span class="o">-</span><span class="n">known</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">protocol</span><span class="o">.</span><span class="w"> </span><span class="nc">There</span><span class="w"> </span><span class="n">are</span><span class="p">,</span><span class="w"> </span><span class="n">however</span><span class="p">,</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">prerequisites</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">this</span><span class="w">
                 </span><span class="ss">mode</span><span class="p">:</span><span class="w">

                 </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">IP</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s">&quot;Obtain an IP address automatically&quot;</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w">

                 </span><span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">claim</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">subnet</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">address</span><span class="o">.</span><span class="w">

                 </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tap</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">unused</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">subnet</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w">  </span><span class="n">your</span><span class="w">  </span><span class="n">subnet</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">4.0</span><span class="w">
                 </span><span class="n">netmask</span><span class="w"> </span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">4.0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">address</span><span class="o">.</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w">
                 </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">masquerade</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">coming</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">endpoint</span><span class="o">.</span><span class="w">

                 </span><span class="nc">The</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">integer</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">-</span><span class="mi">256</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">256</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">positive</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="nc">DHCP</span><span class="w">  </span><span class="n">server</span><span class="w">  </span><span class="n">will</span><span class="w">
                 </span><span class="n">masquerade</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">offset</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">negative</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">masquerade</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">broadcast</span><span class="w">
                 </span><span class="n">address</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">offset</span><span class="o">.</span><span class="w">

                 </span><span class="nc">The</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">ipconfig</span><span class="w"> </span><span class="o">/</span><span class="n">all</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">thinks</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">is</span><span class="o">.</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w">  </span><span class="s">&quot;claim&quot;</span><span class="w">  </span><span class="n">this</span><span class="w">  </span><span class="n">address</span><span class="p">,</span><span class="w">  </span><span class="n">so</span><span class="w">
                 </span><span class="n">make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">address</span><span class="o">.</span><span class="w"> </span><span class="nc">Having</span><span class="w"> </span><span class="n">said</span><span class="w"> </span><span class="n">that</span><span class="p">,</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">instantiations</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">ends</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">connection</span><span class="p">,</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">share</span><span class="w">
                 </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">address</span><span class="o">.</span><span class="w">

                 </span><span class="nc">The</span><span class="w"> </span><span class="n">lease</span><span class="o">-</span><span class="n">time</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">controls</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">lease</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">assignment</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">denoted</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">seconds</span><span class="o">.</span><span class="w">  </span><span class="nc">Normally</span><span class="w">  </span><span class="n">a</span><span class="w">
                 </span><span class="n">very</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">lease</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">preferred</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">prevents</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">involving</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">lost</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">goes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">sleep</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w">
                 </span><span class="n">default</span><span class="w"> </span><span class="n">lease</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">year</span><span class="o">.</span><span class="w">

          </span><span class="n">netsh</span><span class="w">  </span><span class="nc">Automatically</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">netmask</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">command</span><span class="o">-</span><span class="n">line</span><span class="w"> </span><span class="s">&quot;netsh&quot;</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">appears</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">correctly</span><span class="w">  </span><span class="n">on</span><span class="w">  </span><span class="nc">Windows</span><span class="w">
                 </span><span class="nc">XP</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="mi">2000</span><span class="o">.</span><span class="w">

          </span><span class="n">ipapi</span><span class="w">  </span><span class="nc">Automatically</span><span class="w">  </span><span class="n">set</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">netmask</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="nc">Helper</span><span class="w"> </span><span class="nc">API</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">approach</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">ideal</span><span class="w"> </span><span class="n">semantics</span><span class="p">,</span><span class="w"> </span><span class="n">though</span><span class="w"> </span><span class="n">testing</span><span class="w"> </span><span class="n">has</span><span class="w">
                 </span><span class="n">indicated</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="n">okay</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">practice</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">best</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">IP</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="ow">in</span><span class="w">  </span><span class="n">their</span><span class="w">
                 </span><span class="n">default</span><span class="w"> </span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="s">&quot;Obtain an IP address automatically.&quot;</span><span class="w">

          </span><span class="n">adaptive</span><span class="w"> </span><span class="p" data-group-id="5508127138-8">(</span><span class="nc">Default</span><span class="p" data-group-id="5508127138-8">)</span><span class="w">
                 </span><span class="nc">Try</span><span class="w">  </span><span class="n">dynamic</span><span class="w">  </span><span class="n">method</span><span class="w">  </span><span class="n">initially</span><span class="w">  </span><span class="ow">and</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">netsh</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">succeed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="n">seconds</span><span class="o">.</span><span class="w"> </span><span class="nc">Such</span><span class="w">
                 </span><span class="n">failures</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">occur</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="n">third</span><span class="o">-</span><span class="n">party</span><span class="w"> </span><span class="n">firewall</span><span class="w"> </span><span class="n">packages</span><span class="w"> </span><span class="n">installed</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">machine</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w">
                 </span><span class="n">the</span><span class="w">  </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w">  </span><span class="n">adapter</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">netsh</span><span class="w"> </span><span class="n">failover</span><span class="w"> </span><span class="n">occurs</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">IP</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">static</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w">
                 </span><span class="n">this</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">startups</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">adaptive</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">netsh</span><span class="w"> </span><span class="n">immediately</span><span class="p">,</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">trying</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">first</span><span class="o">.</span><span class="w">

                 </span><span class="nc">To</span><span class="w"> </span><span class="s">&quot;unstick&quot;</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">adaptive</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">netsh</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">once</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">restore</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">IP</span><span class="w"> </span><span class="n">prop</span><span class="err">‐</span><span class="w">
                 </span><span class="n">erties</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">configuration</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">pause</span><span class="o">-</span><span class="n">exit</span><span class="w">
          </span><span class="nc">Put</span><span class="w">  </span><span class="n">up</span><span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="s">&quot;press any key to continue&quot;</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">console</span><span class="w"> </span><span class="n">prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">exit</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">explorer</span><span class="w">
          </span><span class="ow">when</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">right</span><span class="o">-</span><span class="n">click</span><span class="w"> </span><span class="n">explorer</span><span class="w"> </span><span class="n">menu</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">register</span><span class="o">-</span><span class="n">dns</span><span class="w">
          </span><span class="nc">Run</span><span class="w"> </span><span class="n">ipconfig</span><span class="w"> </span><span class="o">/</span><span class="n">flushdns</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ipconfig</span><span class="w"> </span><span class="o">/</span><span class="n">registerdns</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">initiation</span><span class="o">.</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">kick</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">recognizing</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="nc">DNS</span><span class="w"> </span><span class="n">servers</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">route</span><span class="o">-</span><span class="n">method</span><span class="w"> </span><span class="n">m</span><span class="w">
          </span><span class="nc">Which</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Windows</span><span class="sc">?
</span><span class="w">
          </span><span class="n">adaptive</span><span class="w"> </span><span class="p" data-group-id="5508127138-9">(</span><span class="n">default</span><span class="p" data-group-id="5508127138-9">)</span><span class="w">
                 </span><span class="nc">Try</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">helper</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">first</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">fails</span><span class="p">,</span><span class="w"> </span><span class="n">fall</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">route</span><span class="o">.</span><span class="n">exe</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">

          </span><span class="n">ipapi</span><span class="w">  </span><span class="nc">Use</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">helper</span><span class="w"> </span><span class="nc">API</span><span class="o">.</span><span class="w">

          </span><span class="n">exe</span><span class="w">    </span><span class="nc">Call</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">route</span><span class="o">.</span><span class="n">exe</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">service</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">executed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">interaction</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">key</span><span class="err">‐</span><span class="w">
          </span><span class="n">board</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">possible</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">service</span><span class="w"> </span><span class="n">exit</span><span class="o">-</span><span class="n">event</span><span class="w"> </span><span class="p" data-group-id="5508127138-10">[</span><span class="mi">0</span><span class="o">|</span><span class="mi">1</span><span class="p" data-group-id="5508127138-10">]</span><span class="w">

          </span><span class="nc">In</span><span class="w">  </span><span class="n">general</span><span class="p">,</span><span class="w"> </span><span class="k">end</span><span class="o">-</span><span class="n">users</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">wrapper</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="nc">Open</span><span class="err">‐</span><span class="w">
          </span><span class="nc">VPN</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">service</span><span class="o">.</span><span class="w">

          </span><span class="n">exit</span><span class="o">-</span><span class="n">event</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">object</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">continuously</span><span class="w"> </span><span class="n">monitor</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">becomes</span><span class="w">
          </span><span class="n">signaled</span><span class="o">.</span><span class="w">

          </span><span class="nc">The</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">exit</span><span class="o">-</span><span class="n">event</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">normally</span><span class="w"> </span><span class="n">defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="w">

          </span><span class="nc">Multiple</span><span class="w">  </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="n">processes</span><span class="w">  </span><span class="n">can</span><span class="w">  </span><span class="n">be</span><span class="w">  </span><span class="n">simultaneously</span><span class="w">  </span><span class="n">executed</span><span class="w">  </span><span class="k">with</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">same</span><span class="w"> </span><span class="n">exit</span><span class="o">-</span><span class="n">event</span><span class="w"> </span><span class="n">parameter</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="k">case</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">controlling</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">signal</span><span class="w">
          </span><span class="n">exit</span><span class="o">-</span><span class="n">event</span><span class="p">,</span><span class="w"> </span><span class="n">causing</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">processes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">exit</span><span class="o">.</span><span class="w">

          </span><span class="nc">When</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">service</span><span class="w"> </span><span class="n">directive</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">probably</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">console</span><span class="w">  </span><span class="n">window</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">output</span><span class="w">  </span><span class="n">status</span><span class="o">/</span><span class="n">error</span><span class="w">  </span><span class="n">messages</span><span class="p">,</span><span class="w">
          </span><span class="n">therefore</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="o">--</span><span class="n">log</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">log</span><span class="o">-</span><span class="n">append</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">adapters</span><span class="w">
          </span><span class="p" data-group-id="5508127138-11">(</span><span class="nc">Standalone</span><span class="p" data-group-id="5508127138-11">)</span><span class="w"> </span><span class="nc">Show</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapters</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">selected</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="o">-</span><span class="n">node</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w"> </span><span class="nc">On</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">Windows</span><span class="w"> </span><span class="n">systems</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ifconfig</span><span class="p" data-group-id="5508127138-12">(</span><span class="mi">8</span><span class="p" data-group-id="5508127138-12">)</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">pro</span><span class="err">‐</span><span class="w">
          </span><span class="n">vides</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">functionality</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">net</span><span class="w">
          </span><span class="p" data-group-id="5508127138-13">(</span><span class="nc">Standalone</span><span class="p" data-group-id="5508127138-13">)</span><span class="w"> </span><span class="nc">Show</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="sc">&#39;s view of the system routing table and network adapter list.

   --show-net-up
          Output OpenVPN&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">view</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">syslog</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">brought</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="ow">and</span><span class="w">
          </span><span class="n">any</span><span class="w"> </span><span class="n">routes</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">added</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">valid</span><span class="o">-</span><span class="n">subnets</span><span class="w">
          </span><span class="p" data-group-id="5508127138-14">(</span><span class="nc">Standalone</span><span class="p" data-group-id="5508127138-14">)</span><span class="w">  </span><span class="nc">Show</span><span class="w">  </span><span class="n">valid</span><span class="w">  </span><span class="n">subnets</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">emulation</span><span class="o">.</span><span class="w"> </span><span class="nc">Since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">driver</span><span class="w"> </span><span class="n">exports</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">ethernet</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">Windows</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="nc">TUN</span><span class="w"> </span><span class="n">devices</span><span class="w">
          </span><span class="n">are</span><span class="w"> </span><span class="n">point</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">point</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">nature</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">necessary</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">driver</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">impose</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="n">constraints</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">TUN</span><span class="w"> </span><span class="n">endpoint</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">selection</span><span class="o">.</span><span class="w">

          </span><span class="nc">Namely</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">point</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">point</span><span class="w"> </span><span class="n">endpoints</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">TUN</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">emulation</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">middle</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">/</span><span class="mi">30</span><span class="w"> </span><span class="n">subnet</span><span class="w"> </span><span class="p" data-group-id="5508127138-15">(</span><span class="n">netmask</span><span class="w"> </span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.252</span><span class="p" data-group-id="5508127138-15">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tap</span><span class="o">-</span><span class="n">sleep</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Cause</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">sleep</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s">&quot;connected&quot;</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">intended</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">troubleshoot</span><span class="w"> </span><span class="n">problems</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">ip</span><span class="o">-</span><span class="n">win32</span><span class="w"> </span><span class="n">options</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">give</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TAP</span><span class="o">-</span><span class="nc">Win32</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">time</span><span class="w">
          </span><span class="n">to</span><span class="w"> </span><span class="n">come</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="nc">Helper</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">operations</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">win</span><span class="o">-</span><span class="n">sys</span><span class="w"> </span><span class="n">path</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Windows</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">pathname</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">looking</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">executables</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">route</span><span class="o">.</span><span class="n">exe</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">netsh</span><span class="o">.</span><span class="n">exe</span><span class="o">.</span><span class="w"> </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">directive</span><span class="w"> </span><span class="n">is</span><span class="w">
          </span><span class="ow">not</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SystemRoot</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variable</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="n">behaviour</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.3</span><span class="o">.</span><span class="w"> </span><span class="nc">Earlier</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">define</span><span class="w"> </span><span class="o">--</span><span class="n">win</span><span class="o">-</span><span class="n">sys</span><span class="w"> </span><span class="n">env</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SystemRoot</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">otherwise</span><span class="w">  </span><span class="n">it</span><span class="w">
          </span><span class="n">defaulted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">C</span><span class="ss">:\\</span><span class="nc">WINDOWS</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">env</span><span class="w"> </span><span class="n">keyword</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">more</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">ignored</span><span class="o">.</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="n">warning</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">logged</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w">
          </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">windows</span><span class="o">-</span><span class="n">driver</span><span class="w"> </span><span class="n">drv</span><span class="w">
          </span><span class="nc">Specifies</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">tun</span><span class="w"> </span><span class="n">driver</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="o">.</span><span class="w"> </span><span class="nc">Values</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">tap</span><span class="o">-</span><span class="n">windows6</span><span class="w"> </span><span class="p" data-group-id="5508127138-16">(</span><span class="n">default</span><span class="p" data-group-id="5508127138-16">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">wintun</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">Windows</span><span class="o">-</span><span class="n">only</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">  </span><span class="n">wintun</span><span class="err">&quot;</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">the</span><span class="w">
          </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">elevated</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">invoked</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Interactive</span><span class="w"> </span><span class="nc">Service</span><span class="o">.</span></code></pre><p>   Standalone Debug Options</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">gateway</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="p" data-group-id="0695132526-1">(</span><span class="nc">Standalone</span><span class="p" data-group-id="0695132526-1">)</span><span class="w"> </span><span class="nc">Show</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">towards</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="p" data-group-id="0695132526-2">(</span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">question</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="p" data-group-id="0695132526-2">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">gateway</span><span class="w">
             </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">gateway</span><span class="w"> </span><span class="nc">IPv6</span><span class="o">-</span><span class="n">target</span><span class="w">

          </span><span class="nc">For</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">queries</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">towards</span><span class="w"> </span><span class="o">::</span><span class="o">/</span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">argument</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">Linux</span><span class="p">,</span><span class="w"> </span><span class="nc">Windows</span><span class="p">,</span><span class="w"> </span><span class="nc">MacOS</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">BSD</span><span class="w">
          </span><span class="n">it</span><span class="w"> </span><span class="n">looks</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span><span class="w"> </span><span class="n">route</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">routes</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">packets</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="nc">VPN</span><span class="w">
          </span><span class="n">gateway</span><span class="o">.</span></code></pre><p>   Advanced Expert Options</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">These</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">required</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">tweaking</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">needed</span><span class="p">,</span><span class="w"> </span><span class="n">often</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">debugging</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">testing</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">scenarios</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">hash</span><span class="o">-</span><span class="n">size</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">real</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">v</span><span class="o">.</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntax</span><span class="p">:</span><span class="w">

             </span><span class="n">hash</span><span class="o">-</span><span class="n">size</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="n">v</span><span class="w">

          </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">tables</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">sized</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="mi">256</span><span class="w"> </span><span class="n">buckets</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">bcast</span><span class="o">-</span><span class="n">buffers</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Allocate</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">buffers</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">broadcast</span><span class="w"> </span><span class="n">datagrams</span><span class="w"> </span><span class="p" data-group-id="8247607136-1">(</span><span class="n">default</span><span class="w"> </span><span class="mi">256</span><span class="p" data-group-id="8247607136-1">)</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">persist</span><span class="o">-</span><span class="n">local</span><span class="o">-</span><span class="n">ip</span><span class="w">
          </span><span class="nc">Preserve</span><span class="w"> </span><span class="n">initially</span><span class="w"> </span><span class="n">resolved</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="nc">SIGUSR1</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="o">-</span><span class="n">restart</span><span class="w"> </span><span class="n">restarts</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">persist</span><span class="o">-</span><span class="n">remote</span><span class="o">-</span><span class="n">ip</span><span class="w">
          </span><span class="nc">Preserve</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">recently</span><span class="w"> </span><span class="n">authenticated</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="nc">SIGUSR1</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="o">-</span><span class="n">restart</span><span class="w"> </span><span class="n">restarts</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">prng</span><span class="w"> </span><span class="n">args</span><span class="w">
          </span><span class="p" data-group-id="8247607136-2">(</span><span class="nc">Advanced</span><span class="p" data-group-id="8247607136-2">)</span><span class="w"> </span><span class="nc">Change</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PRNG</span><span class="w"> </span><span class="p" data-group-id="8247607136-3">(</span><span class="nc">Pseudo</span><span class="o">-</span><span class="n">random</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">generator</span><span class="p" data-group-id="8247607136-3">)</span><span class="w"> </span><span class="n">parameters</span><span class="w">

          </span><span class="nc">Valid</span><span class="w"> </span><span class="ss">syntaxes</span><span class="p">:</span><span class="w">

             </span><span class="n">prng</span><span class="w"> </span><span class="n">alg</span><span class="w">
             </span><span class="n">prng</span><span class="w"> </span><span class="n">alg</span><span class="w"> </span><span class="n">nsl</span><span class="w">

          </span><span class="nc">Changes</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="nc">PRNG</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">digest</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="n">alg</span><span class="w"> </span><span class="p" data-group-id="8247607136-4">(</span><span class="n">default</span><span class="w"> </span><span class="n">sha1</span><span class="p" data-group-id="8247607136-4">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">nsl</span><span class="w"> </span><span class="p" data-group-id="8247607136-5">(</span><span class="n">default</span><span class="w"> </span><span class="mi">16</span><span class="p" data-group-id="8247607136-5">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">nonce</span><span class="w"> </span><span class="n">secret</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="p" data-group-id="8247607136-6">(</span><span class="n">between</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="ow">and</span><span class="w">
          </span><span class="mi">64</span><span class="p" data-group-id="8247607136-6">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">Set</span><span class="w"> </span><span class="n">alg</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">none</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PRNG</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="nc">RAND_bytes</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">random</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">needs</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">rcvbuf</span><span class="w"> </span><span class="n">size</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">UDP</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="n">size</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">default</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">shaper</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Limit</span><span class="w"> </span><span class="n">bandwidth</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">outgoing</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">UDP</span><span class="w"> </span><span class="n">port</span><span class="o">.</span><span class="w"> </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">p2p</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w">  </span><span class="n">you</span><span class="w">  </span><span class="n">want</span><span class="w">
          </span><span class="n">to</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">bandwidth</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">directions</span><span class="p">,</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">peers</span><span class="o">.</span><span class="w">

          </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="n">uses</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">following</span><span class="w">  </span><span class="n">algorithm</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="ss">shaping</span><span class="p">:</span><span class="w"> </span><span class="nc">Given</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">shaper</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">second</span><span class="p">,</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">datagram</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">is</span><span class="w">
          </span><span class="n">queued</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">UDP</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"> </span><span class="n">wait</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">minimum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="p" data-group-id="8247607136-7">(</span><span class="n">b</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">n</span><span class="p" data-group-id="8247607136-7">)</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">queuing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">write</span><span class="o">.</span><span class="w">

          </span><span class="nc">It</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">noted</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">tunnels</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">peers</span><span class="p">,</span><span class="w"> </span><span class="n">allowing</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">construct</span><span class="w"> </span><span class="n">full</span><span class="o">-</span><span class="n">speed</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reduced</span><span class="w"> </span><span class="n">bandwidth</span><span class="w">  </span><span class="n">tun</span><span class="err">‐</span><span class="w">
          </span><span class="n">nels</span><span class="w">  </span><span class="n">at</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="n">low</span><span class="o">-</span><span class="n">priority</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">off</span><span class="o">-</span><span class="n">site</span><span class="w"> </span><span class="n">backups</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">reduced</span><span class="w"> </span><span class="n">bandwidth</span><span class="w"> </span><span class="n">tunnel</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">full</span><span class="o">-</span><span class="n">speed</span><span class="w"> </span><span class="n">tun</span><span class="err">‐</span><span class="w">
          </span><span class="n">nel</span><span class="o">.</span><span class="w">

          </span><span class="nc">Also</span><span class="w"> </span><span class="n">note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="n">bandwidth</span><span class="w"> </span><span class="n">tunnels</span><span class="w"> </span><span class="p" data-group-id="8247607136-8">(</span><span class="n">under</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">second</span><span class="p" data-group-id="8247607136-8">)</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">probably</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="nc">MTU</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="p" data-group-id="8247607136-9">(</span><span class="n">see</span><span class="w">  </span><span class="n">above</span><span class="p" data-group-id="8247607136-9">)</span><span class="p">,</span><span class="w">  </span><span class="n">otherwise</span><span class="w">  </span><span class="n">the</span><span class="w">
          </span><span class="n">packet</span><span class="w"> </span><span class="n">latency</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">grow</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">trigger</span><span class="w"> </span><span class="n">timeouts</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">layer</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="o">.</span><span class="w">

          </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="n">bytes</span><span class="o">/</span><span class="n">sec</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="nc">Mbytes</span><span class="o">/</span><span class="n">sec</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">sndbuf</span><span class="w"> </span><span class="n">size</span><span class="w">
          </span><span class="nc">Set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="nc">UDP</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="n">size</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">default</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">tcp</span><span class="o">-</span><span class="n">queue</span><span class="o">-</span><span class="n">limit</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="nc">Maximum</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">queued</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="p" data-group-id="8247607136-10">(</span><span class="n">default</span><span class="w"> </span><span class="mi">64</span><span class="p" data-group-id="8247607136-10">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">When</span><span class="w">  </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">tunneling</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">connection</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">produce</span><span class="w">
          </span><span class="n">data</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">faster</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">queued</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">sending</span><span class="w"> </span><span class="n">to</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="nc">TCP</span><span class="w">  </span><span class="n">socket</span><span class="w">  </span><span class="n">reaches</span><span class="w">  </span><span class="n">this</span><span class="w">
          </span><span class="n">limit</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">connection</span><span class="p">,</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="n">outgoing</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">directed</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">txqueuelen</span><span class="w"> </span><span class="n">n</span><span class="w">
          </span><span class="p" data-group-id="8247607136-11">(</span><span class="nc">Linux</span><span class="w"> </span><span class="n">only</span><span class="p" data-group-id="8247607136-11">)</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TX</span><span class="w"> </span><span class="n">queue</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w">  </span><span class="nc">Currently</span><span class="w"> </span><span class="n">defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">default</span><span class="o">.</span></code></pre><p>UNSUPPORTED OPTIONS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Options</span><span class="w"> </span><span class="n">listed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="n">supported</span><span class="w">

   </span><span class="o">--</span><span class="n">client</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="ow">not</span><span class="o">-</span><span class="n">required</span><span class="w">
          </span><span class="nc">Removed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.5</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">replaxed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">verify</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">cert</span><span class="w"> </span><span class="n">none</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">ifconfig</span><span class="o">-</span><span class="n">pool</span><span class="o">-</span><span class="n">linear</span><span class="w">
          </span><span class="nc">Removed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.5</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">replaced</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">topology</span><span class="w"> </span><span class="n">p2p</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">key</span><span class="o">-</span><span class="n">method</span><span class="w">
          </span><span class="nc">Removed</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="mf">2.5</span><span class="o">.</span><span class="w">   </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">key</span><span class="o">-</span><span class="n">method</span><span class="w"> </span><span class="n">weakens</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">security</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">key</span><span class="o">-</span><span class="n">method</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">also</span><span class="w">
          </span><span class="n">only</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.0</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">iv</span><span class="w">
          </span><span class="nc">Removed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.5</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">weakens</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">security</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NOOP</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.4</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">replay</span><span class="w">
          </span><span class="nc">Removed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.5</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">weakens</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">security</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">ns</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">type</span><span class="w">
          </span><span class="nc">Removed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="mf">2.5</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">nsCertType</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="nc">SSL</span><span class="o">/</span><span class="nc">TLS</span><span class="w"> </span><span class="n">libraries</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="ow">and</span><span class="w">
          </span><span class="n">extended</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">upgraded</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">tls</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">instead</span><span class="o">.</span></code></pre><p>CONNECTION PROFILES</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Client</span><span class="w">  </span><span class="n">configuration</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">servers</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">attempt</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">against</span><span class="o">.</span><span class="w">  </span><span class="nc">But</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">are</span><span class="w">
   </span><span class="n">related</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">cases</span><span class="p">,</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">solution</span><span class="o">.</span><span class="w">

   </span><span class="nc">By</span><span class="w"> </span><span class="n">enacpulating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">related</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">&lt;</span><span class="o">/</span><span class="n">connection</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">handled</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">group</span><span class="o">.</span><span class="w">

   </span><span class="nc">An</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">sequentially</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">achieves</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">successful</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w">

   </span><span class="o">--</span><span class="n">remote</span><span class="o">-</span><span class="n">random</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">initially</span><span class="w"> </span><span class="s">&quot;scramble&quot;</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

   </span><span class="nc">Here</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="ss">usage</span><span class="p">:</span><span class="w">

      </span><span class="n">client</span><span class="w">
      </span><span class="n">dev</span><span class="w"> </span><span class="n">tun</span><span class="w">

      </span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="w">
      </span><span class="n">remote</span><span class="w"> </span><span class="mf">198.19</span><span class="o">.</span><span class="mf">34.56</span><span class="w"> </span><span class="mi">1194</span><span class="w"> </span><span class="n">udp</span><span class="w">
      </span><span class="o">&lt;</span><span class="o">/</span><span class="n">connection</span><span class="o">&gt;</span><span class="w">

      </span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="w">
      </span><span class="n">remote</span><span class="w"> </span><span class="mf">198.19</span><span class="o">.</span><span class="mf">34.56</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="n">tcp</span><span class="w">
      </span><span class="o">&lt;</span><span class="o">/</span><span class="n">connection</span><span class="o">&gt;</span><span class="w">

      </span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="w">
      </span><span class="n">remote</span><span class="w"> </span><span class="mf">198.19</span><span class="o">.</span><span class="mf">34.56</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="n">tcp</span><span class="w">
      </span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="w"> </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">0.8</span><span class="w"> </span><span class="mi">8080</span><span class="w">
      </span><span class="o">&lt;</span><span class="o">/</span><span class="n">connection</span><span class="o">&gt;</span><span class="w">

      </span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="w">
      </span><span class="n">remote</span><span class="w"> </span><span class="mf">198.19</span><span class="o">.</span><span class="mf">36.99</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="n">tcp</span><span class="w">
      </span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="w"> </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">0.8</span><span class="w"> </span><span class="mi">8080</span><span class="w">
      </span><span class="o">&lt;</span><span class="o">/</span><span class="n">connection</span><span class="o">&gt;</span><span class="w">

      </span><span class="n">persist</span><span class="o">-</span><span class="n">key</span><span class="w">
      </span><span class="n">persist</span><span class="o">-</span><span class="n">tun</span><span class="w">
      </span><span class="n">pkcs12</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="n">p12</span><span class="w">
      </span><span class="n">remote</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">tls</span><span class="w"> </span><span class="n">server</span><span class="w">
      </span><span class="n">verb</span><span class="w"> </span><span class="mi">3</span><span class="w">

   </span><span class="nc">First</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="mf">198.19</span><span class="o">.</span><span class="mf">34.56</span><span class="p">:</span><span class="mi">1194</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">UDP</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">fails</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mf">198.19</span><span class="o">.</span><span class="mf">34.56</span><span class="p">:</span><span class="mi">443</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">TCP</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">also</span><span class="w">  </span><span class="n">fails</span><span class="p">,</span><span class="w">
   </span><span class="n">then</span><span class="w">  </span><span class="k">try</span><span class="w">  </span><span class="n">connecting</span><span class="w">  </span><span class="n">through</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="n">proxy</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">0.8</span><span class="p">:</span><span class="mi">8080</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mf">198.19</span><span class="o">.</span><span class="mf">34.56</span><span class="p">:</span><span class="mi">443</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">TCP</span><span class="o">.</span><span class="w"> </span><span class="nc">Finally</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">proxy</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">at</span><span class="w">
   </span><span class="mf">198.19</span><span class="o">.</span><span class="mf">36.99</span><span class="p">:</span><span class="mi">443</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">TCP</span><span class="o">.</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">inside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="w"> </span><span class="ss">block</span><span class="p">:</span><span class="w">

   </span><span class="n">bind</span><span class="p">,</span><span class="w"> </span><span class="n">connect</span><span class="o">-</span><span class="n">retry</span><span class="p">,</span><span class="w"> </span><span class="n">connect</span><span class="o">-</span><span class="n">retry</span><span class="o">-</span><span class="n">max</span><span class="p">,</span><span class="w"> </span><span class="n">connect</span><span class="o">-</span><span class="n">timeout</span><span class="p">,</span><span class="w"> </span><span class="n">explicit</span><span class="o">-</span><span class="n">exit</span><span class="o">-</span><span class="n">notify</span><span class="p">,</span><span class="w"> </span><span class="n">float</span><span class="p">,</span><span class="w"> </span><span class="n">fragment</span><span class="p">,</span><span class="w"> </span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="p">,</span><span class="w"> </span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="o">-</span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="o">-</span><span class="n">direction</span><span class="p">,</span><span class="w">  </span><span class="n">link</span><span class="o">-</span><span class="n">mtu</span><span class="p">,</span><span class="w">  </span><span class="n">lo</span><span class="err">‐</span><span class="w">
   </span><span class="n">cal</span><span class="p">,</span><span class="w"> </span><span class="n">lport</span><span class="p">,</span><span class="w"> </span><span class="n">mssfix</span><span class="p">,</span><span class="w"> </span><span class="n">mtu</span><span class="o">-</span><span class="n">disc</span><span class="p">,</span><span class="w"> </span><span class="n">nobind</span><span class="p">,</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"> </span><span class="n">proto</span><span class="p">,</span><span class="w"> </span><span class="n">remote</span><span class="p">,</span><span class="w"> </span><span class="n">rport</span><span class="p">,</span><span class="w"> </span><span class="n">socks</span><span class="o">-</span><span class="n">proxy</span><span class="p">,</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="p">,</span><span class="w"> </span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="p">,</span><span class="w"> </span><span class="n">tun</span><span class="o">-</span><span class="n">mtu</span><span class="w"> </span><span class="ow">and</span><span class="p">,</span><span class="w"> </span><span class="n">tun</span><span class="o">-</span><span class="n">mtu</span><span class="o">-</span><span class="n">extra</span><span class="o">.</span><span class="w">

   </span><span class="nc">A</span><span class="w">  </span><span class="n">defaulting</span><span class="w">  </span><span class="n">mechanism</span><span class="w"> </span><span class="n">exists</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="w"> </span><span class="n">profiles</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p" data-group-id="1550229392-1">(</span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">exception</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="p" data-group-id="1550229392-1">)</span><span class="w"> </span><span class="n">ap</span><span class="err">‐</span><span class="w">
   </span><span class="n">pear</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="w"> </span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="w"> </span><span class="n">blocks</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="k">for</span><span class="w">
   </span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

   </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">suppose</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">nobind</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">placed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sample</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">above</span><span class="p">,</span><span class="w"> </span><span class="n">near</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="w"> </span><span class="n">block</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w">
   </span><span class="n">effect</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">nobind</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">declared</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="n">it</span><span class="o">.</span></code></pre><p>INLINE FILE SUPPORT</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">OpenVPN</span><span class="w">  </span><span class="n">allows</span><span class="w">  </span><span class="n">including</span><span class="w">  </span><span class="n">files</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">main</span><span class="w">  </span><span class="n">configuration</span><span class="w">  </span><span class="k">for</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="o">--</span><span class="n">ca</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="n">cert</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="n">dh</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="n">extra</span><span class="o">-</span><span class="n">certs</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="n">key</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="n">pkcs12</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="n">secret</span><span class="p">,</span><span class="w">  </span><span class="o">--</span><span class="n">crl</span><span class="o">-</span><span class="n">verify</span><span class="p">,</span><span class="w">
   </span><span class="o">--</span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">pass</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">auth</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">auth</span><span class="o">-</span><span class="n">gen</span><span class="o">-</span><span class="n">token</span><span class="o">-</span><span class="n">secret</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">tls</span><span class="o">-</span><span class="n">crypt</span><span class="o">-</span><span class="n">v2</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w">

   </span><span class="nc">Each</span><span class="w"> </span><span class="n">inline</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">&lt;</span><span class="n">option</span><span class="o">&gt;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ended</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">&lt;</span><span class="o">/</span><span class="n">option</span><span class="o">&gt;</span><span class="w">

   </span><span class="nc">Here</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">inline</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">usage</span><span class="w">

      </span><span class="o">&lt;</span><span class="n">cert</span><span class="o">&gt;</span><span class="w">
      </span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="nc">BEGIN</span><span class="w"> </span><span class="nc">CERTIFICATE</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="w">
      </span><span class="p" data-group-id="6822021369-1">[</span><span class="n">...</span><span class="p" data-group-id="6822021369-1">]</span><span class="w">
      </span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="nc">END</span><span class="w"> </span><span class="nc">CERTIFICATE</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="w">
      </span><span class="o">&lt;</span><span class="o">/</span><span class="n">cert</span><span class="o">&gt;</span><span class="w">

   </span><span class="nc">When</span><span class="w">  </span><span class="n">using</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">inline</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">pkcs12</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">inline</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">base64</span><span class="w"> </span><span class="n">encoded</span><span class="o">.</span><span class="w"> </span><span class="nc">Encoding</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">.</span><span class="n">p12</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">base64</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="k">with</span><span class="w">
   </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">openssl</span><span class="w"> </span><span class="n">base64</span><span class="w"> </span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">input</span><span class="o">.</span><span class="n">p12</span></code></pre><p>SIGNALS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">SIGHUP</span><span class="w"> </span><span class="nc">Cause</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">connections</span><span class="p">,</span><span class="w"> </span><span class="n">restart</span><span class="p">,</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">read</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="p" data-group-id="5032899694-1">(</span><span class="k">if</span><span class="w"> </span><span class="n">any</span><span class="p" data-group-id="5032899694-1">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reopen</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="ow">and</span><span class="w">  </span><span class="n">network</span><span class="w">  </span><span class="n">connec</span><span class="err">‐</span><span class="w">
          </span><span class="n">tions</span><span class="o">.</span><span class="w">

   </span><span class="nc">SIGUSR1</span><span class="w">
          </span><span class="nc">Like</span><span class="w">  </span><span class="nc">SIGHUP</span><span class="err">`</span><span class="p">,</span><span class="w">  </span><span class="n">except</span><span class="w">  </span><span class="n">don</span><span class="sc">&#39;t re-read configuration file, and possibly don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reopen</span><span class="w"> </span><span class="nc">TUN</span><span class="o">/</span><span class="nc">TAP</span><span class="w"> </span><span class="n">device</span><span class="p">,</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">read</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">preserve</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">ad</span><span class="err">‐</span><span class="w">
          </span><span class="n">dress</span><span class="o">/</span><span class="n">port</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">preserve</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">recently</span><span class="w"> </span><span class="n">authenticated</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="o">/</span><span class="n">port</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="o">--</span><span class="n">persist</span><span class="o">-</span><span class="n">tun</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">persist</span><span class="o">-</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">persist</span><span class="o">-</span><span class="n">local</span><span class="o">-</span><span class="n">ip</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">--</span><span class="n">persist</span><span class="o">-</span><span class="n">re</span><span class="err">‐</span><span class="w">
          </span><span class="n">mote</span><span class="o">-</span><span class="n">ip</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">respectively</span><span class="w"> </span><span class="p" data-group-id="5032899694-2">(</span><span class="n">see</span><span class="w"> </span><span class="n">above</span><span class="p" data-group-id="5032899694-2">)</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">internally</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="n">condition</span><span class="p">,</span><span class="w"> </span><span class="n">governed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="o">-</span><span class="n">restart</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

          </span><span class="nc">This</span><span class="w">  </span><span class="n">signal</span><span class="p">,</span><span class="w">  </span><span class="ow">when</span><span class="w">  </span><span class="n">combined</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">--</span><span class="n">persist</span><span class="o">-</span><span class="n">remote</span><span class="o">-</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">underlying</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">host</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ow">when</span><span class="w">
          </span><span class="n">the</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">DHCP</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">assigned</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="o">.</span><span class="w">  </span><span class="nc">See</span><span class="w"> </span><span class="o">--</span><span class="n">ipchange</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="o">.</span><span class="w">

   </span><span class="nc">SIGUSR2</span><span class="w">
          </span><span class="nc">Causes</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">statistics</span><span class="w"> </span><span class="p" data-group-id="5032899694-3">(</span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">syslog</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">--</span><span class="n">daemon</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">stdout</span><span class="w"> </span><span class="n">otherwise</span><span class="p" data-group-id="5032899694-3">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">SIGINT</span><span class="p">,</span><span class="w"> </span><span class="nc">SIGTERM</span><span class="w">
          </span><span class="nc">Causes</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">gracefully</span><span class="o">.</span></code></pre><p>EXAMPLES</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">examples</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">installed</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">machines</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">connectivity</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">them</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w">  </span><span class="n">you</span><span class="w">  </span><span class="n">have</span><span class="w">  </span><span class="ow">not</span><span class="w">  </span><span class="n">yet</span><span class="w">  </span><span class="n">installed</span><span class="w">
   </span><span class="nc">OpenVPN</span><span class="p">,</span><span class="w"> </span><span class="n">consult</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">INSTALL</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">distribution</span><span class="o">.</span></code></pre><p>   Firewall Setup:</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">If</span><span class="w">  </span><span class="n">firewalls</span><span class="w"> </span><span class="n">exist</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">machines</span><span class="p">,</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">forward</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">directions</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">Open</span><span class="err">‐</span><span class="w">
   </span><span class="nc">VPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">1194</span><span class="o">/</span><span class="n">udp</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="k" data-group-id="6121118690-1">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">firewalls</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">machines</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="o">--</span><span class="n">ping</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">of</span><span class="w">
   </span><span class="n">the</span><span class="w">  </span><span class="n">openvpn</span><span class="w">  </span><span class="n">commands</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">examples</span><span class="w"> </span><span class="p" data-group-id="6121118690-2">(</span><span class="n">this</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">once</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w">
   </span><span class="n">many</span><span class="w"> </span><span class="n">stateful</span><span class="w"> </span><span class="n">firewalls</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">forward</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">directions</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">explicit</span><span class="w"> </span><span class="n">firewall</span><span class="w"> </span><span class="n">rule</span><span class="p" data-group-id="6121118690-2">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">Please</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">guides</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">configure</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">firewall</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">systems</span><span class="o">.</span></code></pre><p>   VPN Address Setup:</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">For</span><span class="w"> </span><span class="n">purposes</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">machines</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">bob</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">alice</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">constructing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">internet</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">re</span><span class="err">‐</span><span class="w">
   </span><span class="n">place</span><span class="w"> </span><span class="n">bob</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">alice</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">internet</span><span class="w"> </span><span class="n">hostname</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">machine</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">contact</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">internet</span><span class="o">.</span><span class="w">

   </span><span class="nc">Now</span><span class="w">  </span><span class="n">we</span><span class="w">  </span><span class="n">will</span><span class="w">  </span><span class="n">choose</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">endpoints</span><span class="o">.</span><span class="w"> </span><span class="nc">Tunnel</span><span class="w"> </span><span class="n">endpoints</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">meaning</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="o">.</span><span class="w"> </span><span class="nc">Each</span><span class="w"> </span><span class="n">machine</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w">
   </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">endpoint</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">machine</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">endpoint</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">bob</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="n">will</span><span class="w">  </span><span class="n">be</span><span class="w">  </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.1</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="k">for</span><span class="w">  </span><span class="n">al</span><span class="err">‐</span><span class="w">
   </span><span class="n">ice</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.2</span><span class="o">.</span><span class="w">

   </span><span class="nc">Once</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">established</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">essentially</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">secure</span><span class="w"> </span><span class="n">alternate</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">hosts</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">addressed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">endpoints</span><span class="o">.</span><span class="w"> </span><span class="nc">You</span><span class="w">
   </span><span class="n">can</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">passes</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hosts</span><span class="w"> </span><span class="p" data-group-id="0551308340-1">(</span><span class="n">a</span><span class="p" data-group-id="0551308340-1">)</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="p" data-group-id="0551308340-2">(</span><span class="n">b</span><span class="p" data-group-id="0551308340-2">)</span><span class="w"> </span><span class="n">independently</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">choosing</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="p" data-group-id="0551308340-3">(</span><span class="n">a</span><span class="p" data-group-id="0551308340-3">)</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w">  </span><span class="n">endpoint</span><span class="w">
   </span><span class="n">address</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="p" data-group-id="0551308340-4">(</span><span class="n">b</span><span class="p" data-group-id="0551308340-4">)</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="n">internet</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">bob</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">wish</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">alice</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="w">
   </span><span class="n">via</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="p" data-group-id="0551308340-5">(</span><span class="n">since</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">built</span><span class="o">-</span><span class="ow">in</span><span class="w"> </span><span class="n">security</span><span class="p" data-group-id="0551308340-5">)</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="n">alice</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">.</span><span class="w"> </span><span class="nc">However</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">same</span><span class="w">  </span><span class="n">scenario</span><span class="p">,</span><span class="w">  </span><span class="n">you</span><span class="w">
   </span><span class="n">could</span><span class="w">  </span><span class="n">also</span><span class="w">  </span><span class="kn">use</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">command</span><span class="w">  </span><span class="n">telnet</span><span class="w">  </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.2</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">telnet</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">alice</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="p">,</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">VPN</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">secure</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">session</span><span class="w">
   </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">ssh</span><span class="o">.</span><span class="w">

   </span><span class="nc">You</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">wish</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">endpoints</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="p" data-group-id="0551308340-6">(</span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">begin</span><span class="w"> </span><span class="k">with</span><span class="w">  </span><span class="mi">10</span><span class="w">  </span><span class="ow">or</span><span class="w">  </span><span class="mf">192.168</span><span class="p" data-group-id="0551308340-6">)</span><span class="w">  </span><span class="ow">and</span><span class="w">
   </span><span class="n">that</span><span class="w">  </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="n">subnet</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">networks</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">peer</span><span class="p">,</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">bridging</span><span class="o">.</span><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">sub</span><span class="err">‐</span><span class="w">
   </span><span class="n">net</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">endpoints</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">weird</span><span class="w"> </span><span class="n">feedback</span><span class="w"> </span><span class="n">loop</span><span class="o">.</span></code></pre><p>   Example 1: A simple tunnel without security</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">On</span><span class="w"> </span><span class="ss">bob</span><span class="p">:</span><span class="w">

      </span><span class="n">openvpn</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">alice</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun1</span><span class="w"> </span><span class="err">\</span><span class="w">
               </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.2</span><span class="w"> </span><span class="o">--</span><span class="n">verb</span><span class="w"> </span><span class="mi">9</span><span class="w">

   </span><span class="nc">On</span><span class="w"> </span><span class="ss">alice</span><span class="p">:</span><span class="w">

      </span><span class="n">openvpn</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">bob</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun1</span><span class="w"> </span><span class="err">\</span><span class="w">
               </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.2</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="o">--</span><span class="n">verb</span><span class="w"> </span><span class="mi">9</span><span class="w">

   </span><span class="nc">Now</span><span class="w"> </span><span class="n">verify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">working</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">pinging</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="o">.</span><span class="w">

   </span><span class="nc">On</span><span class="w"> </span><span class="ss">bob</span><span class="p">:</span><span class="w">

      </span><span class="n">ping</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.2</span><span class="w">

   </span><span class="nc">On</span><span class="w"> </span><span class="ss">alice</span><span class="p">:</span><span class="w">

      </span><span class="n">ping</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.1</span><span class="w">

   </span><span class="nc">The</span><span class="w"> </span><span class="o">--</span><span class="n">verb</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">produce</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tcpdump</span><span class="p" data-group-id="7418749506-1">(</span><span class="mi">8</span><span class="p" data-group-id="7418749506-1">)</span><span class="w"> </span><span class="n">program</span><span class="o">.</span><span class="w"> </span><span class="nc">Omit</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">verb</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">quietly</span><span class="o">.</span></code></pre><p>   Example 2: A tunnel with static-key security (i.e. using a pre-shared secret)</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">First</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">static</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">bob</span><span class="o">.</span><span class="w">

      </span><span class="n">openvpn</span><span class="w"> </span><span class="o">--</span><span class="n">genkey</span><span class="w"> </span><span class="o">--</span><span class="n">secret</span><span class="w"> </span><span class="n">key</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="p" data-group-id="0617059320-1">(</span><span class="ow">in</span><span class="w"> </span><span class="n">ascii</span><span class="w"> </span><span class="n">format</span><span class="p" data-group-id="0617059320-1">)</span><span class="o">.</span><span class="w"> </span><span class="nc">Now</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">alice</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">secure</span><span class="w"> </span><span class="n">medium</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">scp</span><span class="p" data-group-id="0617059320-2">(</span><span class="mi">1</span><span class="p" data-group-id="0617059320-2">)</span><span class="w"> </span><span class="n">program</span><span class="o">.</span><span class="w">

   </span><span class="nc">On</span><span class="w"> </span><span class="ss">bob</span><span class="p">:</span><span class="w">

      </span><span class="n">openvpn</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">alice</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun1</span><span class="w">  </span><span class="err">\</span><span class="w">
               </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.2</span><span class="w"> </span><span class="o">--</span><span class="n">verb</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">\</span><span class="w">
               </span><span class="o">--</span><span class="n">secret</span><span class="w"> </span><span class="n">key</span><span class="w">

   </span><span class="nc">On</span><span class="w"> </span><span class="ss">alice</span><span class="p">:</span><span class="w">

      </span><span class="n">openvpn</span><span class="w"> </span><span class="o">--</span><span class="n">remote</span><span class="w"> </span><span class="n">bob</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="o">--</span><span class="n">dev</span><span class="w"> </span><span class="n">tun1</span><span class="w">   </span><span class="err">\</span><span class="w">
              </span><span class="o">--</span><span class="n">ifconfig</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.2</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.1</span><span class="w"> </span><span class="o">--</span><span class="n">verb</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">\</span><span class="w">
              </span><span class="o">--</span><span class="n">secret</span><span class="w"> </span><span class="n">key</span><span class="w">

   </span><span class="nc">Now</span><span class="w"> </span><span class="n">verify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">working</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">pinging</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="o">.</span><span class="w">

   </span><span class="nc">On</span><span class="w"> </span><span class="ss">bob</span><span class="p">:</span><span class="w">

      </span><span class="n">ping</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.2</span><span class="w">

   </span><span class="nc">On</span><span class="w"> </span><span class="ss">alice</span><span class="p">:</span><span class="w">

      </span><span class="n">ping</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.1</span></code></pre><p>   Example 3: A tunnel with full TLS-based security</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">For</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">designate</span><span class="w"> </span><span class="n">bob</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">alice</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">server</span><span class="o">.</span><span class="w">

   </span><span class="ss">Note</span><span class="p">:</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">designation</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">meaning</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">subsystem</span><span class="o">.</span><span class="w"> </span><span class="nc">It</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">bearing</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="sc">&#39;s peer-to-peer, UDP-based communication model.*

   First, build a separate certificate/key pair for both bob and alice (see above where --cert is discussed for more info). Then construct Diffie Hellman param‐
   eters  (see above where --dh is discussed for more info). You can also use the included test files client.crt, client.key, server.crt, server.key and ca.crt.
   The .crt files are certificates/public-keys, the .key files are private keys, and ca.crt is a certification authority who  has  signed  both  client.crt  and
   server.crt.  For Diffie Hellman parameters you can use the included file dh2048.pem.

   WARNING:
          All  client,  server, and certificate authority certificates and keys included in the OpenVPN distribution are totally insecure and should be used for
          testing only.

   On bob:

      openvpn --remote alice.example.com --dev tun1    </span><span class="se">\
</span><span class="sc">              --ifconfig 10.4.0.1 10.4.0.2             </span><span class="se">\
</span><span class="sc">              --tls-client --ca ca.crt                 </span><span class="se">\
</span><span class="sc">              --cert client.crt --key client.key       </span><span class="se">\
</span><span class="sc">              --reneg-sec 60 --verb 5

   On alice:

      openvpn --remote bob.example.com --dev tun1      </span><span class="se">\
</span><span class="sc">              --ifconfig 10.4.0.2 10.4.0.1             </span><span class="se">\
</span><span class="sc">              --tls-server --dh dh1024.pem --ca ca.crt </span><span class="se">\
</span><span class="sc">              --cert server.crt --key server.key       </span><span class="se">\
</span><span class="sc">              --reneg-sec 60 --verb 5

   Now verify the tunnel is working by pinging across the tunnel.

   On bob:

      ping 10.4.0.2

   On alice:

      ping 10.4.0.1

   Notice the --reneg-sec 60 option we used above. That tells OpenVPN to renegotiate the data channel keys every minute. Since we used --verb 5 above, you  will
   see status information on each new key negotiation.

   For  production  operations, a key renegotiation interval of 60 seconds is probably too frequent. Omit the --reneg-sec 60 option to use OpenVPN&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">key</span><span class="w">
   </span><span class="n">renegotiation</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">hour</span><span class="o">.</span></code></pre><p>   Routing:</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Assuming</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">real</span><span class="w"> </span><span class="n">subnet</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">secure</span><span class="w"> </span><span class="n">tunnel</span><span class="o">.</span><span class="w"> </span><span class="nc">Suppose</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">bob</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">alice</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">two</span><span class="w">  </span><span class="n">network</span><span class="w">  </span><span class="n">inter</span><span class="err">‐</span><span class="w">
   </span><span class="n">faces</span><span class="w">  </span><span class="n">each</span><span class="p">,</span><span class="w">  </span><span class="n">one</span><span class="w">  </span><span class="n">connected</span><span class="w">  </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">internet</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">network</span><span class="o">.</span><span class="w"> </span><span class="nc">Our</span><span class="w"> </span><span class="n">goal</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">securely</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">networks</span><span class="o">.</span><span class="w"> </span><span class="nc">We</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">assume</span><span class="w"> </span><span class="n">that</span><span class="w">
   </span><span class="n">bob</span><span class="sc">&#39;s private subnet is 10.0.0.0/24 and alice&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mf">10.0</span><span class="o">.</span><span class="mf">1.0</span><span class="o">/</span><span class="mi">24</span><span class="o">.</span><span class="w">

   </span><span class="nc">First</span><span class="p">,</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">forwarding</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">peers</span><span class="o">.</span><span class="w"> </span><span class="nc">On</span><span class="w"> </span><span class="nc">Linux</span><span class="p">,</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="ss">routing</span><span class="p">:</span><span class="w">

      </span><span class="n">echo</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">sys</span><span class="o">/</span><span class="n">net</span><span class="o">/</span><span class="n">ipv4</span><span class="o">/</span><span class="n">ip_forward</span><span class="w">

   </span><span class="nc">This</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">persistent</span><span class="o">.</span><span class="w">  </span><span class="nc">Please</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">documentation</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">properly</span><span class="w"> </span><span class="n">configure</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">forwarding</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w">  </span><span class="n">also</span><span class="w">  </span><span class="n">persistent</span><span class="w">  </span><span class="n">through</span><span class="w">
   </span><span class="n">system</span><span class="w"> </span><span class="n">boots</span><span class="o">.</span><span class="w">

   </span><span class="nc">If</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">firewall</span><span class="o">.</span><span class="w">  </span><span class="nc">Please</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">guide</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">configure</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">firewall</span><span class="o">.</span><span class="w">  </span><span class="nc">You</span><span class="w"> </span><span class="n">typically</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">traffic</span><span class="w">
   </span><span class="n">coming</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">going</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tun</span><span class="o">/</span><span class="n">tap</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="o">.</span><span class="w">

   </span><span class="nc">On</span><span class="w"> </span><span class="ss">bob</span><span class="p">:</span><span class="w">

      </span><span class="n">route</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">-</span><span class="n">net</span><span class="w"> </span><span class="mf">10.0</span><span class="o">.</span><span class="mf">1.0</span><span class="w"> </span><span class="n">netmask</span><span class="w"> </span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span><span class="w"> </span><span class="n">gw</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.2</span><span class="w">

   </span><span class="nc">On</span><span class="w"> </span><span class="ss">alice</span><span class="p">:</span><span class="w">

      </span><span class="n">route</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">-</span><span class="n">net</span><span class="w"> </span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.0</span><span class="w"> </span><span class="n">netmask</span><span class="w"> </span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span><span class="w"> </span><span class="n">gw</span><span class="w"> </span><span class="mf">10.4</span><span class="o">.</span><span class="mf">0.1</span><span class="w">

   </span><span class="nc">Now</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">machine</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">subnet</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">machine</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="mf">10.0</span><span class="o">.</span><span class="mf">1.0</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">subnet</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">secure</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="p" data-group-id="1029871709-1">(</span><span class="ow">or</span><span class="w"> </span><span class="n">vice</span><span class="w"> </span><span class="n">versa</span><span class="p" data-group-id="1029871709-1">)</span><span class="o">.</span><span class="w">

   </span><span class="nc">In</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">production</span><span class="w"> </span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="n">command</span><span class="p" data-group-id="1029871709-2">(</span><span class="n">s</span><span class="p" data-group-id="1029871709-2">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">--</span><span class="n">up</span><span class="w"> </span><span class="n">option</span><span class="o">.</span></code></pre><p>FAQ</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">community</span><span class="o">.</span><span class="n">openvpn</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">openvpn</span><span class="o">/</span><span class="n">wiki</span><span class="o">/</span><span class="nc">FAQ</span></code></pre><p>HOWTO</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">For</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">comprehensive</span><span class="w"> </span><span class="n">guide</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">production</span><span class="w"> </span><span class="n">setting</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="nc">HOWTO</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">openvpn</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">community</span><span class="o">-</span><span class="n">resources</span><span class="o">/</span><span class="n">how</span><span class="o">-</span><span class="n">to</span><span class="o">/</span></code></pre><p>PROTOCOL</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">For</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">underlying</span><span class="w"> </span><span class="n">protocol</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">openvpn</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">community</span><span class="o">-</span><span class="n">resources</span><span class="o">/</span><span class="n">openvpn</span><span class="o">-</span><span class="n">protocol</span><span class="o">/</span></code></pre><p>WEB</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">OpenVPN</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">web</span><span class="w"> </span><span class="n">site</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">openvpn</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="w">

   </span><span class="nc">Go</span><span class="w"> </span><span class="n">here</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">download</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">latest</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="p">,</span><span class="w"> </span><span class="n">subscribe</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">mailing</span><span class="w"> </span><span class="n">lists</span><span class="p">,</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">mailing</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">archives</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">browse</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SVN</span><span class="w"> </span><span class="n">repository</span><span class="o">.</span></code></pre><p>BUGS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Report</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">bugs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="n">team</span><span class="w"> </span><span class="n">info</span><span class="na">@openvpn</span><span class="o">.</span><span class="n">net</span></code></pre><p>SEE ALSO</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="n">dhcpcd</span><span class="p" data-group-id="3804747003-1">(</span><span class="mi">8</span><span class="p" data-group-id="3804747003-1">)</span><span class="p">,</span><span class="w"> </span><span class="n">ifconfig</span><span class="p" data-group-id="3804747003-2">(</span><span class="mi">8</span><span class="p" data-group-id="3804747003-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">openssl</span><span class="p" data-group-id="3804747003-3">(</span><span class="mi">1</span><span class="p" data-group-id="3804747003-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">route</span><span class="p" data-group-id="3804747003-4">(</span><span class="mi">8</span><span class="p" data-group-id="3804747003-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">scp</span><span class="p" data-group-id="3804747003-5">(</span><span class="mi">1</span><span class="p" data-group-id="3804747003-5">)</span><span class="w"> </span><span class="n">ssh</span><span class="p" data-group-id="3804747003-6">(</span><span class="mi">1</span><span class="p" data-group-id="3804747003-6">)</span></code></pre><p>NOTES</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">This</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="n">includes</span><span class="w"> </span><span class="n">software</span><span class="w"> </span><span class="n">developed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OpenSSL</span><span class="w"> </span><span class="nc">Project</span><span class="w"> </span><span class="p" data-group-id="8724532844-1">(</span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">www</span><span class="o">.</span><span class="n">openssl</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="p" data-group-id="8724532844-1">)</span><span class="w">

   </span><span class="nc">For</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TLS</span><span class="w"> </span><span class="n">protocol</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">www</span><span class="o">.</span><span class="n">ietf</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">rfc</span><span class="o">/</span><span class="n">rfc2246</span><span class="o">.</span><span class="n">txt</span><span class="w">

   </span><span class="nc">For</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">LZO</span><span class="w"> </span><span class="n">real</span><span class="o">-</span><span class="n">time</span><span class="w"> </span><span class="n">compression</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">www</span><span class="o">.</span><span class="n">oberhumer</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">opensource</span><span class="o">/</span><span class="n">lzo</span><span class="o">/</span></code></pre><p>COPYRIGHT</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">Copyright</span><span class="w"> </span><span class="p" data-group-id="5045425178-1">(</span><span class="nc">C</span><span class="p" data-group-id="5045425178-1">)</span><span class="w"> </span><span class="mi">2002</span><span class="o">-</span><span class="mi">2020</span><span class="w"> </span><span class="nc">OpenVPN</span><span class="w"> </span><span class="nc">Inc</span><span class="w"> </span><span class="nc">This</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">software</span><span class="p">;</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">redistribute</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">modify</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">GNU</span><span class="w"> </span><span class="nc">General</span><span class="w"> </span><span class="nc">Public</span><span class="w"> </span><span class="nc">License</span><span class="w">
   </span><span class="n">version</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">published</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Free</span><span class="w"> </span><span class="nc">Software</span><span class="w"> </span><span class="nc">Foundation</span><span class="o">.</span></code></pre><p>AUTHORS</p><pre><code class="nohighlight makeup elixir"><span class="w">   </span><span class="nc">James</span><span class="w"> </span><span class="nc">Yonan</span><span class="w"> </span><span class="n">james</span><span class="na">@openvpn</span><span class="o">.</span><span class="n">net</span><span class="w">

                                                                                                                                                      </span><span class="nc">OPENVPN</span><span class="p" data-group-id="7940941021-1">(</span><span class="mi">8</span><span class="p" data-group-id="7940941021-1">)</span></code></pre>      <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.23.0) for the
            <a href="https://elixir-lang.org" title="Elixir" target="_blank">Elixir programming language</a>.
          </span>
          <span class="line">
            Designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>
          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>
  </body>
</html>
