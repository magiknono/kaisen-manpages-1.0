<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.23.0">
    <meta name="project" content="Kaisen-linux v0.0.1">
    <title>tcpdump — Kaisen-linux v0.0.1</title>
    <link rel="stylesheet" href="dist/elixir-9f91ebe876dc01d67920.css" />
    <script src="dist/sidebar_items-d3359b838f.js"></script>
      <script src="doc-versions.js"></script>
    <script async src="dist/app-60a0c9f10e9e52eae31f.js"></script>
  </head>
  <body data-type="extras">
    <script>try { if(localStorage.getItem('night-mode') === 'true') document.body.className += ' night-mode'; } catch (e) { }</script>
<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <span class="icon-search" aria-hidden="true" title="Submit search"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <span class="icon-cross" aria-hidden="true" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" id="search-list" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="#homepage_url" class="sidebar-projectName">
Kaisen-linux      </a>
      <strong class="sidebar-projectVersion">
        v0.0.1
      </strong>
    </div>
      <a href="#homepage_url">
        <img src="assets/logo.jpg" alt="Kaisen-linux" class="sidebar-projectImage">
      </a>
  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">MANUAL</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

<p>  TCPDUMP</p><h2 id="name" class="section-heading">
  <a href="#name" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  NAME
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dump</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">network</span></code></pre><h2 id="synopsis" class="section-heading">
  <a href="#synopsis" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  SYNOPSIS
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="n">tcpdump</span><span class="w"> </span><span class="p" data-group-id="3936456897-1">[</span><span class="w"> </span><span class="o">-</span><span class="nc">AbdDefhHIJKlLnNOpqStuUvxX</span><span class="c1"># ] [ -B buffer_size ]</span><span class="w">
            </span><span class="p" data-group-id="3936456897-2">[</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="p" data-group-id="3936456897-2">]</span><span class="w">
            </span><span class="p" data-group-id="3936456897-3">[</span><span class="w"> </span><span class="o">-</span><span class="nc">C</span><span class="w"> </span><span class="n">file_size</span><span class="w"> </span><span class="p" data-group-id="3936456897-3">]</span><span class="w"> </span><span class="p" data-group-id="3936456897-4">[</span><span class="w"> </span><span class="o">-</span><span class="nc">G</span><span class="w"> </span><span class="n">rotate_seconds</span><span class="w"> </span><span class="p" data-group-id="3936456897-4">]</span><span class="w"> </span><span class="p" data-group-id="3936456897-5">[</span><span class="w"> </span><span class="o">-</span><span class="nc">F</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="p" data-group-id="3936456897-5">]</span><span class="w">
            </span><span class="p" data-group-id="3936456897-6">[</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="p" data-group-id="3936456897-6">]</span><span class="w"> </span><span class="p" data-group-id="3936456897-7">[</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="n">tstamp_type</span><span class="w"> </span><span class="p" data-group-id="3936456897-7">]</span><span class="w"> </span><span class="p" data-group-id="3936456897-8">[</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="p" data-group-id="3936456897-8">]</span><span class="w"> </span><span class="p" data-group-id="3936456897-9">[</span><span class="w"> </span><span class="o">-</span><span class="nc">M</span><span class="w"> </span><span class="n">secret</span><span class="w"> </span><span class="p" data-group-id="3936456897-9">]</span><span class="w">
            </span><span class="p" data-group-id="3936456897-10">[</span><span class="w"> </span><span class="o">--</span><span class="n">number</span><span class="w"> </span><span class="p" data-group-id="3936456897-10">]</span><span class="w"> </span><span class="p" data-group-id="3936456897-11">[</span><span class="w"> </span><span class="o">-</span><span class="nc">Q</span><span class="w"> </span><span class="ow">in</span><span class="o">|</span><span class="n">out</span><span class="o">|</span><span class="n">inout</span><span class="w"> </span><span class="p" data-group-id="3936456897-11">]</span><span class="w">
            </span><span class="p" data-group-id="3936456897-12">[</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="p" data-group-id="3936456897-12">]</span><span class="w"> </span><span class="p" data-group-id="3936456897-13">[</span><span class="w"> </span><span class="o">-</span><span class="nc">V</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="p" data-group-id="3936456897-13">]</span><span class="w"> </span><span class="p" data-group-id="3936456897-14">[</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="n">snaplen</span><span class="w"> </span><span class="p" data-group-id="3936456897-14">]</span><span class="w"> </span><span class="p" data-group-id="3936456897-15">[</span><span class="w"> </span><span class="o">-</span><span class="nc">T</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p" data-group-id="3936456897-15">]</span><span class="w"> </span><span class="p" data-group-id="3936456897-16">[</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="p" data-group-id="3936456897-16">]</span><span class="w">
            </span><span class="p" data-group-id="3936456897-17">[</span><span class="w"> </span><span class="o">-</span><span class="nc">W</span><span class="w"> </span><span class="n">filecount</span><span class="w"> </span><span class="p" data-group-id="3936456897-17">]</span><span class="w">
            </span><span class="p" data-group-id="3936456897-18">[</span><span class="w"> </span><span class="o">-</span><span class="nc">E</span><span class="w"> </span><span class="n">spi</span><span class="na">@ipaddr</span><span class="w"> </span><span class="n">algo</span><span class="ss">:secret</span><span class="p">,</span><span class="n">...</span><span class="w">  </span><span class="p" data-group-id="3936456897-18">]</span><span class="w">
            </span><span class="p" data-group-id="3936456897-19">[</span><span class="w"> </span><span class="o">-</span><span class="n">y</span><span class="w"> </span><span class="n">datalinktype</span><span class="w"> </span><span class="p" data-group-id="3936456897-19">]</span><span class="w"> </span><span class="p" data-group-id="3936456897-20">[</span><span class="w"> </span><span class="o">-</span><span class="n">z</span><span class="w"> </span><span class="n">postrotate</span><span class="o">-</span><span class="n">command</span><span class="w"> </span><span class="p" data-group-id="3936456897-20">]</span><span class="w"> </span><span class="p" data-group-id="3936456897-21">[</span><span class="w"> </span><span class="o">-</span><span class="nc">Z</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p" data-group-id="3936456897-21">]</span><span class="w">
            </span><span class="p" data-group-id="3936456897-22">[</span><span class="w"> </span><span class="o">--</span><span class="n">time</span><span class="o">-</span><span class="n">stamp</span><span class="o">-</span><span class="n">precision</span><span class="o">=</span><span class="n">tstamp_precision</span><span class="w"> </span><span class="p" data-group-id="3936456897-22">]</span><span class="w">
            </span><span class="p" data-group-id="3936456897-23">[</span><span class="w"> </span><span class="o">--</span><span class="n">immediate</span><span class="o">-</span><span class="n">mode</span><span class="w"> </span><span class="p" data-group-id="3936456897-23">]</span><span class="w"> </span><span class="p" data-group-id="3936456897-24">[</span><span class="w"> </span><span class="o">--</span><span class="n">version</span><span class="w"> </span><span class="p" data-group-id="3936456897-24">]</span><span class="w">
            </span><span class="p" data-group-id="3936456897-25">[</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="p" data-group-id="3936456897-25">]</span></code></pre><h2 id="description" class="section-heading">
  <a href="#description" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  DESCRIPTION
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="nc">Tcpdump</span><span class="w">  </span><span class="n">prints</span><span class="w">  </span><span class="n">out</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">contents</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">boolean</span><span class="w"> </span><span class="n">expression</span><span class="p">;</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">preceded</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">time</span><span class="w">
    </span><span class="n">stamp</span><span class="p">,</span><span class="w"> </span><span class="n">printed</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">hours</span><span class="p">,</span><span class="w"> </span><span class="n">minutes</span><span class="p">,</span><span class="w"> </span><span class="n">seconds</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">fractions</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">midnight</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w">  </span><span class="n">causes</span><span class="w">  </span><span class="n">it</span><span class="w">  </span><span class="n">to</span><span class="w">
    </span><span class="n">save</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">later</span><span class="w"> </span><span class="n">analysis</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">causes</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">from</span><span class="w">
    </span><span class="n">a</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="nc">V</span><span class="w"> </span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">causes</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">files</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">cases</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">packets</span><span class="w">  </span><span class="n">that</span><span class="w">  </span><span class="n">match</span><span class="w">  </span><span class="n">ex</span><span class="err">‐</span><span class="w">
    </span><span class="n">pression</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">processed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">tcpdump</span><span class="o">.</span><span class="w">

    </span><span class="nc">Tcpdump</span><span class="w">  </span><span class="n">will</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="n">continue</span><span class="w"> </span><span class="n">capturing</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">interrupted</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">SIGINT</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="p" data-group-id="9625864356-1">(</span><span class="n">generated</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">typing</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="ow">in</span><span class="err">‐</span><span class="w">
    </span><span class="n">terrupt</span><span class="w"> </span><span class="n">character</span><span class="p">,</span><span class="w"> </span><span class="n">typically</span><span class="w"> </span><span class="n">control</span><span class="o">-</span><span class="nc">C</span><span class="p" data-group-id="9625864356-1">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">SIGTERM</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="p" data-group-id="9625864356-2">(</span><span class="n">typically</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kill</span><span class="p" data-group-id="9625864356-3">(</span><span class="mi">1</span><span class="p" data-group-id="9625864356-3">)</span><span class="w"> </span><span class="n">command</span><span class="p" data-group-id="9625864356-2">)</span><span class="p">;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">capture</span><span class="w">  </span><span class="n">packets</span><span class="w">
    </span><span class="n">until</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">interrupted</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">SIGINT</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">SIGTERM</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">processed</span><span class="o">.</span><span class="w">

    </span><span class="nc">When</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">finishes</span><span class="w"> </span><span class="n">capturing</span><span class="w"> </span><span class="n">packets</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="n">counts</span><span class="w"> </span><span class="ss">of</span><span class="p">:</span><span class="w">

           </span><span class="n">packets</span><span class="w"> </span><span class="err">`</span><span class="err">`</span><span class="n">captured</span><span class="sc">&#39;&#39;</span><span class="w"> </span><span class="p" data-group-id="9625864356-4">(</span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">processed</span><span class="p" data-group-id="9625864356-4">)</span><span class="p">;</span><span class="w">

           </span><span class="n">packets</span><span class="w"> </span><span class="err">`</span><span class="err">`</span><span class="n">received</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">filter</span><span class="sc">&#39;&#39;</span><span class="w"> </span><span class="p" data-group-id="9625864356-5">(</span><span class="n">the</span><span class="w"> </span><span class="n">meaning</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">depends</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">OS</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">you</span><span class="sc">&#39;re running tcpdump, and possibly on the way the OS was configured -
           if a filter was specified on the command line, on some OSes it counts packets regardless of whether they were matched by the  filter  expression  and,
           even  if they were matched by the filter expression, regardless of whether tcpdump has read and processed them yet, on other OSes it counts only pack‐
           ets that were matched by the filter expression regardless of whether tcpdump has read and processed them yet, and on other OSes it counts only packets
           that were matched by the filter expression and were processed by tcpdump);

           packets  ``dropped by kernel&#39;</span><span class="sc">&#39; (this is the number of packets that were dropped, due to a lack of buffer space, by the packet capture mechanism in the
           OS on which tcpdump is running, if the OS reports that information to applications; if not, it will be reported as 0).

    On platforms that support the SIGINFO signal, such as most BSDs (including Mac OS X) and Digital/Tru64 UNIX, it will report those counts when it  receives  a
    SIGINFO  signal  (generated,  for example, by typing your ``status&#39;</span><span class="sc">&#39; character, typically control-T, although on some platforms, such as Mac OS X, the ``sta‐
    tus&#39;</span><span class="sc">&#39; character is not set by default, so you must set it with stty(1) in order to use it) and will continue capturing packets. On platforms that do not sup‐
    port the SIGINFO signal, the same can be achieved by using the SIGUSR1 signal.

    Reading  packets  from  a  network interface may require that you have special privileges; see the pcap (3PCAP) man page for details.  Reading a saved packet
    file doesn&#39;</span><span class="n">t</span><span class="w"> </span><span class="kn">require</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">privileges</span><span class="o">.</span></code></pre><h2 id="options" class="section-heading">
  <a href="#options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  OPTIONS
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="o">-</span><span class="nc">A</span><span class="w">     </span><span class="nc">Print</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="p" data-group-id="5767690389-1">(</span><span class="n">minus</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">header</span><span class="p" data-group-id="5767690389-1">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">ASCII</span><span class="o">.</span><span class="w">  </span><span class="nc">Handy</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">capturing</span><span class="w"> </span><span class="n">web</span><span class="w"> </span><span class="n">pages</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">b</span><span class="w">     </span><span class="nc">Print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">AS</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">BGP</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">ASDOT</span><span class="w"> </span><span class="n">notation</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="nc">ASPLAIN</span><span class="w"> </span><span class="n">notation</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">B</span><span class="w"> </span><span class="n">buffer_size</span><span class="w">
    </span><span class="o">--</span><span class="n">buffer</span><span class="o">-</span><span class="n">size</span><span class="o">=</span><span class="n">buffer_size</span><span class="w">
           </span><span class="nc">Set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">buffer_size</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">units</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">KiB</span><span class="w"> </span><span class="p" data-group-id="5767690389-2">(</span><span class="mi">1024</span><span class="w"> </span><span class="n">bytes</span><span class="p" data-group-id="5767690389-2">)</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">count</span><span class="w">
           </span><span class="nc">Exit</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">receiving</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">C</span><span class="w"> </span><span class="n">file_size</span><span class="w">
           </span><span class="nc">Before</span><span class="w"> </span><span class="n">writing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">savefile</span><span class="p">,</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">larger</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">file_size</span><span class="w"> </span><span class="ow">and</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">so</span><span class="p">,</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">savefile</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="n">a</span><span class="w">
           </span><span class="n">new</span><span class="w">  </span><span class="n">one</span><span class="o">.</span><span class="w">   </span><span class="nc">Savefiles</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">savefile</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">it</span><span class="p">,</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">continuing</span><span class="w"> </span><span class="n">up</span><span class="err">‐</span><span class="w">
           </span><span class="n">ward</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">units</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">file_size</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">millions</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="p" data-group-id="5767690389-3">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">000</span><span class="p">,</span><span class="mi">000</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">048</span><span class="p">,</span><span class="mi">576</span><span class="w"> </span><span class="n">bytes</span><span class="p" data-group-id="5767690389-3">)</span><span class="o">.</span><span class="w">

           </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">-</span><span class="nc">Z</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="p" data-group-id="5767690389-4">(</span><span class="n">enabled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="p" data-group-id="5767690389-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">dropped</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">opening</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">savefile</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">d</span><span class="w">     </span><span class="nc">Dump</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">compiled</span><span class="w"> </span><span class="n">packet</span><span class="o">-</span><span class="n">matching</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">human</span><span class="w"> </span><span class="n">readable</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">stop</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">dd</span><span class="w">    </span><span class="nc">Dump</span><span class="w"> </span><span class="n">packet</span><span class="o">-</span><span class="n">matching</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">fragment</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">ddd</span><span class="w">   </span><span class="nc">Dump</span><span class="w"> </span><span class="n">packet</span><span class="o">-</span><span class="n">matching</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">decimal</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="p" data-group-id="5767690389-5">(</span><span class="n">preceded</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">count</span><span class="p" data-group-id="5767690389-5">)</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">D</span><span class="w">
    </span><span class="o">--</span><span class="n">list</span><span class="o">-</span><span class="n">interfaces</span><span class="w">
           </span><span class="nc">Print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">interfaces</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">interface</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w">  </span><span class="n">number</span><span class="w">  </span><span class="ow">and</span><span class="w">
           </span><span class="n">an</span><span class="w">  </span><span class="n">interface</span><span class="w">  </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">possibly</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interface</span><span class="p">,</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w">
           </span><span class="n">flag</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">capture</span><span class="o">.</span><span class="w">

           </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">don</span><span class="sc">&#39;t have a command to list them (e.g., Windows systems, or UNIX systems lacking ifconfig -a); the number  can  be
           useful on Windows 2000 and later systems, where the interface name is a somewhat complex string.

           The -D flag will not be supported if tcpdump was built with an older version of libpcap that lacks the pcap_findalldevs() function.

    -e     Print  the  link-level  header on each dump line.  This can be used, for example, to print MAC layer addresses for protocols such as Ethernet and IEEE
           802.11.

    -E     Use spi@ipaddr algo:secret for decrypting IPsec ESP packets that are addressed to addr and contain Security Parameter Index value spi.  This  combina‐
           tion may be repeated with comma or newline separation.

           Note that setting the secret for IPv4 ESP packets is supported at this time.

           Algorithms  may  be  des-cbc,  3des-cbc, blowfish-cbc, rc3-cbc, cast128-cbc, or none.  The default is des-cbc.  The ability to decrypt packets is only
           present if tcpdump was compiled with cryptography enabled.

           secret is the ASCII text for ESP secret key.  If preceded by 0x, then a hex value will be read.

           The option assumes RFC2406 ESP, not RFC1827 ESP.  The option is only for debugging purposes, and the use of this option with a true  `secret&#39;</span><span class="w">  </span><span class="n">key</span><span class="w">  </span><span class="n">is</span><span class="w">
           </span><span class="n">discouraged</span><span class="o">.</span><span class="w">  </span><span class="nc">By</span><span class="w"> </span><span class="n">presenting</span><span class="w"> </span><span class="nc">IPsec</span><span class="w"> </span><span class="n">secret</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">onto</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">visible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">others</span><span class="p">,</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">ps</span><span class="p" data-group-id="5767690389-6">(</span><span class="mi">1</span><span class="p" data-group-id="5767690389-6">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">occasions</span><span class="o">.</span><span class="w">

           </span><span class="nc">In</span><span class="w">  </span><span class="n">addition</span><span class="w">  </span><span class="n">to</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">above</span><span class="w"> </span><span class="n">syntax</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">syntax</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">in</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">opened</span><span class="w"> </span><span class="n">upon</span><span class="w"> </span><span class="n">receiving</span><span class="w"> </span><span class="n">the</span><span class="w">
           </span><span class="n">first</span><span class="w"> </span><span class="nc">ESP</span><span class="w"> </span><span class="n">packet</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">up</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">f</span><span class="w">     </span><span class="nc">Print</span><span class="w"> </span><span class="err">`</span><span class="n">foreign</span><span class="sc">&#39; IPv4 addresses numerically rather than symbolically (this option is intended to get around serious brain damage in Sun&#39;</span><span class="n">s</span><span class="w"> </span><span class="nc">NIS</span><span class="w"> </span><span class="n">server</span><span class="w">  </span><span class="err">—</span><span class="w">
           </span><span class="n">usually</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">hangs</span><span class="w"> </span><span class="n">forever</span><span class="w"> </span><span class="n">translating</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">local</span><span class="w"> </span><span class="n">internet</span><span class="w"> </span><span class="n">numbers</span><span class="p">)</span><span class="o">.</span><span class="w">

           </span><span class="nc">The</span><span class="w">  </span><span class="n">test</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">foreign</span><span class="sc">&#39; IPv4 addresses is done using the IPv4 address and netmask of the interface on which capture is being done.  If that address or
           netmask are not available, available, either because the interface on which capture is being done has no address or netmask or because the capture  is
           being done on the Linux &quot;any&quot; interface, which can capture on more than one interface, this option will not work correctly.

    -F file
           Use file as input for the filter expression.  An additional expression given on the command line is ignored.

    -G rotate_seconds
           If  specified,  rotates  the  dump file specified with the -w option every rotate_seconds seconds.  Savefiles will have the name specified by -w which
           should include a time format as defined by strftime(3).  If no time format is specified, each new file will overwrite the previous.

           If used in conjunction with the -C option, filenames will take the form of `file&lt;count&gt;&#39;</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">h</span><span class="w">
    </span><span class="o">--</span><span class="n">help</span><span class="w"> </span><span class="nc">Print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">libpcap</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">strings</span><span class="p">,</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">exit</span><span class="o">.</span><span class="w">

    </span><span class="o">--</span><span class="n">version</span><span class="w">
           </span><span class="nc">Print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">libpcap</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">strings</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">exit</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">H</span><span class="w">     </span><span class="nc">Attempt</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">detect</span><span class="w"> </span><span class="mf">802.11</span><span class="n">s</span><span class="w"> </span><span class="n">draft</span><span class="w"> </span><span class="n">mesh</span><span class="w"> </span><span class="n">headers</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">interface</span><span class="w">
    </span><span class="o">--</span><span class="n">interface</span><span class="o">=</span><span class="n">interface</span><span class="w">
           </span><span class="nc">Listen</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">unspecified</span><span class="p">,</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">searches</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">lowest</span><span class="w"> </span><span class="n">numbered</span><span class="p">,</span><span class="w"> </span><span class="n">configured</span><span class="w">  </span><span class="n">up</span><span class="w">  </span><span class="n">interface</span><span class="w">  </span><span class="p" data-group-id="5767690389-7">(</span><span class="n">excluding</span><span class="w">  </span><span class="n">loop</span><span class="err">‐</span><span class="w">
           </span><span class="n">back</span><span class="p" data-group-id="5767690389-7">)</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">turn</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="err">`</span><span class="err">`</span><span class="n">eth0</span><span class="sc">&#39;&#39;</span><span class="o">.</span><span class="w">

           </span><span class="nc">On</span><span class="w">  </span><span class="nc">Linux</span><span class="w">  </span><span class="n">systems</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="mf">2.2</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">later</span><span class="w"> </span><span class="n">kernels</span><span class="p">,</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">`</span><span class="err">`</span><span class="n">any</span><span class="sc">&#39;&#39;</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">interfaces</span><span class="o">.</span><span class="w">  </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">captures</span><span class="w">
           </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="err">`</span><span class="n">any</span><span class="sc">&#39;&#39;</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">promiscuous</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w">

           </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="nc">D</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">supported</span><span class="p">,</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">argument</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">that</span><span class="w">
           </span><span class="n">number</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">name</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">I</span><span class="w">
    </span><span class="o">--</span><span class="n">monitor</span><span class="o">-</span><span class="n">mode</span><span class="w">
           </span><span class="nc">Put</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="s">&quot;monitor mode&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">IEEE</span><span class="w"> </span><span class="mf">802.11</span><span class="w"> </span><span class="nc">Wi</span><span class="o">-</span><span class="nc">Fi</span><span class="w"> </span><span class="n">interfaces</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">systems</span><span class="o">.</span><span class="w">

           </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">monitor</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">disassociate</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">it</span><span class="sc">&#39;s associated, so that you will not be able to use any wireless
           networks with that adapter.  This could prevent accessing files on a network server, or resolving host names or network addresses, if you are  captur‐
           ing in monitor mode and are not connected to another network with another adapter.

           This flag will affect the output of the -L flag.  If -I isn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">link</span><span class="o">-</span><span class="n">layer</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">monitor</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">shown</span><span class="p">;</span><span class="w">
           </span><span class="k">if</span><span class="w"> </span><span class="o">-</span><span class="nc">I</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">link</span><span class="o">-</span><span class="n">layer</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">monitor</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">shown</span><span class="o">.</span><span class="w">

    </span><span class="o">--</span><span class="n">immediate</span><span class="o">-</span><span class="n">mode</span><span class="w">
           </span><span class="nc">Capture</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="s">&quot;immediate mode&quot;</span><span class="o">.</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">delivered</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">soon</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">arrive</span><span class="p">,</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">buffered</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">efficiency</span><span class="o">.</span><span class="w">   </span><span class="nc">This</span><span class="w">
           </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">printing</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">saving</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">`</span><span class="err">`</span><span class="n">savefile</span><span class="sc">&#39;&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w">
           </span><span class="ow">or</span><span class="w"> </span><span class="n">pipe</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="n">tstamp_type</span><span class="w">
    </span><span class="o">--</span><span class="n">time</span><span class="o">-</span><span class="n">stamp</span><span class="o">-</span><span class="n">type</span><span class="o">=</span><span class="n">tstamp_type</span><span class="w">
           </span><span class="nc">Set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">stamp</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">tstamp_type</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">stamp</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="ow">in</span><span class="w">  </span><span class="n">pcap</span><span class="o">-</span><span class="n">tstamp</span><span class="p" data-group-id="5767690389-8">(</span><span class="mi">7</span><span class="p" data-group-id="5767690389-8">)</span><span class="p">;</span><span class="w">  </span><span class="ow">not</span><span class="w">  </span><span class="n">all</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">types</span><span class="w">
           </span><span class="n">listed</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">necessarily</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">interface</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">J</span><span class="w">
    </span><span class="o">--</span><span class="n">list</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="n">stamp</span><span class="o">-</span><span class="n">types</span><span class="w">
           </span><span class="nc">List</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">supported</span><span class="w">  </span><span class="n">time</span><span class="w">  </span><span class="n">stamp</span><span class="w">  </span><span class="n">types</span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">exit</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">stamp</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interface</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">stamp</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">are</span><span class="w">
           </span><span class="n">listed</span><span class="o">.</span><span class="w">

    </span><span class="o">--</span><span class="n">time</span><span class="o">-</span><span class="n">stamp</span><span class="o">-</span><span class="n">precision</span><span class="o">=</span><span class="n">tstamp_precision</span><span class="w">
           </span><span class="nc">When</span><span class="w"> </span><span class="n">capturing</span><span class="p">,</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">stamp</span><span class="w"> </span><span class="n">precision</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">tstamp_precision</span><span class="o">.</span><span class="w">  </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">availability</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="n">precision</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">stamps</span><span class="w">  </span><span class="p" data-group-id="5767690389-9">(</span><span class="n">nanoseconds</span><span class="p" data-group-id="5767690389-9">)</span><span class="w">
           </span><span class="ow">and</span><span class="w">  </span><span class="n">their</span><span class="w">  </span><span class="n">actual</span><span class="w"> </span><span class="n">accuracy</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hardware</span><span class="w"> </span><span class="n">dependent</span><span class="o">.</span><span class="w">  </span><span class="nc">Also</span><span class="w"> </span><span class="n">note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">writing</span><span class="w"> </span><span class="n">captures</span><span class="w"> </span><span class="n">made</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">nanosecond</span><span class="w"> </span><span class="n">accuracy</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">savefile</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w">
           </span><span class="n">time</span><span class="w"> </span><span class="n">stamps</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">nanosecond</span><span class="w"> </span><span class="n">resolution</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">magic</span><span class="w"> </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">indicate</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">time</span><span class="w">  </span><span class="n">stamps</span><span class="w">  </span><span class="n">are</span><span class="w">  </span><span class="ow">in</span><span class="w">
           </span><span class="n">seconds</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">nanoseconds</span><span class="p">;</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">programs</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">pcap</span><span class="w"> </span><span class="n">savefiles</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">captures</span><span class="o">.</span><span class="w">

    </span><span class="nc">When</span><span class="w">  </span><span class="n">reading</span><span class="w">  </span><span class="n">a</span><span class="w">  </span><span class="n">savefile</span><span class="p">,</span><span class="w">  </span><span class="n">convert</span><span class="w">  </span><span class="n">time</span><span class="w"> </span><span class="n">stamps</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">precision</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">timestamp_precision</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">resolution</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">precision</span><span class="w">
    </span><span class="n">specified</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">precision</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">stamps</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversion</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">lose</span><span class="w"> </span><span class="n">precision</span><span class="o">.</span><span class="w">

    </span><span class="nc">The</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">timestamp_precision</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">micro</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">microsecond</span><span class="w"> </span><span class="n">resolution</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">nano</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">nanosecond</span><span class="w"> </span><span class="n">resolution</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">microsecond</span><span class="w"> </span><span class="n">resolution</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">K</span><span class="w">
    </span><span class="o">--</span><span class="n">dont</span><span class="o">-</span><span class="n">verify</span><span class="o">-</span><span class="n">checksums</span><span class="w">
           </span><span class="nc">Don</span><span class="sc">&#39;t attempt to verify IP, TCP, or UDP checksums.  This is useful for interfaces that perform some or all of those checksum calculation in  hardware;
           otherwise, all outgoing TCP checksums will be flagged as bad.

    -l     Make stdout line buffered.  Useful if you want to see the data while capturing it.  E.g.,

                  tcpdump -l | tee dat

           or

                  tcpdump -l &gt; dat &amp; tail -f dat

           Note that on Windows,``line buffered&#39;</span><span class="sc">&#39; means ``unbuffered&#39;</span><span class="sc">&#39;, so that WinDump will write each character individually if -l is specified.

           -U  is  similar  to -l in its behavior, but it will cause output to be ``packet-buffered&#39;</span><span class="sc">&#39;, so that the output is written to stdout at the end of each
           packet rather than at the end of each line; this is buffered on all platforms, including Windows.

    -L
    --list-data-link-types
           List the known data link types for the interface, in the specified mode, and exit.  The list of known data link types may be dependent on  the  speci‐
           fied  mode; for example, on some platforms, a Wi-Fi interface might support one set of data link types when not in monitor mode (for example, it might
           support only fake Ethernet headers, or might support 802.11 headers but not support 802.11 headers with radio information) and  another  set  of  data
           link types when in monitor mode (for example, it might support 802.11 headers, or 802.11 headers with radio information, only in monitor mode).

    -m module
           Load SMI MIB module definitions from file module.  This option can be used several times to load several MIB modules into tcpdump.

    -M secret
           Use secret as a shared secret for validating the digests found in TCP segments with the TCP-MD5 option (RFC 2385), if present.

    -n     Don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="p" data-group-id="5767690389-10">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">addresses</span><span class="p">,</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">numbers</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="o">.</span><span class="p" data-group-id="5767690389-10">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">names</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">N</span><span class="w">     </span><span class="nc">Don</span><span class="sc">&#39;t print domain name qualification of host names.  E.g., if you give this flag then tcpdump will print ``nic&#39;</span><span class="sc">&#39; instead of ``nic.ddn.mil&#39;</span><span class="sc">&#39;.

    -#
    --number
           Print an optional packet number at the beginning of the line.

    -O
    --no-optimize
           Do not run the packet-matching code optimizer.  This is useful only if you suspect a bug in the optimizer.

    -p
    --no-promiscuous-mode
           Don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">promiscuous</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w">  </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">promiscuous</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">reason</span><span class="p">;</span><span class="w"> </span><span class="n">hence</span><span class="p">,</span><span class="w"> </span><span class="err">`</span><span class="o">-</span><span class="n">p</span><span class="sc">&#39; cannot be used
           as an abbreviation for `ether host {local-hw-addr} or ether broadcast&#39;</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">Q</span><span class="w"> </span><span class="n">direction</span><span class="w">
    </span><span class="o">--</span><span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="w">
           </span><span class="nc">Choose</span><span class="w"> </span><span class="n">send</span><span class="o">/</span><span class="k">receive</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">captured</span><span class="o">.</span><span class="w"> </span><span class="nc">Possible</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="err">`</span><span class="ow">in</span><span class="sc">&#39;, `out&#39;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="err">`</span><span class="n">inout</span><span class="sc">&#39;. Not available on all  plat‐
           forms.

    -q     Quick (quiet?) output.  Print less protocol information so output lines are shorter.

    -r file
           Read  packets  from file (which was created with the -w option or by other tools that write pcap or pcap-ng files).  Standard input is used if file is
           ``-&#39;</span><span class="sc">&#39;.

    -S
    --absolute-tcp-sequence-numbers
           Print absolute, rather than relative, TCP sequence numbers.

    -s snaplen
    --snapshot-length=snaplen
           Snarf snaplen bytes of data from each packet rather than the default of 262144 bytes.  Packets truncated because of a limited snapshot  are  indicated
           in  the  output  with ``[|proto]&#39;</span><span class="sc">&#39;, where proto is the name of the protocol level at which the truncation has occurred.  Note that taking larger snap‐
           shots both increases the amount of time it takes to process packets and, effectively, decreases the amount of packet buffering.  This may cause  pack‐
           ets  to be lost.  You should limit snaplen to the smallest number that will capture the protocol information you&#39;</span><span class="n">re</span><span class="w"> </span><span class="n">interested</span><span class="w"> </span><span class="ow">in</span><span class="o">.</span><span class="w">  </span><span class="nc">Setting</span><span class="w"> </span><span class="n">snaplen</span><span class="w"> </span><span class="n">to</span><span class="w">
           </span><span class="mi">0</span><span class="w"> </span><span class="n">sets</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">262144</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">backwards</span><span class="w"> </span><span class="n">compatibility</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">versions</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">tcpdump</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">T</span><span class="w"> </span><span class="n">type</span><span class="w">
           </span><span class="nc">Force</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">selected</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="s">&quot;expression&quot;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">type</span><span class="o">.</span><span class="w">  </span><span class="nc">Currently</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">aodv</span><span class="w"> </span><span class="p" data-group-id="5767690389-11">(</span><span class="nc">Ad</span><span class="o">-</span><span class="n">hoc</span><span class="w"> </span><span class="nc">On</span><span class="o">-</span><span class="n">demand</span><span class="w"> </span><span class="nc">Distance</span><span class="w"> </span><span class="nc">Vector</span><span class="w">  </span><span class="n">proto</span><span class="err">‐</span><span class="w">
           </span><span class="n">col</span><span class="p" data-group-id="5767690389-11">)</span><span class="p">,</span><span class="w">  </span><span class="n">carp</span><span class="w">  </span><span class="p" data-group-id="5767690389-12">(</span><span class="nc">Common</span><span class="w">  </span><span class="nc">Address</span><span class="w">  </span><span class="nc">Redundancy</span><span class="w"> </span><span class="nc">Protocol</span><span class="p" data-group-id="5767690389-12">)</span><span class="p">,</span><span class="w"> </span><span class="n">cnfp</span><span class="w"> </span><span class="p" data-group-id="5767690389-13">(</span><span class="nc">Cisco</span><span class="w"> </span><span class="nc">NetFlow</span><span class="w"> </span><span class="n">protocol</span><span class="p" data-group-id="5767690389-13">)</span><span class="p">,</span><span class="w"> </span><span class="n">lmp</span><span class="w"> </span><span class="p" data-group-id="5767690389-14">(</span><span class="nc">Link</span><span class="w"> </span><span class="nc">Management</span><span class="w"> </span><span class="nc">Protocol</span><span class="p" data-group-id="5767690389-14">)</span><span class="p">,</span><span class="w"> </span><span class="n">pgm</span><span class="w"> </span><span class="p" data-group-id="5767690389-15">(</span><span class="nc">Pragmatic</span><span class="w"> </span><span class="nc">General</span><span class="w"> </span><span class="nc">Multicast</span><span class="p" data-group-id="5767690389-15">)</span><span class="p">,</span><span class="w">
           </span><span class="n">pgm_zmtp1</span><span class="w"> </span><span class="p" data-group-id="5767690389-16">(</span><span class="nc">ZMTP</span><span class="o">/</span><span class="mf">1.0</span><span class="w"> </span><span class="n">inside</span><span class="w"> </span><span class="nc">PGM</span><span class="o">/</span><span class="nc">EPGM</span><span class="p" data-group-id="5767690389-16">)</span><span class="p">,</span><span class="w"> </span><span class="n">resp</span><span class="w"> </span><span class="p" data-group-id="5767690389-17">(</span><span class="nc">REdis</span><span class="w"> </span><span class="nc">Serialization</span><span class="w"> </span><span class="nc">Protocol</span><span class="p" data-group-id="5767690389-17">)</span><span class="p">,</span><span class="w"> </span><span class="n">radius</span><span class="w"> </span><span class="p" data-group-id="5767690389-18">(</span><span class="nc">RADIUS</span><span class="p" data-group-id="5767690389-18">)</span><span class="p">,</span><span class="w"> </span><span class="n">rpc</span><span class="w"> </span><span class="p" data-group-id="5767690389-19">(</span><span class="nc">Remote</span><span class="w"> </span><span class="nc">Procedure</span><span class="w"> </span><span class="nc">Call</span><span class="p" data-group-id="5767690389-19">)</span><span class="p">,</span><span class="w"> </span><span class="n">rtp</span><span class="w">  </span><span class="p" data-group-id="5767690389-20">(</span><span class="nc">Real</span><span class="o">-</span><span class="nc">Time</span><span class="w">  </span><span class="nc">Applications</span><span class="w">
           </span><span class="n">protocol</span><span class="p" data-group-id="5767690389-20">)</span><span class="p">,</span><span class="w"> </span><span class="n">rtcp</span><span class="w"> </span><span class="p" data-group-id="5767690389-21">(</span><span class="nc">Real</span><span class="o">-</span><span class="nc">Time</span><span class="w"> </span><span class="nc">Applications</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">protocol</span><span class="p" data-group-id="5767690389-21">)</span><span class="p">,</span><span class="w"> </span><span class="n">snmp</span><span class="w"> </span><span class="p" data-group-id="5767690389-22">(</span><span class="nc">Simple</span><span class="w"> </span><span class="nc">Network</span><span class="w"> </span><span class="nc">Management</span><span class="w"> </span><span class="nc">Protocol</span><span class="p" data-group-id="5767690389-22">)</span><span class="p">,</span><span class="w"> </span><span class="n">tftp</span><span class="w"> </span><span class="p" data-group-id="5767690389-23">(</span><span class="nc">Trivial</span><span class="w"> </span><span class="nc">File</span><span class="w"> </span><span class="nc">Transfer</span><span class="w"> </span><span class="nc">Protocol</span><span class="p" data-group-id="5767690389-23">)</span><span class="p">,</span><span class="w"> </span><span class="n">vat</span><span class="w"> </span><span class="p" data-group-id="5767690389-24">(</span><span class="nc">Vis</span><span class="err">‐</span><span class="w">
           </span><span class="n">ual</span><span class="w"> </span><span class="nc">Audio</span><span class="w"> </span><span class="nc">Tool</span><span class="p" data-group-id="5767690389-24">)</span><span class="p">,</span><span class="w"> </span><span class="n">wb</span><span class="w"> </span><span class="p" data-group-id="5767690389-25">(</span><span class="n">distributed</span><span class="w"> </span><span class="nc">White</span><span class="w"> </span><span class="nc">Board</span><span class="p" data-group-id="5767690389-25">)</span><span class="p">,</span><span class="w"> </span><span class="n">zmtp1</span><span class="w"> </span><span class="p" data-group-id="5767690389-26">(</span><span class="nc">ZeroMQ</span><span class="w"> </span><span class="nc">Message</span><span class="w"> </span><span class="nc">Transport</span><span class="w"> </span><span class="nc">Protocol</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="5767690389-26">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">vxlan</span><span class="w"> </span><span class="p" data-group-id="5767690389-27">(</span><span class="nc">Virtual</span><span class="w"> </span><span class="n">eXtensible</span><span class="w"> </span><span class="nc">Local</span><span class="w"> </span><span class="nc">Area</span><span class="w"> </span><span class="nc">Network</span><span class="p" data-group-id="5767690389-27">)</span><span class="o">.</span><span class="w">

           </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pgm</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">affects</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">interpretation</span><span class="w"> </span><span class="n">only</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">native</span><span class="w"> </span><span class="nc">PGM</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">recognised</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="mi">113</span><span class="w"> </span><span class="n">regardless</span><span class="o">.</span><span class="w"> </span><span class="nc">UDP</span><span class="o">-</span><span class="n">encapsulated</span><span class="w">  </span><span class="nc">PGM</span><span class="w">
           </span><span class="n">is</span><span class="w"> </span><span class="n">often</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="s">&quot;EPGM&quot;</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s">&quot;PGM/UDP&quot;</span><span class="o">.</span><span class="w">

           </span><span class="nc">Note</span><span class="w">  </span><span class="n">that</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">pgm_zmtp1</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">affects</span><span class="w"> </span><span class="n">interpretation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">native</span><span class="w"> </span><span class="nc">PGM</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">once</span><span class="o">.</span><span class="w"> </span><span class="nc">During</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">native</span><span class="w"> </span><span class="nc">PGM</span><span class="w"> </span><span class="n">decoding</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">of</span><span class="w">
           </span><span class="n">an</span><span class="w"> </span><span class="nc">ODATA</span><span class="o">/</span><span class="nc">RDATA</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">decoded</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">ZeroMQ</span><span class="w"> </span><span class="n">datagram</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">ZMTP</span><span class="o">/</span><span class="mf">1.0</span><span class="w"> </span><span class="n">frames</span><span class="o">.</span><span class="w">  </span><span class="nc">During</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">decoding</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">addition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w">
           </span><span class="n">treated</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">encapsulated</span><span class="w"> </span><span class="nc">PGM</span><span class="w"> </span><span class="n">packet</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="n">t</span><span class="w">     </span><span class="nc">Don</span><span class="sc">&#39;t print a timestamp on each dump line.

    -tt    Print the timestamp, as seconds since January 1, 1970, 00:00:00, UTC, and fractions of a second since that time, on each dump line.

    -ttt   Print a delta (micro-second resolution) between current and previous line on each dump line.

    -tttt  Print a timestamp, as hours, minutes, seconds, and fractions of a second since midnight, preceded by the date, on each dump line.

    -ttttt Print a delta (micro-second resolution) between current and first line on each dump line.

    -u     Print undecoded NFS handles.

    -U
    --packet-buffered
           If  the  -w  option  is  not specified, make the printed packet output ``packet-buffered&#39;</span><span class="sc">&#39;; i.e., as the description of the contents of each packet is
           printed, it will be written to the standard output, rather than, when not writing to a terminal, being written only when the output buffer fills.

           If the -w option is specified, make the saved raw packet output ``packet-buffered&#39;</span><span class="sc">&#39;; i.e., as each packet is saved, it will be written to  the  output
           file, rather than being written only when the output buffer fills.

           The -U flag will not be supported if tcpdump was built with an older version of libpcap that lacks the pcap_dump_flush() function.

    -v     When  parsing  and printing, produce (slightly more) verbose output.  For example, the time to live, identification, total length and options in an IP
           packet are printed.  Also enables additional packet integrity checks such as verifying the IP and ICMP header checksum.

           When writing to a file with the -w option, report, every 10 seconds, the number of packets captured.

    -vv    Even more verbose output.  For example, additional fields are printed from NFS reply packets, and SMB packets are fully decoded.

    -vvv   Even more verbose output.  For example, telnet SB ... SE options are printed in full.  With -X Telnet options are printed in hex as well.

    -V file
           Read a list of filenames from file. Standard input is used if file is ``-&#39;</span><span class="sc">&#39;.

    -w file
           Write the raw packets to file rather than parsing and printing them out.  They can later be printed with the -r option.  Standard output  is  used  if
           file is ``-&#39;</span><span class="sc">&#39;.

           This  output  will be buffered if written to a file or pipe, so a program reading from the file or pipe may not see packets for an arbitrary amount of
           time after they are received.  Use the -U flag to cause packets to be written as soon as they are received.

           The MIME type application/vnd.tcpdump.pcap has been registered with IANA for pcap files. The filename extension .pcap appears to be the most  commonly
           used  along  with  .cap and .dmp. Tcpdump itself doesn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">extension</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">reading</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">doesn</span><span class="sc">&#39;t add an extension when writing them
           (it uses magic numbers in the file header instead). However, many operating systems and applications will use the  extension  if  it  is  present  and
           adding one (e.g. .pcap) is recommended.

           See pcap-savefile(5) for a description of the file format.

    -W     Used  in conjunction with the -C option, this will limit the number of files created to the specified number, and begin overwriting files from the be‐
           ginning, thus creating a &#39;</span><span class="n">rotating</span><span class="sc">&#39; buffer.  In addition, it will name the files with enough leading 0s to support the maximum number of files, allow‐
           ing them to sort correctly.

           Used  in  conjunction  with  the -G option, this will limit the number of rotated dump files that get created, exiting with status 0 when reaching the
           limit. If used with -C as well, the behavior will result in cyclical files per timeslice.

    -x     When parsing and printing, in addition to printing the headers of each packet, print the data of each packet (minus its link  level  header)  in  hex.
           The  smaller of the entire packet or snaplen bytes will be printed.  Note that this is the entire link-layer packet, so for link layers that pad (e.g.
           Ethernet), the padding bytes will also be printed when the higher layer packet is shorter than the required padding.

    -xx    When parsing and printing, in addition to printing the headers of each packet, print the data of each packet, including its link level header, in hex.

    -X     When parsing and printing, in addition to printing the headers of each packet, print the data of each packet (minus its link level header) in hex  and
           ASCII.  This is very handy for analysing new protocols.

    -XX    When  parsing and printing, in addition to printing the headers of each packet, print the data of each packet, including its link level header, in hex
           and ASCII.

    -y datalinktype
    --linktype=datalinktype
           Set the data link type to use while capturing packets to datalinktype.

    -z postrotate-command
           Used in conjunction with the -C or -G options, this will make tcpdump run &quot; postrotate-command file &quot; where file is the savefile  being  closed  after
           each rotation. For example, specifying -z gzip or -z bzip2 will compress each savefile using gzip or bzip2.

           Note that tcpdump will run the command in parallel to the capture, using the lowest priority so that this doesn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">disturb</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="w">

           </span><span class="nc">And</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="k">case</span><span class="w">  </span><span class="n">you</span><span class="w">  </span><span class="n">would</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">arguments</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">the</span><span class="w">
           </span><span class="n">savefile</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">argument</span><span class="p">,</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">arrangements</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="o">.</span><span class="w">

    </span><span class="o">-</span><span class="nc">Z</span><span class="w"> </span><span class="n">user</span><span class="w">
    </span><span class="o">--</span><span class="n">relinquish</span><span class="o">-</span><span class="n">privileges</span><span class="o">=</span><span class="n">user</span><span class="w">
           </span><span class="nc">If</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">opening</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">savefile</span><span class="p">,</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="nc">ID</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="nc">ID</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">primary</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">of</span><span class="w">
           </span><span class="n">user</span><span class="o">.</span><span class="w">

           </span><span class="nc">This</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="p" data-group-id="5767690389-28">(</span><span class="o">-</span><span class="nc">Z</span><span class="w"> </span><span class="n">tcpdump</span><span class="p" data-group-id="5767690389-28">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">disabled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">-</span><span class="nc">Z</span><span class="w"> </span><span class="n">root</span><span class="o">.</span><span class="w">

     </span><span class="n">expression</span><span class="w">
           </span><span class="n">selects</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">dumped</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">dumped</span><span class="o">.</span><span class="w">  </span><span class="nc">Otherwise</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">expression</span><span class="w">
           </span><span class="n">is</span><span class="w"> </span><span class="err">`</span><span class="no">true</span><span class="err">&#39;</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">dumped</span><span class="o">.</span><span class="w">

           </span><span class="nc">For</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="n">syntax</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">pcap</span><span class="o">-</span><span class="n">filter</span><span class="p" data-group-id="5767690389-29">(</span><span class="mi">7</span><span class="p" data-group-id="5767690389-29">)</span><span class="o">.</span><span class="w">

           </span><span class="nc">The</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="nc">Shell</span><span class="w"> </span><span class="n">argument</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="nc">Shell</span><span class="w">  </span><span class="n">arguments</span><span class="p">,</span><span class="w">  </span><span class="n">whichever</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">more</span><span class="w">  </span><span class="n">convenient</span><span class="o">.</span><span class="w">
           </span><span class="nc">Generally</span><span class="p">,</span><span class="w">  </span><span class="k">if</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">expression</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="nc">Shell</span><span class="w"> </span><span class="n">metacharacters</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">backslashes</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">escape</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">names</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">easier</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="p">,</span><span class="w">
           </span><span class="n">quoted</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">escape</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Shell</span><span class="w"> </span><span class="n">metacharacters</span><span class="o">.</span><span class="w">  </span><span class="nc">Multiple</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">concatenated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">spaces</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">parsed</span><span class="o">.</span></code></pre><h2 id="examples" class="section-heading">
  <a href="#examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  EXAMPLES
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="nc">To</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">arriving</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">departing</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="ss">sundown</span><span class="p">:</span><span class="w">
           </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">sundown</span><span class="w">

    </span><span class="nc">To</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">helios</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">hot</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ss">ace</span><span class="p">:</span><span class="w">
           </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">helios</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="err">\</span><span class="p" data-group-id="3540640460-1">(</span><span class="w"> </span><span class="n">hot</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">ace</span><span class="w"> </span><span class="err">\</span><span class="p" data-group-id="3540640460-1">)</span><span class="w">

    </span><span class="nc">To</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">ace</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">except</span><span class="w"> </span><span class="ss">helios</span><span class="p">:</span><span class="w">
           </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">ace</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">helios</span><span class="w">

    </span><span class="nc">To</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">hosts</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hosts</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="ss">Berkeley</span><span class="p">:</span><span class="w">
           </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="n">ucb</span><span class="o">-</span><span class="n">ether</span><span class="w">

    </span><span class="nc">To</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">ftp</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">internet</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="ss">snup</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3540640460-2">(</span><span class="n">note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">quoted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="p" data-group-id="3540640460-3">(</span><span class="n">mis</span><span class="o">-</span><span class="p" data-group-id="3540640460-3">)</span><span class="n">interpreting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">parentheses</span><span class="p" data-group-id="3540640460-2">)</span><span class="p">:</span><span class="w">
           </span><span class="n">tcpdump</span><span class="w"> </span><span class="sc">&#39;gateway snup and (port ftp or ftp-data)&#39;</span><span class="w">

    </span><span class="nc">To</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">traffic</span><span class="w"> </span><span class="n">neither</span><span class="w"> </span><span class="n">sourced</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">nor</span><span class="w"> </span><span class="n">destined</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">hosts</span><span class="w"> </span><span class="p" data-group-id="3540640460-4">(</span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">net</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">stuff</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">onto</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">net</span><span class="p" data-group-id="3540640460-4">)</span><span class="o">.</span><span class="w">
           </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="n">localnet</span><span class="w">

    </span><span class="nc">To</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="p" data-group-id="3540640460-5">(</span><span class="n">the</span><span class="w"> </span><span class="nc">SYN</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">FIN</span><span class="w"> </span><span class="n">packets</span><span class="p" data-group-id="3540640460-5">)</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">conversation</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">involves</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">local</span><span class="w"> </span><span class="n">host</span><span class="o">.</span><span class="w">
           </span><span class="n">tcpdump</span><span class="w"> </span><span class="sc">&#39;tcp[tcpflags] &amp; (tcp-syn|tcp-fin) != 0 and not src and dst net localnet&#39;</span><span class="w">

    </span><span class="nc">To</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="nc">HTTP</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="nc">SYN</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">FIN</span><span class="w"> </span><span class="n">packets</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="nc">ACK</span><span class="o">-</span><span class="n">only</span><span class="w">  </span><span class="n">packets</span><span class="o">.</span><span class="w">
    </span><span class="p" data-group-id="3540640460-6">(</span><span class="nc">IPv6</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">exercise</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">reader</span><span class="o">.</span><span class="p" data-group-id="3540640460-6">)</span><span class="w">
           </span><span class="n">tcpdump</span><span class="w"> </span><span class="sc">&#39;tcp port 80 and (((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) != 0)&#39;</span><span class="w">

    </span><span class="nc">To</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">576</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">gateway</span><span class="w"> </span><span class="ss">snup</span><span class="p">:</span><span class="w">
           </span><span class="n">tcpdump</span><span class="w"> </span><span class="sc">&#39;gateway snup and ip[2:2] &gt; 576&#39;</span><span class="w">

    </span><span class="nc">To</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">broadcast</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">multicast</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="nc">Ethernet</span><span class="w"> </span><span class="n">broadcast</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ss">multicast</span><span class="p">:</span><span class="w">
           </span><span class="n">tcpdump</span><span class="w"> </span><span class="sc">&#39;ether[0] &amp; 1 = 0 and ip[16] &gt;= 224&#39;</span><span class="w">

    </span><span class="nc">To</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nc">ICMP</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">requests</span><span class="o">/</span><span class="n">replies</span><span class="w"> </span><span class="p" data-group-id="3540640460-7">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="n">packets</span><span class="p" data-group-id="3540640460-7">)</span><span class="p">:</span><span class="w">
           </span><span class="n">tcpdump</span><span class="w"> </span><span class="sc">&#39;icmp[icmptype] != icmp-echo and icmp[icmptype] != icmp-echoreply&#39;</span></code></pre><p> OUTPUT FORMAT</p><pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="nc">The</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">dependent</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">gives</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">brief</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">examples</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">formats</span><span class="o">.</span><span class="w">

    </span><span class="nc">Timestamps</span><span class="w">

    </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">preceded</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">timestamp</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">timestamp</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">clock</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w">
           </span><span class="n">hh</span><span class="ss">:mm</span><span class="ss">:ss</span><span class="o">.</span><span class="n">frac</span><span class="w">
    </span><span class="ow">and</span><span class="w">  </span><span class="n">is</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">accurate</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="sc">&#39;s clock.  The timestamp reflects the time the kernel applied a time stamp to the packet.  No attempt is made to account for
    the time lag between when the network interface finished receiving the packet from the network and when the kernel applied a time stamp to the  packet;  that
    time  lag  could  include a delay between the time when the network interface finished receiving a packet from the network and the time when an interrupt was
    delivered to the kernel to get it to read the packet and a delay between the time when the kernel serviced the `new packet&#39;</span><span class="w"> </span><span class="n">interrupt</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">time</span><span class="w">  </span><span class="ow">when</span><span class="w">  </span><span class="n">it</span><span class="w">
    </span><span class="n">applied</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">stamp</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="o">.</span><span class="w">

    </span><span class="nc">Link</span><span class="w"> </span><span class="nc">Level</span><span class="w"> </span><span class="nc">Headers</span><span class="w">

    </span><span class="nc">If</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="sc">&#39;-e&#39;</span><span class="w">  </span><span class="n">option</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">given</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">out</span><span class="o">.</span><span class="w">  </span><span class="nc">On</span><span class="w"> </span><span class="nc">Ethernets</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">addresses</span><span class="p">,</span><span class="w"> </span><span class="n">protocol</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">are</span><span class="w">
    </span><span class="n">printed</span><span class="o">.</span><span class="w">

    </span><span class="nc">On</span><span class="w"> </span><span class="nc">FDDI</span><span class="w"> </span><span class="n">networks</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="sc">&#39;-e&#39;</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">causes</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="n">frame</span><span class="w"> </span><span class="n">control</span><span class="sc">&#39; field,  the source and destination addresses, and  the  packet  length.   (The
    `frame control&#39;</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">governs</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">interpretation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rest</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="o">.</span><span class="w">  </span><span class="nc">Normal</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="p" data-group-id="9738888467-1">(</span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">datagrams</span><span class="p" data-group-id="9738888467-1">)</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="err">`</span><span class="n">async</span><span class="sc">&#39; packets, with
    a priority value between 0 and 7; for example, `async4&#39;</span><span class="o">.</span><span class="w">  </span><span class="nc">Such</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">assumed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="mf">802.2</span><span class="w"> </span><span class="nc">Logical</span><span class="w"> </span><span class="nc">Link</span><span class="w"> </span><span class="nc">Control</span><span class="w"> </span><span class="p" data-group-id="9738888467-2">(</span><span class="nc">LLC</span><span class="p" data-group-id="9738888467-2">)</span><span class="w"> </span><span class="n">packet</span><span class="p">;</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">LLC</span><span class="w">  </span><span class="n">header</span><span class="w">  </span><span class="n">is</span><span class="w">
    </span><span class="n">printed</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">ISO</span><span class="w"> </span><span class="n">datagram</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">so</span><span class="o">-</span><span class="n">called</span><span class="w"> </span><span class="nc">SNAP</span><span class="w"> </span><span class="n">packet</span><span class="o">.</span><span class="w">

    </span><span class="nc">On</span><span class="w">  </span><span class="nc">Token</span><span class="w">  </span><span class="nc">Ring</span><span class="w">  </span><span class="n">networks</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;-e&#39;</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">causes</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="n">access</span><span class="w"> </span><span class="n">control</span><span class="sc">&#39; and `frame control&#39;</span><span class="w"> </span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">addresses</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w">
    </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">length</span><span class="o">.</span><span class="w">  </span><span class="nc">As</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">FDDI</span><span class="w"> </span><span class="n">networks</span><span class="p">,</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">assumed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">LLC</span><span class="w"> </span><span class="n">packet</span><span class="o">.</span><span class="w">  </span><span class="nc">Regardless</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;-e&#39;</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w">
    </span><span class="n">routing</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">source</span><span class="o">-</span><span class="n">routed</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">

    </span><span class="nc">On</span><span class="w"> </span><span class="mf">802.11</span><span class="w"> </span><span class="n">networks</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="sc">&#39;-e&#39;</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">causes</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="n">frame</span><span class="w"> </span><span class="n">control</span><span class="sc">&#39; fields, all of the addresses in the 802.11 header, and the packet length.  As
    on FDDI networks, packets are assumed to contain an LLC packet.

    (N.B.: The following description assumes familiarity with the SLIP compression algorithm described in RFC-1144.)

    On SLIP links, a direction indicator (``I&#39;</span><span class="sc">&#39; for inbound, ``O&#39;</span><span class="sc">&#39; for outbound), packet type, and compression information are printed out.  The packet  type  is
    printed  first.   The three types are ip, utcp, and ctcp.  No further link information is printed for ip packets.  For TCP packets, the connection identifier
    is printed following the type.  If the packet is compressed, its encoded header is printed out.  The special cases are printed out as *S+n and *SA+n, where n
    is  the  amount  by  which  the  sequence number (or sequence number and ack) has changed.  If it is not a special case, zero or more changes are printed.  A
    change is indicated by U (urgent pointer), W (window), A (ack), S (sequence number), and I (packet ID), followed by a delta (+n or -n), or a new value  (=n).
    Finally, the amount of data in the packet and compressed header length are printed.

    For  example, the following line shows an outbound compressed TCP packet, with an implicit connection identifier; the ack has changed by 6, the sequence num‐
    ber by 49, and the packet ID by 6; there are 3 bytes of data and 6 bytes of compressed header:
           O ctcp * A+6 S+49 I+6 3 (6)

    ARP/RARP Packets

    Arp/rarp output shows the type of request and its arguments.  The format is intended to be self explanatory.  Here is a short sample taken from the start  of
    an `rlogin&#39;</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">rtsg</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="ss">csam</span><span class="p">:</span><span class="w">
           </span><span class="n">arp</span><span class="w"> </span><span class="n">who</span><span class="o">-</span><span class="n">has</span><span class="w"> </span><span class="n">csam</span><span class="w"> </span><span class="n">tell</span><span class="w"> </span><span class="n">rtsg</span><span class="w">
           </span><span class="n">arp</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">csam</span><span class="w"> </span><span class="n">is</span><span class="o">-</span><span class="n">at</span><span class="w"> </span><span class="nc">CSAM</span><span class="w">
    </span><span class="nc">The</span><span class="w">  </span><span class="n">first</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">says</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">rtsg</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">arp</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">asking</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Ethernet</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">internet</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">csam</span><span class="o">.</span><span class="w">  </span><span class="nc">Csam</span><span class="w"> </span><span class="n">replies</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="nc">Ethernet</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="p" data-group-id="9738888467-3">(</span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">ex</span><span class="err">‐</span><span class="w">
    </span><span class="n">ample</span><span class="p">,</span><span class="w"> </span><span class="nc">Ethernet</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">caps</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">internet</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="k">case</span><span class="p" data-group-id="9738888467-3">)</span><span class="o">.</span><span class="w">

    </span><span class="nc">This</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">redundant</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="ss">n</span><span class="p">:</span><span class="w">
           </span><span class="n">arp</span><span class="w"> </span><span class="n">who</span><span class="o">-</span><span class="n">has</span><span class="w"> </span><span class="mf">128.3</span><span class="o">.</span><span class="mf">254.6</span><span class="w"> </span><span class="n">tell</span><span class="w"> </span><span class="mf">128.3</span><span class="o">.</span><span class="mf">254.68</span><span class="w">
           </span><span class="n">arp</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="mf">128.3</span><span class="o">.</span><span class="mf">254.6</span><span class="w"> </span><span class="n">is</span><span class="o">-</span><span class="n">at</span><span class="w"> </span><span class="mi">02</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="ss">:c4</span><span class="w">

    </span><span class="nc">If</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fact</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">broadcast</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">point</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">point</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="ss">visible</span><span class="p">:</span><span class="w">
           </span><span class="nc">RTSG</span><span class="w"> </span><span class="nc">Broadcast</span><span class="w"> </span><span class="mi">0806</span><span class="w">  </span><span class="mi">64</span><span class="p">:</span><span class="w"> </span><span class="n">arp</span><span class="w"> </span><span class="n">who</span><span class="o">-</span><span class="n">has</span><span class="w"> </span><span class="n">csam</span><span class="w"> </span><span class="n">tell</span><span class="w"> </span><span class="n">rtsg</span><span class="w">
           </span><span class="nc">CSAM</span><span class="w"> </span><span class="nc">RTSG</span><span class="w"> </span><span class="mi">0806</span><span class="w">  </span><span class="mi">64</span><span class="p">:</span><span class="w"> </span><span class="n">arp</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">csam</span><span class="w"> </span><span class="n">is</span><span class="o">-</span><span class="n">at</span><span class="w"> </span><span class="nc">CSAM</span><span class="w">
    </span><span class="nc">For</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">says</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Ethernet</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nc">RTSG</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Ethernet</span><span class="w"> </span><span class="n">broadcast</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">type</span><span class="w">  </span><span class="n">field</span><span class="w">  </span><span class="n">contained</span><span class="w">  </span><span class="n">hex</span><span class="w">  </span><span class="mi">0806</span><span class="w">
    </span><span class="p" data-group-id="9738888467-4">(</span><span class="n">type</span><span class="w"> </span><span class="nc">ETHER_ARP</span><span class="p" data-group-id="9738888467-4">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="o">.</span><span class="w">

    </span><span class="nc">IPv4</span><span class="w"> </span><span class="nc">Packets</span><span class="w">

    </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">link</span><span class="o">-</span><span class="n">layer</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">printed</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">packets</span><span class="p">,</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">stamp</span><span class="o">.</span><span class="w">

    </span><span class="nc">If</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">shown</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">parentheses</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">link</span><span class="o">-</span><span class="n">layer</span><span class="w"> </span><span class="n">header</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="ow">in</span><span class="err">‐</span><span class="w">
    </span><span class="n">formation</span><span class="w"> </span><span class="ss">is</span><span class="p">:</span><span class="w">
           </span><span class="n">tos</span><span class="w"> </span><span class="n">tos</span><span class="p">,</span><span class="w"> </span><span class="n">ttl</span><span class="w"> </span><span class="n">ttl</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="p" data-group-id="9738888467-5">[</span><span class="n">flags</span><span class="p" data-group-id="9738888467-5">]</span><span class="p">,</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">proto</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p" data-group-id="9738888467-6">(</span><span class="n">options</span><span class="p" data-group-id="9738888467-6">)</span><span class="w">
    </span><span class="n">tos</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">field</span><span class="p">;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">ECN</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="p">,</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">reported</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">ECT</span><span class="p" data-group-id="9738888467-7">(</span><span class="mi">1</span><span class="p" data-group-id="9738888467-7">)</span><span class="p">,</span><span class="w"> </span><span class="nc">ECT</span><span class="p" data-group-id="9738888467-8">(</span><span class="mi">0</span><span class="p" data-group-id="9738888467-8">)</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">CE</span><span class="o">.</span><span class="w">  </span><span class="n">ttl</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">reported</span><span class="w">  </span><span class="k">if</span><span class="w">
    </span><span class="n">it</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">zero</span><span class="o">.</span><span class="w">   </span><span class="n">id</span><span class="w">  </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">identification</span><span class="w"> </span><span class="n">field</span><span class="o">.</span><span class="w">  </span><span class="n">offset</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fragment</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">field</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fragmented</span><span class="w"> </span><span class="n">datagram</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="o">.</span><span class="w">
    </span><span class="n">flags</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">MF</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">DF</span><span class="w"> </span><span class="n">flags</span><span class="p">;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reported</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nc">MF</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">DFP</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reported</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nc">F</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">neither</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reported</span><span class="o">.</span><span class="w">  </span><span class="n">proto</span><span class="w">  </span><span class="n">is</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">protocol</span><span class="w">  </span><span class="nc">ID</span><span class="w">
    </span><span class="n">field</span><span class="o">.</span><span class="w">  </span><span class="n">length</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">field</span><span class="o">.</span><span class="w">  </span><span class="n">options</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">options</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">any</span><span class="o">.</span><span class="w">

    </span><span class="nc">Next</span><span class="p">,</span><span class="w">  </span><span class="k">for</span><span class="w">  </span><span class="nc">TCP</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">packets</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">ports</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dot</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w">
    </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">printed</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">separating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">destination</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">protocols</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">printed</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">separating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">des</span><span class="err">‐</span><span class="w">
    </span><span class="n">tination</span><span class="o">.</span><span class="w">  </span><span class="nc">Higher</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">information</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">any</span><span class="p">,</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">that</span><span class="o">.</span><span class="w">

    </span><span class="nc">For</span><span class="w"> </span><span class="n">fragmented</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">datagrams</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">fragment</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">header</span><span class="p">;</span><span class="w"> </span><span class="n">fragments</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">header</span><span class="o">.</span><span class="w">
    </span><span class="nc">Fragmentation</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">information</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="n">above</span><span class="o">.</span><span class="w">

    </span><span class="nc">TCP</span><span class="w"> </span><span class="nc">Packets</span><span class="w">

    </span><span class="p" data-group-id="9738888467-9">(</span><span class="nc">N.B</span><span class="o">.</span><span class="ss">:The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">assumes</span><span class="w"> </span><span class="n">familiarity</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">RFC</span><span class="o">-</span><span class="mi">793</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">familiar</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">protocol</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w">  </span><span class="n">description</span><span class="w">
    </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">much</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">you</span><span class="o">.</span><span class="p" data-group-id="9738888467-9">)</span><span class="w">

    </span><span class="nc">The</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="ss">is</span><span class="p">:</span><span class="w">
           </span><span class="n">src</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="ss">dst</span><span class="p">:</span><span class="w"> </span><span class="nc">Flags</span><span class="w"> </span><span class="p" data-group-id="9738888467-10">[</span><span class="n">tcpflags</span><span class="p" data-group-id="9738888467-10">]</span><span class="p">,</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="n">data</span><span class="o">-</span><span class="n">seqno</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="n">ackno</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="n">urg</span><span class="w"> </span><span class="n">urgent</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p" data-group-id="9738888467-11">[</span><span class="n">opts</span><span class="p" data-group-id="9738888467-11">]</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">len</span><span class="w">
    </span><span class="nc">Src</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">dst</span><span class="w">  </span><span class="n">are</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ports</span><span class="o">.</span><span class="w">  </span><span class="nc">Tcpflags</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">combination</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">S</span><span class="w"> </span><span class="p" data-group-id="9738888467-12">(</span><span class="nc">SYN</span><span class="p" data-group-id="9738888467-12">)</span><span class="p">,</span><span class="w"> </span><span class="nc">F</span><span class="w"> </span><span class="p" data-group-id="9738888467-13">(</span><span class="nc">FIN</span><span class="p" data-group-id="9738888467-13">)</span><span class="p">,</span><span class="w"> </span><span class="nc">P</span><span class="w"> </span><span class="p" data-group-id="9738888467-14">(</span><span class="nc">PUSH</span><span class="p" data-group-id="9738888467-14">)</span><span class="p">,</span><span class="w"> </span><span class="nc">R</span><span class="w"> </span><span class="p" data-group-id="9738888467-15">(</span><span class="nc">RST</span><span class="p" data-group-id="9738888467-15">)</span><span class="p">,</span><span class="w"> </span><span class="nc">U</span><span class="w"> </span><span class="p" data-group-id="9738888467-16">(</span><span class="nc">URG</span><span class="p" data-group-id="9738888467-16">)</span><span class="p">,</span><span class="w"> </span><span class="nc">W</span><span class="w"> </span><span class="p" data-group-id="9738888467-17">(</span><span class="nc">ECN</span><span class="w">
    </span><span class="nc">CWR</span><span class="p" data-group-id="9738888467-17">)</span><span class="p">,</span><span class="w"> </span><span class="nc">E</span><span class="w"> </span><span class="p" data-group-id="9738888467-18">(</span><span class="nc">ECN</span><span class="o">-</span><span class="nc">Echo</span><span class="p" data-group-id="9738888467-18">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="err">`</span><span class="o">.</span><span class="sc">&#39; (ACK), or `none&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">Data</span><span class="o">-</span><span class="n">seqno</span><span class="w"> </span><span class="n">describes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">portion</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">covered</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w">  </span><span class="n">packet</span><span class="w">  </span><span class="p" data-group-id="9738888467-19">(</span><span class="n">see</span><span class="w">
    </span><span class="n">example</span><span class="w">  </span><span class="n">below</span><span class="p" data-group-id="9738888467-19">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Ackno</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w">  </span><span class="nc">Window</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">buffer</span><span class="w">
    </span><span class="n">space</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">connection</span><span class="o">.</span><span class="w">  </span><span class="nc">Urg</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="err">`</span><span class="n">urgent</span><span class="sc">&#39; data in the packet.  Opts are TCP options (e.g., mss 1024).  Len  is
    the length of payload data.

    Iptype, Src, dst, and flags are always present.  The other fields depend on the contents of the packet&#39;</span><span class="n">s</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">appropri</span><span class="err">‐</span><span class="w">
    </span><span class="n">ate</span><span class="o">.</span><span class="w">

    </span><span class="nc">Here</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">opening</span><span class="w"> </span><span class="n">portion</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">rlogin</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">rtsg</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">csam</span><span class="o">.</span><span class="w">
           </span><span class="nc">IP</span><span class="w"> </span><span class="n">rtsg</span><span class="o">.</span><span class="mi">1023</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">csam</span><span class="o">.</span><span class="ss">login</span><span class="p">:</span><span class="w"> </span><span class="nc">Flags</span><span class="w"> </span><span class="p" data-group-id="9738888467-20">[</span><span class="nc">S</span><span class="p" data-group-id="9738888467-20">]</span><span class="p">,</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">768512</span><span class="p">:</span><span class="mi">768512</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">4096</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p" data-group-id="9738888467-21">[</span><span class="n">mss</span><span class="w"> </span><span class="mi">1024</span><span class="p" data-group-id="9738888467-21">]</span><span class="w">
           </span><span class="nc">IP</span><span class="w"> </span><span class="n">csam</span><span class="o">.</span><span class="n">login</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">rtsg</span><span class="o">.</span><span class="mi">1023</span><span class="p">:</span><span class="w"> </span><span class="nc">Flags</span><span class="w"> </span><span class="p" data-group-id="9738888467-22">[</span><span class="nc">S</span><span class="o">.</span><span class="p" data-group-id="9738888467-22">]</span><span class="p">,</span><span class="w"> </span><span class="n">seq</span><span class="p">,</span><span class="w"> </span><span class="mi">947648</span><span class="p">:</span><span class="mi">947648</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">768513</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">4096</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p" data-group-id="9738888467-23">[</span><span class="n">mss</span><span class="w"> </span><span class="mi">1024</span><span class="p" data-group-id="9738888467-23">]</span><span class="w">
           </span><span class="nc">IP</span><span class="w"> </span><span class="n">rtsg</span><span class="o">.</span><span class="mi">1023</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">csam</span><span class="o">.</span><span class="ss">login</span><span class="p">:</span><span class="w"> </span><span class="nc">Flags</span><span class="w"> </span><span class="p" data-group-id="9738888467-24">[</span><span class="o">.</span><span class="p" data-group-id="9738888467-24">]</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">4096</span><span class="w">
           </span><span class="nc">IP</span><span class="w"> </span><span class="n">rtsg</span><span class="o">.</span><span class="mi">1023</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">csam</span><span class="o">.</span><span class="ss">login</span><span class="p">:</span><span class="w"> </span><span class="nc">Flags</span><span class="w"> </span><span class="p" data-group-id="9738888467-25">[</span><span class="nc">P</span><span class="o">.</span><span class="p" data-group-id="9738888467-25">]</span><span class="p">,</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">4096</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">1</span><span class="w">
           </span><span class="nc">IP</span><span class="w"> </span><span class="n">csam</span><span class="o">.</span><span class="n">login</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">rtsg</span><span class="o">.</span><span class="mi">1023</span><span class="p">:</span><span class="w"> </span><span class="nc">Flags</span><span class="w"> </span><span class="p" data-group-id="9738888467-26">[</span><span class="o">.</span><span class="p" data-group-id="9738888467-26">]</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">4096</span><span class="w">
           </span><span class="nc">IP</span><span class="w"> </span><span class="n">rtsg</span><span class="o">.</span><span class="mi">1023</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">csam</span><span class="o">.</span><span class="ss">login</span><span class="p">:</span><span class="w"> </span><span class="nc">Flags</span><span class="w"> </span><span class="p" data-group-id="9738888467-27">[</span><span class="nc">P</span><span class="o">.</span><span class="p" data-group-id="9738888467-27">]</span><span class="p">,</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">4096</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">19</span><span class="w">
           </span><span class="nc">IP</span><span class="w"> </span><span class="n">csam</span><span class="o">.</span><span class="n">login</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">rtsg</span><span class="o">.</span><span class="mi">1023</span><span class="p">:</span><span class="w"> </span><span class="nc">Flags</span><span class="w"> </span><span class="p" data-group-id="9738888467-28">[</span><span class="nc">P</span><span class="o">.</span><span class="p" data-group-id="9738888467-28">]</span><span class="p">,</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">4077</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">1</span><span class="w">
           </span><span class="nc">IP</span><span class="w"> </span><span class="n">csam</span><span class="o">.</span><span class="n">login</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">rtsg</span><span class="o">.</span><span class="mi">1023</span><span class="p">:</span><span class="w"> </span><span class="nc">Flags</span><span class="w"> </span><span class="p" data-group-id="9738888467-29">[</span><span class="nc">P</span><span class="o">.</span><span class="p" data-group-id="9738888467-29">]</span><span class="p">,</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">4077</span><span class="p">,</span><span class="w"> </span><span class="n">urg</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">1</span><span class="w">
           </span><span class="nc">IP</span><span class="w"> </span><span class="n">csam</span><span class="o">.</span><span class="n">login</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">rtsg</span><span class="o">.</span><span class="mi">1023</span><span class="p">:</span><span class="w"> </span><span class="nc">Flags</span><span class="w"> </span><span class="p" data-group-id="9738888467-30">[</span><span class="nc">P</span><span class="o">.</span><span class="p" data-group-id="9738888467-30">]</span><span class="p">,</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">4077</span><span class="p">,</span><span class="w"> </span><span class="n">urg</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="nc">The</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">says</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">1023</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">rtsg</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">login</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">csam</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="nc">S</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SYN</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">packet</span><span class="w">  </span><span class="n">sequence</span><span class="w">  </span><span class="n">number</span><span class="w">
    </span><span class="n">was</span><span class="w">  </span><span class="mi">768512</span><span class="w">  </span><span class="ow">and</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">contained</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="w">  </span><span class="p" data-group-id="9738888467-31">(</span><span class="nc">The</span><span class="w"> </span><span class="n">notation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="err">`</span><span class="n">first</span><span class="ss">:last</span><span class="sc">&#39; which means `sequence numbers first up to but not including last.)  There was no piggy-
    backed ack, the available receive window was 4096 bytes and there was a max-segment-size option requesting an mss of 1024 bytes.

    Csam replies with a similar packet except it includes a piggy-backed ack for rtsg&#39;</span><span class="n">s</span><span class="w"> </span><span class="nc">SYN</span><span class="o">.</span><span class="w">  </span><span class="nc">Rtsg</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">acks</span><span class="w"> </span><span class="n">csam</span><span class="sc">&#39;s SYN.  The `.&#39;</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="nc">ACK</span><span class="w">  </span><span class="n">flag</span><span class="w">  </span><span class="n">was</span><span class="w">  </span><span class="n">set</span><span class="o">.</span><span class="w">
    </span><span class="nc">The</span><span class="w">  </span><span class="n">packet</span><span class="w">  </span><span class="n">contained</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">length</span><span class="o">.</span><span class="w">  </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">small</span><span class="w"> </span><span class="n">integer</span><span class="w"> </span><span class="p" data-group-id="9738888467-32">(</span><span class="mi">1</span><span class="p" data-group-id="9738888467-32">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">tcp</span><span class="err">‐</span><span class="w">
    </span><span class="n">dump</span><span class="w"> </span><span class="n">sees</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="err">`</span><span class="n">conversation</span><span class="sc">&#39;, it prints the sequence number from the packet.  On subsequent packets of the conversation, the difference between the current
    packet&#39;</span><span class="n">s</span><span class="w">  </span><span class="n">sequence</span><span class="w">  </span><span class="n">number</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">relative</span><span class="w"> </span><span class="n">byte</span><span class="w">
    </span><span class="n">positions</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="sc">&#39;s data stream (with the first data byte each direction being `1&#39;</span><span class="p" data-group-id="9738888467-31">)</span><span class="o">.</span><span class="w">  </span><span class="err">`</span><span class="o">-</span><span class="nc">S</span><span class="sc">&#39; will override this feature, causing the  original  se‐
    quence numbers to be output.

    On  the 6th line, rtsg sends csam 19 bytes of data (bytes 2 through 20 in the rtsg → csam side of the conversation).  The PUSH flag is set in the packet.  On
    the 7th line, csam says it&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">rtsg</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="mi">21</span><span class="o">.</span><span class="w">  </span><span class="nc">Most</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">apparently</span><span class="w"> </span><span class="n">sitting</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">buffer</span><span class="w">  </span><span class="n">since</span><span class="w">
    </span><span class="n">csam</span><span class="sc">&#39;s  receive window has gotten 19 bytes smaller.  Csam also sends one byte of data to rtsg in this packet.  On the 8th and 9th lines, csam sends two bytes
    of urgent, pushed data to rtsg.

    If the snapshot was small enough that tcpdump didn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">interprets</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">much</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">then</span><span class="w">  </span><span class="n">reports</span><span class="w">  </span><span class="err">`</span><span class="err">`</span><span class="p" data-group-id="9738888467-33">[</span><span class="o">|</span><span class="n">tcp</span><span class="p" data-group-id="9738888467-33">]</span><span class="sc">&#39;&#39;</span><span class="w">
    </span><span class="n">to</span><span class="w">  </span><span class="n">indicate</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">remainder</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">interpreted</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">bogus</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="p" data-group-id="9738888467-34">(</span><span class="n">one</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">that</span><span class="sc">&#39;s either too small or beyond the end of
    the header), tcpdump reports it as ``[bad opt]&#39;</span><span class="sc">&#39; and does not interpret any further options (since it&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">impossible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">tell</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">start</span><span class="p" data-group-id="9738888467-34">)</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">header</span><span class="w">
    </span><span class="n">length</span><span class="w">  </span><span class="n">indicates</span><span class="w">  </span><span class="n">options</span><span class="w">  </span><span class="n">are</span><span class="w">  </span><span class="n">present</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">datagram</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">enough</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">actually</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">there</span><span class="p">,</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">reports</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="err">`</span><span class="err">`</span><span class="p" data-group-id="9738888467-35">[</span><span class="n">bad</span><span class="w"> </span><span class="n">hdr</span><span class="w">
    </span><span class="n">length</span><span class="p" data-group-id="9738888467-35">]</span><span class="sc">&#39;&#39;</span><span class="o">.</span><span class="w">

    </span><span class="nc">Capturing</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">combinations</span><span class="w"> </span><span class="p" data-group-id="9738888467-36">(</span><span class="nc">SYN</span><span class="o">-</span><span class="nc">ACK</span><span class="p">,</span><span class="w"> </span><span class="nc">URG</span><span class="o">-</span><span class="nc">ACK</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="o">.</span><span class="p" data-group-id="9738888467-36">)</span><span class="w">

    </span><span class="nc">There</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="ss">header</span><span class="p">:</span><span class="w">

           </span><span class="nc">CWR</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">ECE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">URG</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">ACK</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">PSH</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">RST</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">SYN</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">FIN</span><span class="w">

    </span><span class="nc">Let</span><span class="sc">&#39;s assume that we want to watch packets used in establishing a TCP connection.  Recall that TCP uses a 3-way handshake protocol when it initializes a  new
    connection; the connection sequence with regard to the TCP control bits is

           1) Caller sends SYN
           2) Recipient responds with SYN, ACK
           3) Caller sends ACK

    Now  we&#39;</span><span class="n">re</span><span class="w"> </span><span class="n">interested</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">capturing</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SYN</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="p" data-group-id="9738888467-37">(</span><span class="nc">Step</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="9738888467-37">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">don</span><span class="sc">&#39;t want packets from step 2 (SYN-ACK), just a plain ini‐
    tial SYN.  What we need is a correct filter expression for tcpdump.

    Recall the structure of a TCP header without options:

     0                            15                              31
    -----------------------------------------------------------------
    |          source port          |       destination port        |
    -----------------------------------------------------------------
    |                        sequence number                        |
    -----------------------------------------------------------------
    |                     acknowledgment number                     |
    -----------------------------------------------------------------
    |  HL   | rsvd  |C|E|U|A|P|R|S|F|        window size            |
    -----------------------------------------------------------------
    |         TCP checksum          |       urgent pointer          |
    -----------------------------------------------------------------

    A TCP header usually holds 20 octets of data, unless options are present.  The first line of the graph contains octets 0 - 3, the second line shows octets  4
    - 7 etc.

    Starting to count with 0, the relevant TCP control bits are contained in octet 13:

     0             7|             15|             23|             31
    ----------------|---------------|---------------|----------------
    |  HL   | rsvd  |C|E|U|A|P|R|S|F|        window size            |
    ----------------|---------------|---------------|----------------
    |               |  13th octet   |               |               |

    Let&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">closer</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">octet</span><span class="w"> </span><span class="n">no</span><span class="o">.</span><span class="w"> </span><span class="mi">13</span><span class="p">:</span><span class="w">

                    </span><span class="o">|</span><span class="w">               </span><span class="o">|</span><span class="w">
                    </span><span class="o">|</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">|</span><span class="w">
                    </span><span class="o">|</span><span class="nc">C</span><span class="o">|</span><span class="nc">E</span><span class="o">|</span><span class="nc">U</span><span class="o">|</span><span class="nc">A</span><span class="o">|</span><span class="nc">P</span><span class="o">|</span><span class="nc">R</span><span class="o">|</span><span class="nc">S</span><span class="o">|</span><span class="nc">F</span><span class="o">|</span><span class="w">
                    </span><span class="o">|</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">|</span><span class="w">
                    </span><span class="o">|</span><span class="mi">7</span><span class="w">   </span><span class="mi">5</span><span class="w">   </span><span class="mi">3</span><span class="w">     </span><span class="mi">0</span><span class="o">|</span><span class="w">

    </span><span class="nc">These</span><span class="w">  </span><span class="n">are</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="nc">TCP</span><span class="w">  </span><span class="n">control</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">interested</span><span class="w"> </span><span class="ow">in</span><span class="o">.</span><span class="w">  </span><span class="nc">We</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">numbered</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">octet</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PSH</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="n">while</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">URG</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="mi">5</span><span class="o">.</span><span class="w">

    </span><span class="nc">Recall</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="nc">SYN</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">Let</span><span class="sc">&#39;s see what happens to octet 13 if a TCP datagram arrives with the SYN bit set in its header:

                    |C|E|U|A|P|R|S|F|
                    |---------------|
                    |0 0 0 0 0 0 1 0|
                    |---------------|
                    |7 6 5 4 3 2 1 0|

    Looking at the control bits section we see that only bit number 1 (SYN) is set.

    Assuming that octet number 13 is an 8-bit unsigned integer in network byte order, the binary value of this octet is

           00000010

    and its decimal representation is

       7     6     5     4     3     2     1     0
    0*2 + 0*2 + 0*2 + 0*2 + 0*2 + 0*2 + 1*2 + 0*2  =  2

    We&#39;</span><span class="n">re</span><span class="w"> </span><span class="n">almost</span><span class="w"> </span><span class="n">done</span><span class="p">,</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="nc">SYN</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="mi">13</span><span class="n">th</span><span class="w"> </span><span class="n">octet</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="mi">8</span><span class="o">-</span><span class="n">bit</span><span class="w">  </span><span class="n">unsigned</span><span class="w">  </span><span class="n">integer</span><span class="w">
    </span><span class="ow">in</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">exactly</span><span class="w"> </span><span class="mi">2</span><span class="o">.</span><span class="w">

    </span><span class="nc">This</span><span class="w"> </span><span class="n">relationship</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">expressed</span><span class="w"> </span><span class="n">as</span><span class="w">
           </span><span class="n">tcp</span><span class="p" data-group-id="9738888467-38">[</span><span class="mi">13</span><span class="p" data-group-id="9738888467-38">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w">

    </span><span class="nc">We</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">watch</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="nc">SYN</span><span class="w"> </span><span class="ss">set</span><span class="p">:</span><span class="w">
           </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">xl0</span><span class="w"> </span><span class="n">tcp</span><span class="p" data-group-id="9738888467-39">[</span><span class="mi">13</span><span class="p" data-group-id="9738888467-39">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w">

    </span><span class="nc">The</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="n">says</span><span class="w"> </span><span class="s">&quot;let the 13th octet of a TCP datagram have the decimal value 2&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">exactly</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">want</span><span class="o">.</span><span class="w">

    </span><span class="nc">Now</span><span class="p">,</span><span class="w"> </span><span class="n">let</span><span class="sc">&#39;s assume that we need to capture SYN packets, but we don&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">care</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nc">ACK</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="w">  </span><span class="nc">Let</span><span class="sc">&#39;s see what happens
    to octet 13 when a TCP datagram with SYN-ACK set arrives:

         |C|E|U|A|P|R|S|F|
         |---------------|
         |0 0 0 1 0 0 1 0|
         |---------------|
         |7 6 5 4 3 2 1 0|

    Now bits 1 and 4 are set in the 13th octet.  The binary value of octet 13 is

                00010010

    which translates to decimal

       7     6     5     4     3     2     1     0
    0*2 + 0*2 + 0*2 + 1*2 + 0*2 + 0*2 + 1*2 + 0*2   = 18

    Now we can&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="sc">&#39;tcp[13] == 18&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">expression</span><span class="p">,</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="nc">SYN</span><span class="o">-</span><span class="nc">ACK</span><span class="w">  </span><span class="n">set</span><span class="p">,</span><span class="w">  </span><span class="n">but</span><span class="w">  </span><span class="ow">not</span><span class="w">  </span><span class="n">those</span><span class="w">
    </span><span class="k">with</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="nc">SYN</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">Remember</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">don</span><span class="sc">&#39;t care if ACK or any other control bit is set as long as SYN is set.

    In  order to achieve our goal, we need to logically AND the binary value of octet 13 with some other value to preserve the SYN bit.  We know that we want SYN
    to be set in any case, so we&#39;</span><span class="n">ll</span><span class="w"> </span><span class="n">logically</span><span class="w"> </span><span class="nc">AND</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="mi">13</span><span class="n">th</span><span class="w"> </span><span class="n">octet</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">binary</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ss">SYN</span><span class="p">:</span><span class="w">

              </span><span class="mi">00010010</span><span class="w"> </span><span class="nc">SYN</span><span class="o">-</span><span class="nc">ACK</span><span class="w">              </span><span class="mi">00000010</span><span class="w"> </span><span class="nc">SYN</span><span class="w">
         </span><span class="nc">AND</span><span class="w">  </span><span class="mi">00000010</span><span class="w"> </span><span class="p" data-group-id="9738888467-40">(</span><span class="n">we</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="nc">SYN</span><span class="p" data-group-id="9738888467-40">)</span><span class="w">   </span><span class="nc">AND</span><span class="w">  </span><span class="mi">00000010</span><span class="w"> </span><span class="p" data-group-id="9738888467-41">(</span><span class="n">we</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="nc">SYN</span><span class="p" data-group-id="9738888467-41">)</span><span class="w">
              </span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="w">                      </span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="w">
         </span><span class="o">=</span><span class="w">    </span><span class="mi">00000010</span><span class="w">                 </span><span class="o">=</span><span class="w">    </span><span class="mi">00000010</span><span class="w">

    </span><span class="nc">We</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="nc">AND</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">delivers</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="n">regardless</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="nc">ACK</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="nc">TCP</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w">  </span><span class="n">decimal</span><span class="w">  </span><span class="n">representation</span><span class="w">  </span><span class="n">of</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="nc">AND</span><span class="w">
    </span><span class="n">value</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p" data-group-id="9738888467-42">(</span><span class="n">binary</span><span class="w"> </span><span class="mi">00000010</span><span class="p" data-group-id="9738888467-42">)</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">SYN</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">relation</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="ss">true</span><span class="p">:</span><span class="w">

           </span><span class="p" data-group-id="9738888467-43">(</span><span class="w"> </span><span class="p" data-group-id="9738888467-44">(</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">octet</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="p" data-group-id="9738888467-44">)</span><span class="w"> </span><span class="nc">AND</span><span class="w"> </span><span class="p" data-group-id="9738888467-45">(</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p" data-group-id="9738888467-45">)</span><span class="w"> </span><span class="p" data-group-id="9738888467-43">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p" data-group-id="9738888467-46">(</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p" data-group-id="9738888467-46">)</span><span class="w">

    </span><span class="nc">This</span><span class="w"> </span><span class="n">points</span><span class="w"> </span><span class="n">us</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">expression</span><span class="w">
                </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">xl0</span><span class="w"> </span><span class="sc">&#39;tcp[13] &amp; 2 == 2&#39;</span><span class="w">

    </span><span class="nc">Some</span><span class="w">  </span><span class="n">offsets</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">expressed</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">numeric</span><span class="w"> </span><span class="n">values</span><span class="o">.</span><span class="w"> </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">tcp</span><span class="p" data-group-id="9738888467-47">[</span><span class="mi">13</span><span class="p" data-group-id="9738888467-47">]</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">replaced</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">tcp</span><span class="p" data-group-id="9738888467-48">[</span><span class="n">tcpflags</span><span class="p" data-group-id="9738888467-48">]</span><span class="o">.</span><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w">
    </span><span class="nc">TCP</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="ss">available</span><span class="p">:</span><span class="w"> </span><span class="n">tcp</span><span class="o">-</span><span class="n">fin</span><span class="p">,</span><span class="w"> </span><span class="n">tcp</span><span class="o">-</span><span class="n">syn</span><span class="p">,</span><span class="w"> </span><span class="n">tcp</span><span class="o">-</span><span class="n">rst</span><span class="p">,</span><span class="w"> </span><span class="n">tcp</span><span class="o">-</span><span class="n">push</span><span class="p">,</span><span class="w"> </span><span class="n">tcp</span><span class="o">-</span><span class="n">act</span><span class="p">,</span><span class="w"> </span><span class="n">tcp</span><span class="o">-</span><span class="n">urg</span><span class="o">.</span><span class="w">

    </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">demonstrated</span><span class="w"> </span><span class="ss">as</span><span class="p">:</span><span class="w">
                </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">xl0</span><span class="w"> </span><span class="sc">&#39;tcp[tcpflags] &amp; tcp-push != 0&#39;</span><span class="w">

    </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">quotes</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">backslash</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">hide</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">AND</span><span class="w"> </span><span class="p" data-group-id="9738888467-49">(</span><span class="sc">&#39;&amp;&#39;</span><span class="p" data-group-id="9738888467-49">)</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">shell</span><span class="o">.</span><span class="w">

    </span><span class="nc">UDP</span><span class="w"> </span><span class="nc">Packets</span><span class="w">

    </span><span class="nc">UDP</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">illustrated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">rwho</span><span class="w"> </span><span class="ss">packet</span><span class="p">:</span><span class="w">
           </span><span class="n">actinide</span><span class="o">.</span><span class="n">who</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">broadcast</span><span class="o">.</span><span class="ss">who</span><span class="p">:</span><span class="w"> </span><span class="n">udp</span><span class="w"> </span><span class="mi">84</span><span class="w">
    </span><span class="nc">This</span><span class="w"> </span><span class="n">says</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">who</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">actinide</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">udp</span><span class="w"> </span><span class="n">datagram</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">who</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">broadcast</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Internet</span><span class="w"> </span><span class="n">broadcast</span><span class="w"> </span><span class="n">address</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">contained</span><span class="w"> </span><span class="mi">84</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">of</span><span class="w">
    </span><span class="n">user</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="w">

    </span><span class="nc">Some</span><span class="w">  </span><span class="nc">UDP</span><span class="w"> </span><span class="n">services</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">recognized</span><span class="w"> </span><span class="p" data-group-id="9738888467-50">(</span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">destination</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">number</span><span class="p" data-group-id="9738888467-50">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">printed</span><span class="o">.</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="n">particular</span><span class="p">,</span><span class="w"> </span><span class="nc">Domain</span><span class="w"> </span><span class="nc">Name</span><span class="w">
    </span><span class="n">service</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="p" data-group-id="9738888467-51">(</span><span class="nc">RFC</span><span class="o">-</span><span class="mi">1034</span><span class="o">/</span><span class="mi">1035</span><span class="p" data-group-id="9738888467-51">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Sun</span><span class="w"> </span><span class="nc">RPC</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="p" data-group-id="9738888467-52">(</span><span class="nc">RFC</span><span class="o">-</span><span class="mi">1050</span><span class="p" data-group-id="9738888467-52">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">NFS</span><span class="o">.</span><span class="w">

    </span><span class="nc">UDP</span><span class="w"> </span><span class="nc">Name</span><span class="w"> </span><span class="nc">Server</span><span class="w"> </span><span class="nc">Requests</span><span class="w">

    </span><span class="p" data-group-id="9738888467-53">(</span><span class="nc">N.B</span><span class="o">.</span><span class="ss">:The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">assumes</span><span class="w"> </span><span class="n">familiarity</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Domain</span><span class="w"> </span><span class="nc">Service</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">RFC</span><span class="o">-</span><span class="mi">1035</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">familiar</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">protocol</span><span class="p">,</span><span class="w">  </span><span class="n">the</span><span class="w">
    </span><span class="n">following</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">appear</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">greek</span><span class="o">.</span><span class="p" data-group-id="9738888467-53">)</span><span class="w">

    </span><span class="nc">Name</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">formatted</span><span class="w"> </span><span class="n">as</span><span class="w">
           </span><span class="n">src</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="ss">dst</span><span class="p">:</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">op?</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="n">qtype</span><span class="w"> </span><span class="n">qclass</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p" data-group-id="9738888467-54">(</span><span class="n">len</span><span class="p" data-group-id="9738888467-54">)</span><span class="w">
           </span><span class="n">h2opolo</span><span class="o">.</span><span class="mi">1538</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">helios</span><span class="o">.</span><span class="ss">domain</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="o">+</span><span class="w"> </span><span class="nc">A</span><span class="sc">? </span><span class="n">ucbvax</span><span class="o">.</span><span class="n">berkeley</span><span class="o">.</span><span class="n">edu</span><span class="o">.</span><span class="w"> </span><span class="p" data-group-id="9738888467-55">(</span><span class="mi">37</span><span class="p" data-group-id="9738888467-55">)</span><span class="w">
    </span><span class="nc">Host</span><span class="w">  </span><span class="n">h2opolo</span><span class="w"> </span><span class="n">asked</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">helios</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">record</span><span class="w"> </span><span class="p" data-group-id="9738888467-56">(</span><span class="n">qtype</span><span class="o">=</span><span class="nc">A</span><span class="p" data-group-id="9738888467-56">)</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">ucbvax</span><span class="o">.</span><span class="n">berkeley</span><span class="o">.</span><span class="n">edu</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="err">`</span><span class="mi">3</span><span class="sc">&#39;.  The `+&#39;</span><span class="w">
    </span><span class="n">indicates</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">recursion</span><span class="w"> </span><span class="n">desired</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="mi">37</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">headers</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w">  </span><span class="n">query</span><span class="w">  </span><span class="n">operation</span><span class="w">  </span><span class="n">was</span><span class="w">  </span><span class="n">the</span><span class="w">
    </span><span class="n">normal</span><span class="w">  </span><span class="n">one</span><span class="p">,</span><span class="w">  </span><span class="nc">Query</span><span class="p">,</span><span class="w">  </span><span class="n">so</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">omitted</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">anything</span><span class="w"> </span><span class="k">else</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="mi">3</span><span class="sc">&#39; and the `+&#39;</span><span class="o">.</span><span class="w">  </span><span class="nc">Similarly</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w">
    </span><span class="n">qclass</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="nc">C_IN</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">omitted</span><span class="o">.</span><span class="w">  </span><span class="nc">Any</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">qclass</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="nc">A</span><span class="sc">&#39;.

    A few anomalies are checked and may result in extra fields enclosed in square brackets:  If a query contains  an  answer,  authority  records  or  additional
    records  section,  ancount,  nscount, or arcount are printed as `[na]&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="9738888467-57">[</span><span class="n">nn</span><span class="p" data-group-id="9738888467-57">]</span><span class="sc">&#39; or  `[nau]&#39;</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">appropriate</span><span class="w"> </span><span class="n">count</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="n">are</span><span class="w">
    </span><span class="n">set</span><span class="w"> </span><span class="p" data-group-id="9738888467-58">(</span><span class="nc">AA</span><span class="p">,</span><span class="w"> </span><span class="nc">RA</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">rcode</span><span class="p" data-group-id="9738888467-58">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">zero</span><span class="sc">&#39; bits are set in bytes two and three, `[b2&amp;3=x]&#39;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="p">,</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hex</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">header</span><span class="w">  </span><span class="n">bytes</span><span class="w">  </span><span class="n">two</span><span class="w">
    </span><span class="ow">and</span><span class="w"> </span><span class="n">three</span><span class="o">.</span><span class="w">

    </span><span class="nc">UDP</span><span class="w"> </span><span class="nc">Name</span><span class="w"> </span><span class="nc">Server</span><span class="w"> </span><span class="nc">Responses</span><span class="w">

    </span><span class="nc">Name</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">responses</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">formatted</span><span class="w"> </span><span class="n">as</span><span class="w">
           </span><span class="n">src</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="ss">dst</span><span class="p">:</span><span class="w">  </span><span class="n">id</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="n">rcode</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="n">a</span><span class="o">/</span><span class="n">n</span><span class="o">/</span><span class="n">au</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="p" data-group-id="9738888467-59">(</span><span class="n">len</span><span class="p" data-group-id="9738888467-59">)</span><span class="w">
           </span><span class="n">helios</span><span class="o">.</span><span class="n">domain</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">h2opolo</span><span class="o">.</span><span class="mi">1538</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">3</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="mi">7</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="mf">128.32</span><span class="o">.</span><span class="mf">137.3</span><span class="w"> </span><span class="p" data-group-id="9738888467-60">(</span><span class="mi">273</span><span class="p" data-group-id="9738888467-60">)</span><span class="w">
           </span><span class="n">helios</span><span class="o">.</span><span class="n">domain</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">h2opolo</span><span class="o">.</span><span class="mi">1537</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nc">NXDomain</span><span class="o">*</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="w"> </span><span class="p" data-group-id="9738888467-61">(</span><span class="mi">97</span><span class="p" data-group-id="9738888467-61">)</span><span class="w">
    </span><span class="nc">In</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">first</span><span class="w">  </span><span class="n">example</span><span class="p">,</span><span class="w">  </span><span class="n">helios</span><span class="w"> </span><span class="n">responds</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">h2opolo</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="n">records</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">records</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">records</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">answer</span><span class="w">
    </span><span class="n">record</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="p" data-group-id="9738888467-62">(</span><span class="n">address</span><span class="p" data-group-id="9738888467-62">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">internet</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="mf">128.32</span><span class="o">.</span><span class="mf">137.3</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="mi">273</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="n">excluding</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">IP</span><span class="w">  </span><span class="n">headers</span><span class="o">.</span><span class="w">   </span><span class="nc">The</span><span class="w">
    </span><span class="n">op</span><span class="w"> </span><span class="p" data-group-id="9738888467-63">(</span><span class="nc">Query</span><span class="p" data-group-id="9738888467-63">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="p" data-group-id="9738888467-64">(</span><span class="nc">NoError</span><span class="p" data-group-id="9738888467-64">)</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="p" data-group-id="9738888467-65">(</span><span class="nc">C_IN</span><span class="p" data-group-id="9738888467-65">)</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="n">record</span><span class="o">.</span><span class="w">

    </span><span class="nc">In</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">second</span><span class="w">  </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">helios</span><span class="w"> </span><span class="n">responds</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">existent</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="p" data-group-id="9738888467-66">(</span><span class="nc">NXDomain</span><span class="p" data-group-id="9738888467-66">)</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">answers</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">authority</span><span class="w">
    </span><span class="n">records</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="err">`</span><span class="o">*</span><span class="sc">&#39; indicates that the authoritative answer bit was set.  Since there were no answers, no type, class or data were printed.

    Other flag characters that might appear are `-&#39;</span><span class="w"> </span><span class="p" data-group-id="9738888467-67">(</span><span class="n">recursion</span><span class="w"> </span><span class="n">available</span><span class="p">,</span><span class="w"> </span><span class="nc">RA</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">set</span><span class="p" data-group-id="9738888467-67">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="err">`</span><span class="o">|</span><span class="sc">&#39; (truncated message, TC, set).  If the `question&#39;</span><span class="w">  </span><span class="n">section</span><span class="w">  </span><span class="n">doesn</span><span class="sc">&#39;t
    contain exactly one entry, `[nq]&#39;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="o">.</span><span class="w">

    </span><span class="nc">SMB</span><span class="o">/</span><span class="nc">CIFS</span><span class="w"> </span><span class="n">decoding</span><span class="w">

    </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">includes</span><span class="w"> </span><span class="n">fairly</span><span class="w"> </span><span class="n">extensive</span><span class="w"> </span><span class="nc">SMB</span><span class="o">/</span><span class="nc">CIFS</span><span class="o">/</span><span class="nc">NBT</span><span class="w"> </span><span class="n">decoding</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">UDP</span><span class="o">/</span><span class="mi">137</span><span class="p">,</span><span class="w"> </span><span class="nc">UDP</span><span class="o">/</span><span class="mi">138</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">TCP</span><span class="o">/</span><span class="mi">139</span><span class="o">.</span><span class="w">  </span><span class="nc">Some</span><span class="w"> </span><span class="n">primitive</span><span class="w"> </span><span class="n">decoding</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">IPX</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">NetBEUI</span><span class="w"> </span><span class="nc">SMB</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">is</span><span class="w">
    </span><span class="n">also</span><span class="w"> </span><span class="n">done</span><span class="o">.</span><span class="w">

    </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fairly</span><span class="w"> </span><span class="n">minimal</span><span class="w"> </span><span class="n">decode</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">done</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">much</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="n">decode</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">  </span><span class="nc">Be</span><span class="w"> </span><span class="n">warned</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="nc">SMB</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">may</span><span class="w">  </span><span class="n">take</span><span class="w">  </span><span class="n">up</span><span class="w">  </span><span class="n">a</span><span class="w">
    </span><span class="n">page</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">really</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">gory</span><span class="w"> </span><span class="n">details</span><span class="o">.</span><span class="w">

    </span><span class="nc">For</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="nc">SMB</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">formats</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">www</span><span class="o">.</span><span class="n">cifs</span><span class="o">.</span><span class="n">org</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pub</span><span class="o">/</span><span class="n">samba</span><span class="o">/</span><span class="n">specs</span><span class="o">/</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">favorite</span><span class="w"> </span><span class="n">samba</span><span class="o">.</span><span class="n">org</span><span class="w"> </span><span class="n">mirror</span><span class="w"> </span><span class="n">site</span><span class="o">.</span><span class="w">
    </span><span class="nc">The</span><span class="w"> </span><span class="nc">SMB</span><span class="w"> </span><span class="n">patches</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">Andrew</span><span class="w"> </span><span class="nc">Tridgell</span><span class="w"> </span><span class="p" data-group-id="9738888467-68">(</span><span class="n">tridge</span><span class="na">@samba</span><span class="o">.</span><span class="n">org</span><span class="p" data-group-id="9738888467-68">)</span><span class="o">.</span><span class="w">

    </span><span class="nc">NFS</span><span class="w"> </span><span class="nc">Requests</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Replies</span><span class="w">

    </span><span class="nc">Sun</span><span class="w"> </span><span class="nc">NFS</span><span class="w"> </span><span class="p" data-group-id="9738888467-69">(</span><span class="nc">Network</span><span class="w"> </span><span class="nc">File</span><span class="w"> </span><span class="nc">System</span><span class="p" data-group-id="9738888467-69">)</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">replies</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="ss">as</span><span class="p">:</span><span class="w">
           </span><span class="n">src</span><span class="o">.</span><span class="n">sport</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">dst</span><span class="o">.</span><span class="ss">nfs</span><span class="p">:</span><span class="w"> </span><span class="nc">NFS</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">xid</span><span class="w"> </span><span class="n">xid</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="n">args</span><span class="w">
           </span><span class="n">src</span><span class="o">.</span><span class="n">nfs</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">dst</span><span class="o">.</span><span class="ss">dport</span><span class="p">:</span><span class="w"> </span><span class="nc">NFS</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">xid</span><span class="w"> </span><span class="n">xid</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">stat</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="n">results</span><span class="w">
           </span><span class="n">sushi</span><span class="o">.</span><span class="mi">1023</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">wrl</span><span class="o">.</span><span class="ss">nfs</span><span class="p">:</span><span class="w"> </span><span class="nc">NFS</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">xid</span><span class="w"> </span><span class="mi">26377</span><span class="w">
                </span><span class="mi">112</span><span class="w"> </span><span class="n">readlink</span><span class="w"> </span><span class="n">fh</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="mi">24</span><span class="o">/</span><span class="mf">10.73165</span><span class="w">
           </span><span class="n">wrl</span><span class="o">.</span><span class="n">nfs</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">sushi</span><span class="o">.</span><span class="mi">1023</span><span class="p">:</span><span class="w"> </span><span class="nc">NFS</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">xid</span><span class="w"> </span><span class="mi">26377</span><span class="w">
                </span><span class="n">reply</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="n">readlink</span><span class="w"> </span><span class="s">&quot;../var&quot;</span><span class="w">
           </span><span class="n">sushi</span><span class="o">.</span><span class="mi">1022</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">wrl</span><span class="o">.</span><span class="ss">nfs</span><span class="p">:</span><span class="w"> </span><span class="nc">NFS</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">xid</span><span class="w"> </span><span class="mi">8219</span><span class="w">
                </span><span class="mi">144</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="n">fh</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="mi">74</span><span class="o">/</span><span class="mf">4096.6878</span><span class="w"> </span><span class="s">&quot;xcolors&quot;</span><span class="w">
           </span><span class="n">wrl</span><span class="o">.</span><span class="n">nfs</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">sushi</span><span class="o">.</span><span class="mi">1022</span><span class="p">:</span><span class="w"> </span><span class="nc">NFS</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">xid</span><span class="w"> </span><span class="mi">8219</span><span class="w">
                </span><span class="n">reply</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="mi">128</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="n">fh</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="mi">74</span><span class="o">/</span><span class="mf">4134.3150</span><span class="w">
    </span><span class="nc">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">sushi</span><span class="w"> </span><span class="n">sends</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">transaction</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="mi">26377</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">wrl</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="mi">112</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="n">excluding</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">headers</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w">  </span><span class="n">operation</span><span class="w">  </span><span class="n">was</span><span class="w">  </span><span class="n">a</span><span class="w">
    </span><span class="n">readlink</span><span class="w"> </span><span class="p" data-group-id="9738888467-70">(</span><span class="n">read</span><span class="w"> </span><span class="n">symbolic</span><span class="w"> </span><span class="n">link</span><span class="p" data-group-id="9738888467-70">)</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="p" data-group-id="9738888467-71">(</span><span class="n">fh</span><span class="p" data-group-id="9738888467-71">)</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="mi">24</span><span class="o">/</span><span class="mf">10.731657119</span><span class="o">.</span><span class="w">  </span><span class="p" data-group-id="9738888467-72">(</span><span class="nc">If</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">lucky</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">case</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">major</span><span class="p">,</span><span class="n">minor</span><span class="w">
    </span><span class="n">device</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">pair</span><span class="p">,</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">inode</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">generation</span><span class="w"> </span><span class="n">number</span><span class="o">.</span><span class="p" data-group-id="9738888467-72">)</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="n">wrl</span><span class="w"> </span><span class="n">replies</span><span class="w"> </span><span class="err">`</span><span class="n">ok</span><span class="sc">&#39; with the same transaction id and  the  contents
    of the link.

    In the third line, sushi asks (using a new transaction id) wrl to lookup the name `xcolors&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="mi">74</span><span class="o">/</span><span class="mf">4096.6878</span><span class="o">.</span><span class="w"> </span><span class="nc">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fourth</span><span class="w"> </span><span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="n">wrl</span><span class="w"> </span><span class="n">sends</span><span class="w"> </span><span class="n">a</span><span class="w">
    </span><span class="n">reply</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">respective</span><span class="w"> </span><span class="n">transaction</span><span class="w"> </span><span class="n">id</span><span class="o">.</span><span class="w">

    </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">depends</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">type</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">intended</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="n">explanatory</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">conjunction</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w">  </span><span class="nc">NFS</span><span class="w">  </span><span class="n">protocol</span><span class="w">  </span><span class="n">spec</span><span class="o">.</span><span class="w">
    </span><span class="nc">Also</span><span class="w"> </span><span class="n">note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">versions</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="nc">NFS</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">slightly</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="ss">format</span><span class="p">:</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">transaction</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="p" data-group-id="9738888467-73">(</span><span class="n">xid</span><span class="p" data-group-id="9738888467-73">)</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">NFS</span><span class="w">
    </span><span class="n">port</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="o">.</span><span class="w">

    </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="p" data-group-id="9738888467-74">(</span><span class="n">verbose</span><span class="p" data-group-id="9738888467-74">)</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="ss">example</span><span class="p">:</span><span class="w">
           </span><span class="n">sushi</span><span class="o">.</span><span class="mi">1023</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">wrl</span><span class="o">.</span><span class="ss">nfs</span><span class="p">:</span><span class="w"> </span><span class="nc">NFS</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">xid</span><span class="w"> </span><span class="mi">79658</span><span class="w">
                </span><span class="mi">148</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">fh</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="mi">11</span><span class="o">/</span><span class="mf">12.195</span><span class="w"> </span><span class="mi">8192</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="mi">24576</span><span class="w">
           </span><span class="n">wrl</span><span class="o">.</span><span class="n">nfs</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">sushi</span><span class="o">.</span><span class="mi">1023</span><span class="p">:</span><span class="w"> </span><span class="nc">NFS</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">xid</span><span class="w"> </span><span class="mi">79658</span><span class="w">
                </span><span class="n">reply</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="mi">1472</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="nc">REG</span><span class="w"> </span><span class="mi">100664</span><span class="w"> </span><span class="n">ids</span><span class="w"> </span><span class="mi">417</span><span class="o">/</span><span class="mi">0</span><span class="w"> </span><span class="n">sz</span><span class="w"> </span><span class="mi">29388</span><span class="w">
    </span><span class="p" data-group-id="9738888467-75">(</span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">prints</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="nc">TTL</span><span class="p">,</span><span class="w"> </span><span class="nc">ID</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">fragmentation</span><span class="w"> </span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">omitted</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">example</span><span class="o">.</span><span class="p" data-group-id="9738888467-75">)</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="n">sushi</span><span class="w">  </span><span class="n">asks</span><span class="w">  </span><span class="n">wrl</span><span class="w">  </span><span class="n">to</span><span class="w">
    </span><span class="n">read</span><span class="w">  </span><span class="mi">8192</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="mi">11</span><span class="o">/</span><span class="mf">12.195</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="mi">24576</span><span class="o">.</span><span class="w">  </span><span class="nc">Wrl</span><span class="w"> </span><span class="n">replies</span><span class="w"> </span><span class="err">`</span><span class="n">ok</span><span class="sc">&#39;; the packet shown on the second line is the first fragment of the reply, and
    hence is only 1472 bytes long (the other bytes will follow in subsequent fragments, but these fragments do not have NFS or even UDP headers and so might  not
    be  printed, depending on the filter expression used).  Because the -v flag is given, some of the file attributes (which are returned in addition to the file
    data) are printed: the file type (``REG&#39;</span><span class="sc">&#39;, for regular file), the file mode (in octal), the uid and gid, and the file size.

    If the -v flag is given more than once, even more details are printed.

    Note that NFS requests are very large and much of the detail won&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">snaplen</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">increased</span><span class="o">.</span><span class="w">  </span><span class="nc">Try</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="err">`</span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mi">192</span><span class="sc">&#39; to watch NFS traffic.

    NFS reply packets do not explicitly identify the RPC operation.  Instead, tcpdump keeps track of ``recent&#39;</span><span class="sc">&#39; requests, and matches them to the  replies  using
    the transaction ID.  If a reply does not closely follow the corresponding request, it might not be parsable.

    AFS Requests and Replies

    Transarc AFS (Andrew File System) requests and replies are printed as:

           src.sport &gt; dst.dport: rx packet-type
           src.sport &gt; dst.dport: rx packet-type service call call-name args
           src.sport &gt; dst.dport: rx packet-type service reply call-name args
           elvis.7001 &gt; pike.afsfs:
                rx data fs call rename old fid 536876964/1/1 &quot;.newsrc.new&quot;
                new fid 536876964/1/1 &quot;.newsrc&quot;
           pike.afsfs &gt; elvis.7001: rx data fs reply rename
    In the first line, host elvis sends a RX packet to pike.  This was a RX data packet to the fs (fileserver) service, and is the start of an RPC call.  The RPC
    call was a rename, with the old directory file id of 536876964/1/1 and an old filename of `.newsrc.new&#39;</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">536876964</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">  </span><span class="ow">and</span><span class="w">  </span><span class="n">a</span><span class="w">
    </span><span class="n">new</span><span class="w">  </span><span class="n">filename</span><span class="w">  </span><span class="n">of</span><span class="w"> </span><span class="err">`</span><span class="o">.</span><span class="n">newsrc</span><span class="sc">&#39;.  The host pike responds with a RPC reply to the rename call (which was successful, because it was a data packet and not an abort
    packet).

    In general, all AFS RPCs are decoded at least by RPC call name.  Most AFS RPCs have at least some of the arguments decoded (generally only the  `interesting&#39;</span><span class="w">
    </span><span class="n">arguments</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">definition</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">interesting</span><span class="p">)</span><span class="o">.</span><span class="w">

    </span><span class="nc">The</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">intended</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">self</span><span class="o">-</span><span class="n">describing</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">probably</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">useful</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">people</span><span class="w"> </span><span class="n">who</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">familiar</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">workings</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">AFS</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">RX</span><span class="o">.</span><span class="w">

    </span><span class="nc">If</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="p" data-group-id="9738888467-76">(</span><span class="n">verbose</span><span class="p" data-group-id="9738888467-76">)</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">twice</span><span class="p">,</span><span class="w"> </span><span class="n">acknowledgement</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">RX</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="nc">ID</span><span class="p">,</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="n">sequence</span><span class="w">
    </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="n">serial</span><span class="w"> </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">RX</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">flags</span><span class="o">.</span><span class="w">

    </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">twice</span><span class="p">,</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">RX</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="nc">ID</span><span class="p">,</span><span class="w"> </span><span class="n">serial</span><span class="w"> </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">RX</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">flags</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="nc">MTU</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="n">infor</span><span class="err">‐</span><span class="w">
    </span><span class="n">mation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="nc">RX</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">

    </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">three</span><span class="w"> </span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">printed</span><span class="o">.</span><span class="w">

    </span><span class="nc">Error</span><span class="w">  </span><span class="n">codes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">abort</span><span class="w"> </span><span class="n">packets</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">exception</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">Ubik</span><span class="w"> </span><span class="n">beacon</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="p" data-group-id="9738888467-77">(</span><span class="n">because</span><span class="w"> </span><span class="n">abort</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">signify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">yes</span><span class="w"> </span><span class="n">vote</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Ubik</span><span class="w"> </span><span class="n">pro</span><span class="err">‐</span><span class="w">
    </span><span class="n">tocol</span><span class="p" data-group-id="9738888467-77">)</span><span class="o">.</span><span class="w">

    </span><span class="nc">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="nc">AFS</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">won</span><span class="sc">&#39;t be printed unless snaplen is increased.  Try using `-s 256&#39;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">watch</span><span class="w"> </span><span class="nc">AFS</span><span class="w"> </span><span class="n">traffic</span><span class="o">.</span><span class="w">

    </span><span class="nc">AFS</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k" data-group-id="9738888467-78">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">identify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">RPC</span><span class="w"> </span><span class="n">operation</span><span class="o">.</span><span class="w">  </span><span class="nc">Instead</span><span class="p">,</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">keeps</span><span class="w"> </span><span class="n">track</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">`</span><span class="err">`</span><span class="n">recent</span><span class="sc">&#39;&#39;</span><span class="w"> </span><span class="n">requests</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">replies</span><span class="w">  </span><span class="n">using</span><span class="w">
    </span><span class="n">the</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="nc">ID</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">closely</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">parsable</span><span class="o">.</span><span class="w">

    </span><span class="nc">KIP</span><span class="w"> </span><span class="nc">AppleTalk</span><span class="w"> </span><span class="p" data-group-id="9738888467-79">(</span><span class="nc">DDP</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">UDP</span><span class="p" data-group-id="9738888467-79">)</span><span class="w">

    </span><span class="nc">AppleTalk</span><span class="w">  </span><span class="nc">DDP</span><span class="w">  </span><span class="n">packets</span><span class="w"> </span><span class="n">encapsulated</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">datagrams</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">de</span><span class="o">-</span><span class="n">encapsulated</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">dumped</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">DDP</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="p" data-group-id="9738888467-80">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">UDP</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">discarded</span><span class="p" data-group-id="9738888467-80">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w">
    </span><span class="n">file</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">atalk</span><span class="o">.</span><span class="n">names</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">translate</span><span class="w"> </span><span class="nc">AppleTalk</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">names</span><span class="o">.</span><span class="w">  </span><span class="nc">Lines</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w">
           </span><span class="n">number</span><span class="w">    </span><span class="n">name</span><span class="w">

           </span><span class="mf">1.254</span><span class="w">          </span><span class="n">ether</span><span class="w">
           </span><span class="mf">16.1</span><span class="w">      </span><span class="n">icsd</span><span class="o">-</span><span class="n">net</span><span class="w">
           </span><span class="mf">1.254</span><span class="o">.</span><span class="mi">110</span><span class="w"> </span><span class="n">ace</span><span class="w">
    </span><span class="nc">The</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="n">give</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">AppleTalk</span><span class="w"> </span><span class="n">networks</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">third</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">gives</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="p" data-group-id="9738888467-81">(</span><span class="n">a</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">distinguished</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="mi">3</span><span class="n">rd</span><span class="w">
    </span><span class="n">octet</span><span class="w">  </span><span class="ow">in</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">number</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">octets</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">three</span><span class="w"> </span><span class="n">octets</span><span class="o">.</span><span class="p" data-group-id="9738888467-81">)</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">whitespace</span><span class="w">
    </span><span class="p" data-group-id="9738888467-82">(</span><span class="n">blanks</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">tabs</span><span class="p" data-group-id="9738888467-82">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">atalk</span><span class="o">.</span><span class="n">names</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">blank</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="p" data-group-id="9738888467-83">(</span><span class="n">lines</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">`</span><span class="c1">#&#39;).</span><span class="w">

    </span><span class="nc">AppleTalk</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w">
           </span><span class="n">net</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">port</span><span class="w">

           </span><span class="mf">144.1</span><span class="o">.</span><span class="mf">209.2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">icsd</span><span class="o">-</span><span class="n">net</span><span class="o">.</span><span class="mf">112.220</span><span class="w">
           </span><span class="n">office</span><span class="o">.</span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">icsd</span><span class="o">-</span><span class="n">net</span><span class="o">.</span><span class="mf">112.220</span><span class="w">
           </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">149.235</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">icsd</span><span class="o">-</span><span class="n">net</span><span class="o">.</span><span class="mi">2</span><span class="w">
    </span><span class="p" data-group-id="9738888467-84">(</span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">atalk</span><span class="o">.</span><span class="n">names</span><span class="w"> </span><span class="n">doesn</span><span class="sc">&#39;t exist or doesn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="nc">AppleTalk</span><span class="w"> </span><span class="n">host</span><span class="o">/</span><span class="n">net</span><span class="w"> </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">numeric</span><span class="w"> </span><span class="n">form</span><span class="o">.</span><span class="p" data-group-id="9738888467-84">)</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="n">the</span><span class="w">  </span><span class="n">first</span><span class="w">
    </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="nc">NBP</span><span class="w"> </span><span class="p" data-group-id="9738888467-85">(</span><span class="nc">DDP</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="9738888467-85">)</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="mf">144.1</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="mi">209</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">sending</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">whatever</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">listening</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">220</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="n">icsd</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="mi">112</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">except</span><span class="w"> </span><span class="n">the</span><span class="w">
    </span><span class="n">full</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="p" data-group-id="9738888467-86">(</span><span class="err">`</span><span class="n">office</span><span class="sc">&#39;).  The third line is a send from port 235 on net jssmag node 149 to broadcast on the icsd-net NBP port  (note
    that  the broadcast address (255) is indicated by a net name with no host number - for this reason it&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">good</span><span class="w"> </span><span class="n">idea</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="n">distinct</span><span class="w">
    </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">atalk</span><span class="o">.</span><span class="n">names</span><span class="p" data-group-id="9738888467-86">)</span><span class="o">.</span><span class="w">

    </span><span class="nc">NBP</span><span class="w"> </span><span class="p" data-group-id="9738888467-87">(</span><span class="n">name</span><span class="w"> </span><span class="n">binding</span><span class="w"> </span><span class="n">protocol</span><span class="p" data-group-id="9738888467-87">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">ATP</span><span class="w"> </span><span class="p" data-group-id="9738888467-88">(</span><span class="nc">AppleTalk</span><span class="w"> </span><span class="n">transaction</span><span class="w"> </span><span class="n">protocol</span><span class="p" data-group-id="9738888467-88">)</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">contents</span><span class="w"> </span><span class="n">interpreted</span><span class="o">.</span><span class="w">  </span><span class="nc">Other</span><span class="w"> </span><span class="n">protocols</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">dump</span><span class="w">  </span><span class="n">the</span><span class="w">  </span><span class="n">protocol</span><span class="w">  </span><span class="n">name</span><span class="w">
    </span><span class="p" data-group-id="9738888467-89">(</span><span class="ow">or</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">protocol</span><span class="p" data-group-id="9738888467-89">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">size</span><span class="o">.</span><span class="w">

    </span><span class="nc">NBP</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">formatted</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">examples</span><span class="p">:</span><span class="w">
           </span><span class="n">icsd</span><span class="o">-</span><span class="n">net</span><span class="o">.</span><span class="mf">112.220</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">nbp</span><span class="o">-</span><span class="n">lkup</span><span class="w"> </span><span class="mi">190</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;=:LaserWriter@*&quot;</span><span class="w">
           </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">icsd</span><span class="o">-</span><span class="n">net</span><span class="o">.</span><span class="mf">112.220</span><span class="p">:</span><span class="w"> </span><span class="n">nbp</span><span class="o">-</span><span class="n">reply</span><span class="w"> </span><span class="mi">190</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;RM1140:LaserWriter@*&quot;</span><span class="w"> </span><span class="mi">250</span><span class="w">
           </span><span class="n">techpit</span><span class="o">.</span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">icsd</span><span class="o">-</span><span class="n">net</span><span class="o">.</span><span class="mf">112.220</span><span class="p">:</span><span class="w"> </span><span class="n">nbp</span><span class="o">-</span><span class="n">reply</span><span class="w"> </span><span class="mi">190</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;techpit:LaserWriter@*&quot;</span><span class="w"> </span><span class="mi">186</span><span class="w">
    </span><span class="nc">The</span><span class="w">  </span><span class="n">first</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">laserwriters</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="n">icsd</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="mi">112</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">broadcast</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">nbp</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mi">190</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">sec</span><span class="err">‐</span><span class="w">
    </span><span class="n">ond</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">shows</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="p" data-group-id="9738888467-90">(</span><span class="n">note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">id</span><span class="p" data-group-id="9738888467-90">)</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mi">209</span><span class="w"> </span><span class="n">saying</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">laserwriter</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">named</span><span class="w">  </span><span class="s">&quot;RM1140&quot;</span><span class="w">  </span><span class="n">regis</span><span class="err">‐</span><span class="w">
    </span><span class="n">tered</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">250</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">third</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">saying</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">techpit</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">laserwriter</span><span class="w"> </span><span class="s">&quot;techpit&quot;</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">186</span><span class="o">.</span><span class="w">

    </span><span class="nc">ATP</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">formatting</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">demonstrated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">example</span><span class="p">:</span><span class="w">
           </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.165</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">req</span><span class="w">  </span><span class="mi">12266</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">-</span><span class="mi">7</span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0xae030001</span><span class="w">
           </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.165</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">resp</span><span class="w"> </span><span class="mi">12266</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="p" data-group-id="9738888467-91">(</span><span class="mi">512</span><span class="p" data-group-id="9738888467-91">)</span><span class="w"> </span><span class="mh">0xae040000</span><span class="w">
           </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.165</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">resp</span><span class="w"> </span><span class="mi">12266</span><span class="p">:</span><span class="mi">1</span><span class="w"> </span><span class="p" data-group-id="9738888467-92">(</span><span class="mi">512</span><span class="p" data-group-id="9738888467-92">)</span><span class="w"> </span><span class="mh">0xae040000</span><span class="w">
           </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.165</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">resp</span><span class="w"> </span><span class="mi">12266</span><span class="p">:</span><span class="mi">2</span><span class="w"> </span><span class="p" data-group-id="9738888467-93">(</span><span class="mi">512</span><span class="p" data-group-id="9738888467-93">)</span><span class="w"> </span><span class="mh">0xae040000</span><span class="w">
           </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.165</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">resp</span><span class="w"> </span><span class="mi">12266</span><span class="p">:</span><span class="mi">3</span><span class="w"> </span><span class="p" data-group-id="9738888467-94">(</span><span class="mi">512</span><span class="p" data-group-id="9738888467-94">)</span><span class="w"> </span><span class="mh">0xae040000</span><span class="w">
           </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.165</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">resp</span><span class="w"> </span><span class="mi">12266</span><span class="p">:</span><span class="mi">4</span><span class="w"> </span><span class="p" data-group-id="9738888467-95">(</span><span class="mi">512</span><span class="p" data-group-id="9738888467-95">)</span><span class="w"> </span><span class="mh">0xae040000</span><span class="w">
           </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.165</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">resp</span><span class="w"> </span><span class="mi">12266</span><span class="p">:</span><span class="mi">5</span><span class="w"> </span><span class="p" data-group-id="9738888467-96">(</span><span class="mi">512</span><span class="p" data-group-id="9738888467-96">)</span><span class="w"> </span><span class="mh">0xae040000</span><span class="w">
           </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.165</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">resp</span><span class="w"> </span><span class="mi">12266</span><span class="p">:</span><span class="mi">6</span><span class="w"> </span><span class="p" data-group-id="9738888467-97">(</span><span class="mi">512</span><span class="p" data-group-id="9738888467-97">)</span><span class="w"> </span><span class="mh">0xae040000</span><span class="w">
           </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.165</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">resp</span><span class="o">*</span><span class="mi">12266</span><span class="p">:</span><span class="mi">7</span><span class="w"> </span><span class="p" data-group-id="9738888467-98">(</span><span class="mi">512</span><span class="p" data-group-id="9738888467-98">)</span><span class="w"> </span><span class="mh">0xae040000</span><span class="w">
           </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.165</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">req</span><span class="w">  </span><span class="mi">12266</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0xae030001</span><span class="w">
           </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.165</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">resp</span><span class="w"> </span><span class="mi">12266</span><span class="p">:</span><span class="mi">3</span><span class="w"> </span><span class="p" data-group-id="9738888467-99">(</span><span class="mi">512</span><span class="p" data-group-id="9738888467-99">)</span><span class="w"> </span><span class="mh">0xae040000</span><span class="w">
           </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.165</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">resp</span><span class="w"> </span><span class="mi">12266</span><span class="p">:</span><span class="mi">5</span><span class="w"> </span><span class="p" data-group-id="9738888467-100">(</span><span class="mi">512</span><span class="p" data-group-id="9738888467-100">)</span><span class="w"> </span><span class="mh">0xae040000</span><span class="w">
           </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.165</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">rel</span><span class="w">  </span><span class="mi">12266</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">-</span><span class="mi">7</span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0xae030001</span><span class="w">
           </span><span class="n">jssmag</span><span class="o">.</span><span class="mf">209.133</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">helios</span><span class="o">.</span><span class="mi">132</span><span class="p">:</span><span class="w"> </span><span class="n">atp</span><span class="o">-</span><span class="n">req</span><span class="o">*</span><span class="w"> </span><span class="mi">12267</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">-</span><span class="mi">7</span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0xae030002</span><span class="w">
    </span><span class="nc">Jssmag</span><span class="o">.</span><span class="mi">209</span><span class="w">  </span><span class="n">initiates</span><span class="w">  </span><span class="n">transaction</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="mi">12266</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">helios</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">requesting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="p" data-group-id="9738888467-101">(</span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">-</span><span class="mi">7</span><span class="o">&gt;</span><span class="sc">&#39;).  The hex number at the end of the line is the value
    of the `userdata&#39;</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">request</span><span class="o">.</span><span class="w">

    </span><span class="nc">Helios</span><span class="w"> </span><span class="n">responds</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="mi">512</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="err">`</span><span class="ss">:digit</span><span class="sc">&#39; following the transaction id gives the packet sequence number in the transaction  and  the  number  in
    parens is the amount of data in the packet, excluding the atp header.  The `*&#39;</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">EOM</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">

    </span><span class="nc">Jssmag</span><span class="o">.</span><span class="mi">209</span><span class="w">  </span><span class="n">then</span><span class="w">  </span><span class="n">requests</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">retransmitted</span><span class="o">.</span><span class="w">  </span><span class="nc">Helios</span><span class="w"> </span><span class="n">resends</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mi">209</span><span class="w"> </span><span class="n">releases</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">transaction</span><span class="o">.</span><span class="w">  </span><span class="nc">Finally</span><span class="p">,</span><span class="w"> </span><span class="n">jssmag</span><span class="o">.</span><span class="mi">209</span><span class="w"> </span><span class="n">initiates</span><span class="w">
    </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">request</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="err">`</span><span class="o">*</span><span class="sc">&#39; on the request indicates that XO (`exactly once&#39;</span><span class="p" data-group-id="9738888467-101">)</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">set</span><span class="o">.</span></code></pre><h2 id="see-also" class="section-heading">
  <a href="#see-also" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  SEE ALSO
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="n">stty</span><span class="p" data-group-id="6656232515-1">(</span><span class="mi">1</span><span class="p" data-group-id="6656232515-1">)</span><span class="p">,</span><span class="w"> </span><span class="n">pcap</span><span class="p" data-group-id="6656232515-2">(</span><span class="mi">3</span><span class="nc">PCAP</span><span class="p" data-group-id="6656232515-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">bpf</span><span class="p" data-group-id="6656232515-3">(</span><span class="mi">4</span><span class="p" data-group-id="6656232515-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">nit</span><span class="p" data-group-id="6656232515-4">(</span><span class="mi">4</span><span class="nc">P</span><span class="p" data-group-id="6656232515-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">pcap</span><span class="o">-</span><span class="n">savefile</span><span class="p" data-group-id="6656232515-5">(</span><span class="mi">5</span><span class="p" data-group-id="6656232515-5">)</span><span class="p">,</span><span class="w"> </span><span class="n">pcap</span><span class="o">-</span><span class="n">filter</span><span class="p" data-group-id="6656232515-6">(</span><span class="mi">7</span><span class="p" data-group-id="6656232515-6">)</span><span class="p">,</span><span class="w"> </span><span class="n">pcap</span><span class="o">-</span><span class="n">tstamp</span><span class="p" data-group-id="6656232515-7">(</span><span class="mi">7</span><span class="p" data-group-id="6656232515-7">)</span><span class="w">

           </span><span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">www</span><span class="o">.</span><span class="n">iana</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">assignments</span><span class="o">/</span><span class="n">media</span><span class="o">-</span><span class="n">types</span><span class="o">/</span><span class="n">application</span><span class="o">/</span><span class="n">vnd</span><span class="o">.</span><span class="n">tcpdump</span><span class="o">.</span><span class="n">pcap</span></code></pre><h2 id="authors" class="section-heading">
  <a href="#authors" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  AUTHORS
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="nc">The</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">authors</span><span class="w"> </span><span class="ss">are</span><span class="p">:</span><span class="w">

    </span><span class="nc">Van</span><span class="w"> </span><span class="nc">Jacobson</span><span class="p">,</span><span class="w"> </span><span class="nc">Craig</span><span class="w"> </span><span class="nc">Leres</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">Steven</span><span class="w"> </span><span class="nc">McCanne</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Lawrence</span><span class="w"> </span><span class="nc">Berkeley</span><span class="w"> </span><span class="nc">National</span><span class="w"> </span><span class="nc">Laboratory</span><span class="p">,</span><span class="w"> </span><span class="nc">University</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">California</span><span class="p">,</span><span class="w"> </span><span class="nc">Berkeley</span><span class="p">,</span><span class="w"> </span><span class="nc">CA</span><span class="o">.</span><span class="w">

    </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">maintained</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">tcpdump</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="w">

    </span><span class="nc">The</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="ss">http</span><span class="p">:</span><span class="w">

           </span><span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">www</span><span class="o">.</span><span class="n">tcpdump</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="w">

    </span><span class="nc">The</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">anonymous</span><span class="w"> </span><span class="ss">ftp</span><span class="p">:</span><span class="w">

           </span><span class="n">ftp</span><span class="ss">:/</span><span class="o">/</span><span class="n">ftp</span><span class="o">.</span><span class="n">ee</span><span class="o">.</span><span class="n">lbl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">old</span><span class="o">/</span><span class="n">tcpdump</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="nc">Z</span><span class="w">

    </span><span class="nc">IPv6</span><span class="o">/</span><span class="nc">IPsec</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">WIDE</span><span class="o">/</span><span class="nc">KAME</span><span class="w"> </span><span class="n">project</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="nc">Eric</span><span class="w"> </span><span class="nc">Young</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="nc">SSLeay</span><span class="w"> </span><span class="n">library</span><span class="p">,</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">configurations</span><span class="o">.</span></code></pre><h2 id="bugs" class="section-heading">
  <a href="#bugs" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  BUGS
</h2>
<pre><code class="nohighlight makeup elixir"><span class="w">    </span><span class="nc">To</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">issue</span><span class="w"> </span><span class="n">please</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">e</span><span class="o">-</span><span class="n">mail</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">security</span><span class="na">@tcpdump</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="w">

    </span><span class="nc">To</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="n">bugs</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">problems</span><span class="p">,</span><span class="w"> </span><span class="n">contribute</span><span class="w"> </span><span class="n">patches</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">feature</span><span class="p">,</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">generic</span><span class="w"> </span><span class="n">feedback</span><span class="w"> </span><span class="n">etc</span><span class="w"> </span><span class="n">please</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="nc">CONTRIBUTING</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="n">source</span><span class="w">
    </span><span class="n">tree</span><span class="w"> </span><span class="n">root</span><span class="o">.</span><span class="w">

    </span><span class="nc">NIT</span><span class="w"> </span><span class="n">doesn</span><span class="sc">&#39;t let you watch your own outbound traffic, BPF will.  We recommend that you use the latter.

    On Linux systems with 2.0[.x] kernels:

           packets on the loopback device will be seen twice;

           packet filtering cannot be done in the kernel, so that all packets must be copied from the kernel in order to be filtered in user mode;

           all  of  a packet, not just the part that&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">copied</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="p" data-group-id="3421594066-1">(</span><span class="n">the</span><span class="w"> </span><span class="mf">2.0</span><span class="p" data-group-id="3421594066-2">[</span><span class="o">.</span><span class="n">x</span><span class="p" data-group-id="3421594066-2">]</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">mechanism</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">asked</span><span class="w">
           </span><span class="n">to</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">userland</span><span class="p">,</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="p">;</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w">  </span><span class="n">from</span><span class="w">  </span><span class="n">tcp</span><span class="err">‐</span><span class="w">
           </span><span class="n">dump</span><span class="p" data-group-id="3421594066-1">)</span><span class="p">;</span><span class="w">

           </span><span class="n">capturing</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="nc">PPP</span><span class="w"> </span><span class="n">devices</span><span class="w"> </span><span class="n">won</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">correctly</span><span class="o">.</span><span class="w">

    </span><span class="nc">We</span><span class="w"> </span><span class="n">recommend</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">upgrade</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="mf">2.2</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">later</span><span class="w"> </span><span class="n">kernel</span><span class="o">.</span><span class="w">

    </span><span class="nc">Some</span><span class="w"> </span><span class="n">attempt</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">made</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reassemble</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">fragments</span><span class="w"> </span><span class="ow">or</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">compute</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">protocol</span><span class="o">.</span><span class="w">

    </span><span class="nc">Name</span><span class="w">  </span><span class="n">server</span><span class="w">  </span><span class="n">inverse</span><span class="w">  </span><span class="n">queries</span><span class="w">  </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">dumped</span><span class="w"> </span><span class="ss">correctly</span><span class="p">:</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="p" data-group-id="3421594066-3">(</span><span class="n">empty</span><span class="p" data-group-id="3421594066-3">)</span><span class="w"> </span><span class="n">question</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">real</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="n">section</span><span class="o">.</span><span class="w">  </span><span class="nc">Some</span><span class="w"> </span><span class="n">believe</span><span class="w">
    </span><span class="n">that</span><span class="w"> </span><span class="n">inverse</span><span class="w"> </span><span class="n">queries</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">themselves</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">bug</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">prefer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">fix</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">generating</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">tcpdump</span><span class="o">.</span><span class="w">

    </span><span class="nc">A</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">trace</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">crosses</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">daylight</span><span class="w"> </span><span class="n">savings</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">give</span><span class="w"> </span><span class="n">skewed</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">stamps</span><span class="w"> </span><span class="p" data-group-id="3421594066-4">(</span><span class="n">the</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">ignored</span><span class="p" data-group-id="3421594066-4">)</span><span class="o">.</span><span class="w">

    </span><span class="nc">Filter</span><span class="w"> </span><span class="n">expressions</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">Token</span><span class="w"> </span><span class="nc">Ring</span><span class="w"> </span><span class="n">headers</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">correctly</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">source</span><span class="o">-</span><span class="n">routed</span><span class="w"> </span><span class="nc">Token</span><span class="w"> </span><span class="nc">Ring</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">

    </span><span class="nc">Filter</span><span class="w"> </span><span class="n">expressions</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mf">802.11</span><span class="w"> </span><span class="n">headers</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">correctly</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="mf">802.11</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="nc">To</span><span class="w"> </span><span class="nc">DS</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">From</span><span class="w"> </span><span class="nc">DS</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">

    </span><span class="n">ip6</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">chase</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">chain</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">moment</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="o">.</span><span class="w">  </span><span class="n">ip6</span><span class="w"> </span><span class="n">protochain</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">behavior</span><span class="o">.</span><span class="w">

    </span><span class="nc">Arithmetic</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">transport</span><span class="w"> </span><span class="n">layer</span><span class="w"> </span><span class="n">headers</span><span class="p">,</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">tcp</span><span class="p" data-group-id="3421594066-5">[</span><span class="mi">0</span><span class="p" data-group-id="3421594066-5">]</span><span class="p">,</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">looks</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="n">packets</span><span class="o">.</span><span class="w">

                                                                        </span><span class="mi">2</span><span class="w"> </span><span class="nc">February</span><span class="w"> </span><span class="mi">2017</span><span class="w">                                                                </span><span class="nc">TCPDUMP</span><span class="p" data-group-id="3421594066-6">(</span><span class="mi">8</span><span class="p" data-group-id="3421594066-6">)</span></code></pre>      <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.23.0) for the
            <a href="https://elixir-lang.org" title="Elixir" target="_blank">Elixir programming language</a>.
          </span>
          <span class="line">
            Designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>
          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>
  </body>
</html>
